{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-07-12T22:56:29.938039Z", "invocation_id": "97be6fbe-992b-43d8-9552-e36b414d639a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-12T22:56:29.701575Z", "completed_at": "2025-07-12T22:56:29.704820Z"}, {"name": "execute", "started_at": "2025-07-12T22:56:29.704956Z", "completed_at": "2025-07-12T22:56:29.794481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09343695640563965, "adapter_response": {"_message": "SELECT 7671", "code": "SELECT", "rows_affected": 7671}, "message": "SELECT 7671", "failures": null, "unique_id": "model.retail_warehouse.dim_date", "compiled": true, "compiled_code": "\n\nwith calendar as (\n    select\n        generate_series('2015-01-01'::date, '2035-12-31'::date, interval '1 day')::date as date_day\n), base as (\n    select\n        (extract(year from date_day)*10000\n         + extract(month from date_day)*100\n         + extract(day   from date_day))::int      as date_sk,\n        date_day                                    as full_date,\n        extract(year from date_day)::int            as year,\n        extract(quarter from date_day)::int         as quarter,\n        extract(month from date_day)::int           as month,\n        to_char(date_day,'Month')                   as month_name,\n        extract(day from date_day)::int             as day_of_month,\n        extract(doy from date_day)::int             as day_of_year,\n        extract(week from date_day)::int            as week_of_year,\n        extract(isodow from date_day)::int          as weekday_iso,\n        to_char(date_day,'Day')                     as weekday_name,\n        case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend\n    from calendar\n), unknown as (\n    /* the Kimball unknown row */\n    select\n        0                    as date_sk,\n        '1900-01-01'::date   as full_date,\n        1900                 as year,\n        0                    as quarter,\n        0                    as month,\n        'Unknown'            as month_name,\n        0  as day_of_month,\n        0  as day_of_year,\n        0  as week_of_year,\n        0  as weekday_iso,\n        'Unknown'            as weekday_name,\n        false as is_weekend\n)\n\nselect * from base\nunion all\nselect * from unknown", "relation_name": "\"RetailSales\".\"dw\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-12T22:56:29.796822Z", "completed_at": "2025-07-12T22:56:29.828124Z"}, {"name": "execute", "started_at": "2025-07-12T22:56:29.828294Z", "completed_at": "2025-07-12T22:56:29.845216Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04885411262512207, "adapter_response": {"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}, "message": "SELECT 50", "failures": null, "unique_id": "model.retail_warehouse.dim_products", "compiled": true, "compiled_code": "\n\nselect \n     nextval('dw.dim_products_sk_seq') as product_sk,\n     product_id,\n     product_name,\n     brand,\n     subcategory,\n     category,\n     department,\n     package_type,\n     fat_content,\n     diet_type\nfrom \"RetailSales\".\"oltp\".\"stg_products\"", "relation_name": "\"RetailSales\".\"dw\".\"dim_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-12T22:56:29.846709Z", "completed_at": "2025-07-12T22:56:29.847986Z"}, {"name": "execute", "started_at": "2025-07-12T22:56:29.848118Z", "completed_at": "2025-07-12T22:56:29.864270Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018062829971313477, "adapter_response": {"_message": "SELECT 16", "code": "SELECT", "rows_affected": 16}, "message": "SELECT 16", "failures": null, "unique_id": "model.retail_warehouse.dim_promotions", "compiled": true, "compiled_code": "\n\n-- -------------------------------------------------------------------------\n-- 1.  Regular promotion rows from the staging table\n-- -------------------------------------------------------------------------\nwith base as (\n\n    select\n        nextval('dw.dim_promotions_sk_seq') as promotion_sk,   -- surrogate\n        promotion_id,\n        promotion_name,\n        media_type,\n        discount_pct,\n        start_date,\n        end_date\n    from \"RetailSales\".\"oltp\".\"stg_promotions\"\n\n),\n\n-- -------------------------------------------------------------------------\n-- 2.  Kimball \u201cUnknown Promotion\u201d row  (surrogate key = 0)\n-- -------------------------------------------------------------------------\nunknown_row as (\n\n    select\n        0                    as promotion_sk,\n        'UNK'                as promotion_id,\n        'Unknown Promotion'  as promotion_name,\n        'N/A'                as media_type,\n        0.0                  as discount_pct,\n        date '1900-01-01'    as start_date,\n        date '2099-12-31'    as end_date\n\n)\n\n-- -------------------------------------------------------------------------\n-- 3.  Final output\n-- -------------------------------------------------------------------------\nselect * from base\nunion all\nselect * from unknown_row", "relation_name": "\"RetailSales\".\"dw\".\"dim_promotions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-12T22:56:29.865852Z", "completed_at": "2025-07-12T22:56:29.867257Z"}, {"name": "execute", "started_at": "2025-07-12T22:56:29.867403Z", "completed_at": "2025-07-12T22:56:29.889783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024402379989624023, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.retail_warehouse.dim_stores", "compiled": true, "compiled_code": "\n\nselect \n     nextval('dw.dim_stores_sk_seq') as store_sk,\n     store_id,\n     store_name,\n     district,\n     region,\n     open_date,\n     remodel_date,\n     store_type\nfrom \"RetailSales\".\"oltp\".\"stg_stores\"", "relation_name": "\"RetailSales\".\"dw\".\"dim_stores\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-12T22:56:29.891241Z", "completed_at": "2025-07-12T22:56:29.892558Z"}, {"name": "execute", "started_at": "2025-07-12T22:56:29.892678Z", "completed_at": "2025-07-12T22:56:29.931582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04079270362854004, "adapter_response": {"_message": "SELECT 7842", "code": "SELECT", "rows_affected": 7842}, "message": "SELECT 7842", "failures": null, "unique_id": "model.retail_warehouse.fct_promotion_eligibility", "compiled": true, "compiled_code": "\n\n-- generate one row per date the promotion is active\nwith promo_calendar as (\n\n    select\n        p.promotion_sk,\n        d.date_sk\n    from \"RetailSales\".\"dw\".\"dim_promotions\" p\n    join \"RetailSales\".\"dw\".\"dim_date\" d\n      on d.full_date between p.start_date and p.end_date\n\n)\n\nselect\n    date_sk,\n    promotion_sk\nfrom promo_calendar\norder by promotion_sk, date_sk", "relation_name": "\"RetailSales\".\"dw\".\"fct_promotion_eligibility\"", "batch_results": null}], "elapsed_time": 0.3390069007873535, "args": {"strict_mode": false, "version_check": true, "invocation_command": "dbt run --select dim_date dim_products dim_promotions dim_stores fct_promotion_eligibility", "macro_debugging": false, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "empty": false, "favor_state": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "printer_width": 80, "use_colors": true, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "cache_selected_only": false, "profiles_dir": "/Users/ramana/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "print": true, "defer": false, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "show_resource_report": false, "exclude": [], "require_nested_cumulative_type_params": false, "which": "run", "introspect": true, "project_dir": "/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse", "use_colors_file": true, "partial_parse": true, "static_parser": true, "select": ["dim_date", "dim_products", "dim_promotions", "dim_stores", "fct_promotion_eligibility"], "require_resource_names_without_spaces": false, "indirect_selection": "eager", "log_format_file": "debug", "log_level_file": "debug", "log_level": "info", "log_path": "/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs", "partial_parse_file_diff": true, "vars": {}}}