[0m22:22:52.489819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108211e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6bed0>]}


============================== 22:22:52.492857 | f3768cdf-cdef-4821-a5c9-efeef9aa96bd ==============================
[0m22:22:52.492857 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:22:52.493238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:22:52.504788 [info ] [MainThread]: dbt version: 1.9.0
[0m22:22:52.505042 [info ] [MainThread]: python version: 3.13.1
[0m22:22:52.505195 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m22:22:52.505332 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m22:22:52.550360 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m22:22:52.550719 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m22:22:52.550894 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m22:22:52.551436 [info ] [MainThread]: adapter type: postgres
[0m22:22:52.551668 [info ] [MainThread]: adapter version: 1.9.0
[0m22:22:52.603662 [info ] [MainThread]: Configuration:
[0m22:22:52.603996 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:22:52.604193 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:22:52.604349 [info ] [MainThread]: Required dependencies:
[0m22:22:52.604611 [debug] [MainThread]: Executing "git --help"
[0m22:22:52.623818 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:22:52.624415 [debug] [MainThread]: STDERR: "b''"
[0m22:22:52.624640 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:22:52.624847 [info ] [MainThread]: Connection:
[0m22:22:52.625030 [info ] [MainThread]:   host: localhost
[0m22:22:52.625182 [info ] [MainThread]:   port: 5432
[0m22:22:52.625315 [info ] [MainThread]:   user: postgres
[0m22:22:52.625447 [info ] [MainThread]:   database: RetailSales
[0m22:22:52.625574 [info ] [MainThread]:   schema: dw
[0m22:22:52.625705 [info ] [MainThread]:   connect_timeout: 10
[0m22:22:52.625840 [info ] [MainThread]:   role: None
[0m22:22:52.625968 [info ] [MainThread]:   search_path: None
[0m22:22:52.626090 [info ] [MainThread]:   keepalives_idle: 0
[0m22:22:52.626215 [info ] [MainThread]:   sslmode: None
[0m22:22:52.626338 [info ] [MainThread]:   sslcert: None
[0m22:22:52.626465 [info ] [MainThread]:   sslkey: None
[0m22:22:52.626590 [info ] [MainThread]:   sslrootcert: None
[0m22:22:52.626713 [info ] [MainThread]:   application_name: dbt
[0m22:22:52.626848 [info ] [MainThread]:   retries: 1
[0m22:22:52.627250 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:52.674229 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:22:52.702424 [debug] [MainThread]: Using postgres connection "debug"
[0m22:22:52.702684 [debug] [MainThread]: On debug: select 1 as id
[0m22:22:52.702877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:52.721449 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m22:22:52.722065 [debug] [MainThread]: On debug: Close
[0m22:22:52.722278 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:22:52.722466 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:22:52.724635 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27534342, "process_in_blocks": "0", "process_kernel_time": 0.193235, "process_mem_max_rss": "120356864", "process_out_blocks": "0", "process_user_time": 0.851391}
[0m22:22:52.724925 [debug] [MainThread]: Command `dbt debug` succeeded at 22:22:52.724861 after 0.28 seconds
[0m22:22:52.725107 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:22:52.725320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d556e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109680380>]}
[0m22:22:52.725562 [debug] [MainThread]: Flushing usage events
[0m22:22:52.936349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:08.914616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec3ed0>]}


============================== 22:52:08.917567 | 51aed8bc-e6ec-4daf-8509-d1ab8fef5420 ==============================
[0m22:52:08.917567 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:52:08.917942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:08.973263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51aed8bc-e6ec-4daf-8509-d1ab8fef5420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111125ba0>]}
[0m22:52:08.981882 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:52:08.982327 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:52:08.984573 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.112910666, "process_in_blocks": "0", "process_kernel_time": 0.10532, "process_mem_max_rss": "108281856", "process_out_blocks": "0", "process_user_time": 0.773981}
[0m22:52:08.984895 [debug] [MainThread]: Command `cli deps` succeeded at 22:52:08.984832 after 0.11 seconds
[0m22:52:08.985121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f605a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f61bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d33c50>]}
[0m22:52:08.985339 [debug] [MainThread]: Flushing usage events
[0m22:52:09.205082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:12.513945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107163c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107163ed0>]}


============================== 22:56:12.516942 | 0d303c57-e15e-4424-9027-36deb55e2727 ==============================
[0m22:56:12.516942 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:56:12.517369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:56:12.573803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d303c57-e15e-4424-9027-36deb55e2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c1ba0>]}
[0m22:56:12.582125 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:56:12.582742 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:56:12.584563 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11050317, "process_in_blocks": "0", "process_kernel_time": 0.112097, "process_mem_max_rss": "108920832", "process_out_blocks": "0", "process_user_time": 0.787265}
[0m22:56:12.584886 [debug] [MainThread]: Command `cli deps` succeeded at 22:56:12.584815 after 0.11 seconds
[0m22:56:12.585095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072005a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107201bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd7c50>]}
[0m22:56:12.585292 [debug] [MainThread]: Flushing usage events
[0m22:56:12.918469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:24.093117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111209e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c3ed0>]}


============================== 23:59:24.096355 | 21f04979-45cc-4a91-9ee6-40d974de3c50 ==============================
[0m23:59:24.096355 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:59:24.096635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name":"stg_sales"}', 'send_anonymous_usage_stats': 'True'}
[0m23:59:24.324837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f04979-45cc-4a91-9ee6-40d974de3c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181dba0>]}
[0m23:59:24.343717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f04979-45cc-4a91-9ee6-40d974de3c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6d8c0>]}
[0m23:59:24.344229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:24.387394 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:59:24.424633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:59:24.424865 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m23:59:24.478812 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_sales' (models/staging/sales/stg_sales.sql) depends on a source named 'oltp.sales' which was not found
[0m23:59:24.503304 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.44190276, "process_in_blocks": "0", "process_kernel_time": 0.129099, "process_mem_max_rss": "118177792", "process_out_blocks": "0", "process_user_time": 0.649081}
[0m23:59:24.503609 [debug] [MainThread]: Command `dbt run-operation` failed at 23:59:24.503557 after 0.44 seconds
[0m23:59:24.503802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ce8a0>]}
[0m23:59:24.503968 [debug] [MainThread]: Flushing usage events
[0m23:59:24.746133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:42.453117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ec3ed0>]}


============================== 00:01:42.455271 | dbfa2e5b-aa45-417a-838c-d41b6ef60dd7 ==============================
[0m00:01:42.455271 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:01:42.455519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name": "stg_sales"}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:42.515948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbfa2e5b-aa45-417a-838c-d41b6ef60dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118211ba0>]}
[0m00:01:42.532909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbfa2e5b-aa45-417a-838c-d41b6ef60dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f6d8c0>]}
[0m00:01:42.533379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:01:42.565796 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:01:42.598782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:42.598933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:42.609481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbfa2e5b-aa45-417a-838c-d41b6ef60dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f7a650>]}
[0m00:01:42.631370 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:01:42.637694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:01:42.644385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbfa2e5b-aa45-417a-838c-d41b6ef60dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d8aa0>]}
[0m00:01:42.644575 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m00:01:42.644710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbfa2e5b-aa45-417a-838c-d41b6ef60dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0b3af0>]}
[0m00:01:42.644928 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:01:42.645052 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:01:42.645149 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:01:42.645247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:42.668191 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m00:01:42.668391 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:01:42.668500 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:01:42.668592 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:01:42.668806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:01:42.668992 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:01:42.669151 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package
[0m00:01:42.670141 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package

[0m00:01:42.670299 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_yaml' in any package
[0m00:01:42.671725 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.24470466, "process_in_blocks": "0", "process_kernel_time": 0.111391, "process_mem_max_rss": "120848384", "process_out_blocks": "0", "process_user_time": 0.579256}
[0m00:01:42.671894 [debug] [MainThread]: Command `dbt run-operation` failed at 00:01:42.671858 after 0.24 seconds
[0m00:01:42.672002 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:01:42.672113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1b2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a344ad0>]}
[0m00:01:42.672235 [debug] [MainThread]: Flushing usage events
[0m00:01:42.880876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:22.826453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106069e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3ed0>]}


============================== 00:03:22.828701 | ac56e4b9-21f0-4903-8fdf-c4420055f5cb ==============================
[0m00:03:22.828701 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:03:22.828950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name": "stg_sales"}', 'send_anonymous_usage_stats': 'True'}
[0m00:03:22.889588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac56e4b9-21f0-4903-8fdf-c4420055f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106521ba0>]}
[0m00:03:22.906013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac56e4b9-21f0-4903-8fdf-c4420055f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736d8c0>]}
[0m00:03:22.906503 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:03:22.939966 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:03:22.972193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:22.972342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:22.982976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac56e4b9-21f0-4903-8fdf-c4420055f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737a650>]}
[0m00:03:23.005007 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:03:23.010310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:03:23.018714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac56e4b9-21f0-4903-8fdf-c4420055f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108830aa0>]}
[0m00:03:23.018899 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m00:03:23.019033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac56e4b9-21f0-4903-8fdf-c4420055f5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c3af0>]}
[0m00:03:23.019247 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:03:23.019375 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:03:23.019484 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:03:23.019571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:23.038428 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:03:23.038649 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:03:23.038758 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:03:23.038849 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:03:23.039088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:03:23.039272 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:03:23.039427 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package
[0m00:03:23.040315 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package

[0m00:03:23.040514 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_yaml' in any package
[0m00:03:23.042050 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.24443817, "process_in_blocks": "0", "process_kernel_time": 0.121337, "process_mem_max_rss": "120897536", "process_out_blocks": "0", "process_user_time": 0.588006}
[0m00:03:23.042216 [debug] [MainThread]: Command `dbt run-operation` failed at 00:03:23.042181 after 0.24 seconds
[0m00:03:23.042334 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:03:23.042451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107099c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4cad0>]}
[0m00:03:23.042579 [debug] [MainThread]: Flushing usage events
[0m00:03:23.272262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:29.134359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108969e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc3ed0>]}


============================== 00:04:29.136575 | 1560ec9f-53d2-4bf9-90d0-6d47159ca5ed ==============================
[0m00:04:29.136575 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:04:29.136826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:04:29.145866 [info ] [MainThread]: dbt version: 1.9.0
[0m00:04:29.146022 [info ] [MainThread]: python version: 3.13.1
[0m00:04:29.146206 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m00:04:29.146421 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m00:04:29.170628 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m00:04:29.170851 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m00:04:29.170972 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m00:04:29.171226 [info ] [MainThread]: adapter type: postgres
[0m00:04:29.171384 [info ] [MainThread]: adapter version: 1.9.0
[0m00:04:29.203863 [info ] [MainThread]: Configuration:
[0m00:04:29.204106 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:04:29.204235 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:04:29.204345 [info ] [MainThread]: Required dependencies:
[0m00:04:29.204511 [debug] [MainThread]: Executing "git --help"
[0m00:04:29.219598 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:04:29.220326 [debug] [MainThread]: STDERR: "b''"
[0m00:04:29.220528 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:04:29.220684 [info ] [MainThread]: Connection:
[0m00:04:29.220821 [info ] [MainThread]:   host: localhost
[0m00:04:29.220924 [info ] [MainThread]:   port: 5432
[0m00:04:29.221017 [info ] [MainThread]:   user: postgres
[0m00:04:29.221104 [info ] [MainThread]:   database: RetailSales
[0m00:04:29.221192 [info ] [MainThread]:   schema: dw
[0m00:04:29.221278 [info ] [MainThread]:   connect_timeout: 10
[0m00:04:29.221369 [info ] [MainThread]:   role: None
[0m00:04:29.221460 [info ] [MainThread]:   search_path: None
[0m00:04:29.221551 [info ] [MainThread]:   keepalives_idle: 0
[0m00:04:29.221641 [info ] [MainThread]:   sslmode: None
[0m00:04:29.221727 [info ] [MainThread]:   sslcert: None
[0m00:04:29.221813 [info ] [MainThread]:   sslkey: None
[0m00:04:29.221897 [info ] [MainThread]:   sslrootcert: None
[0m00:04:29.221982 [info ] [MainThread]:   application_name: dbt
[0m00:04:29.222063 [info ] [MainThread]:   retries: 1
[0m00:04:29.222340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:04:29.252660 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:04:29.270324 [debug] [MainThread]: Using postgres connection "debug"
[0m00:04:29.270477 [debug] [MainThread]: On debug: select 1 as id
[0m00:04:29.270577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:29.286118 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m00:04:29.286481 [debug] [MainThread]: On debug: Close
[0m00:04:29.286621 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:04:29.286755 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:04:29.288449 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.17986491, "process_in_blocks": "0", "process_kernel_time": 0.1177, "process_mem_max_rss": "119799808", "process_out_blocks": "0", "process_user_time": 0.518092}
[0m00:04:29.288644 [debug] [MainThread]: Command `dbt debug` succeeded at 00:04:29.288605 after 0.18 seconds
[0m00:04:29.288764 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:04:29.288886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd056e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b355130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b330380>]}
[0m00:04:29.289037 [debug] [MainThread]: Flushing usage events
[0m00:04:29.451425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:49.311073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104969e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3ed0>]}


============================== 00:04:49.313331 | 5e979950-1840-4148-9212-cbd5445f1909 ==============================
[0m00:04:49.313331 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:04:49.313581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name": "stg_sales"}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:49.376950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e979950-1840-4148-9212-cbd5445f1909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105921ba0>]}
[0m00:04:49.395469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e979950-1840-4148-9212-cbd5445f1909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666d8c0>]}
[0m00:04:49.396020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:04:49.431718 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:04:49.475498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:49.475667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:49.486386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e979950-1840-4148-9212-cbd5445f1909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667a650>]}
[0m00:04:49.508730 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:04:49.513671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:04:49.520196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e979950-1840-4148-9212-cbd5445f1909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b8aa0>]}
[0m00:04:49.520391 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m00:04:49.520527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e979950-1840-4148-9212-cbd5445f1909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107193af0>]}
[0m00:04:49.520754 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:04:49.520885 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:04:49.520981 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:04:49.521068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:49.535580 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m00:04:49.535777 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:04:49.535885 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:04:49.535975 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:04:49.536211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:04:49.536404 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:04:49.536560 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package
[0m00:04:49.537392 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package

[0m00:04:49.537535 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_yaml' in any package
[0m00:04:49.538948 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.25308654, "process_in_blocks": "0", "process_kernel_time": 0.111329, "process_mem_max_rss": "123682816", "process_out_blocks": "0", "process_user_time": 0.597764}
[0m00:04:49.539116 [debug] [MainThread]: Command `dbt run-operation` failed at 00:04:49.539081 after 0.25 seconds
[0m00:04:49.539232 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:04:49.539359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107292f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106499c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107448ad0>]}
[0m00:04:49.539500 [debug] [MainThread]: Flushing usage events
[0m00:04:49.761665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:58.491516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105009e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c3ed0>]}


============================== 00:04:58.493171 | b4155ac5-95ec-44dd-98ce-79e0e5ed9d80 ==============================
[0m00:04:58.493171 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:04:58.493434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:58.497957 [info ] [MainThread]: dbt version: 1.9.0
[0m00:04:58.498080 [info ] [MainThread]: python version: 3.13.1
[0m00:04:58.498392 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m00:04:58.498602 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m00:04:58.519896 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m00:04:58.520127 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m00:04:58.520271 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m00:04:58.520489 [info ] [MainThread]: adapter type: postgres
[0m00:04:58.520595 [info ] [MainThread]: adapter version: 1.9.0
[0m00:04:58.552908 [info ] [MainThread]: Configuration:
[0m00:04:58.553155 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:04:58.553289 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:04:58.553395 [info ] [MainThread]: Required dependencies:
[0m00:04:58.553569 [debug] [MainThread]: Executing "git --help"
[0m00:04:58.562353 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:04:58.562716 [debug] [MainThread]: STDERR: "b''"
[0m00:04:58.562828 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:04:58.562941 [info ] [MainThread]: Connection:
[0m00:04:58.563072 [info ] [MainThread]:   host: localhost
[0m00:04:58.563171 [info ] [MainThread]:   port: 5432
[0m00:04:58.563269 [info ] [MainThread]:   user: postgres
[0m00:04:58.563366 [info ] [MainThread]:   database: RetailSales
[0m00:04:58.563455 [info ] [MainThread]:   schema: dw
[0m00:04:58.563552 [info ] [MainThread]:   connect_timeout: 10
[0m00:04:58.563642 [info ] [MainThread]:   role: None
[0m00:04:58.563741 [info ] [MainThread]:   search_path: None
[0m00:04:58.563834 [info ] [MainThread]:   keepalives_idle: 0
[0m00:04:58.563930 [info ] [MainThread]:   sslmode: None
[0m00:04:58.564027 [info ] [MainThread]:   sslcert: None
[0m00:04:58.564116 [info ] [MainThread]:   sslkey: None
[0m00:04:58.564206 [info ] [MainThread]:   sslrootcert: None
[0m00:04:58.564299 [info ] [MainThread]:   application_name: dbt
[0m00:04:58.564399 [info ] [MainThread]:   retries: 1
[0m00:04:58.564657 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:04:58.593739 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:04:58.611553 [debug] [MainThread]: Using postgres connection "debug"
[0m00:04:58.611689 [debug] [MainThread]: On debug: select 1 as id
[0m00:04:58.611785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:58.622264 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m00:04:58.622704 [debug] [MainThread]: On debug: Close
[0m00:04:58.622841 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:04:58.622975 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:04:58.624001 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.15632683, "process_in_blocks": "0", "process_kernel_time": 0.103127, "process_mem_max_rss": "120504320", "process_out_blocks": "0", "process_user_time": 0.513121}
[0m00:04:58.624180 [debug] [MainThread]: Command `dbt debug` succeeded at 00:04:58.624141 after 0.16 seconds
[0m00:04:58.624293 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:04:58.624428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071056e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106931130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690c380>]}
[0m00:04:58.624585 [debug] [MainThread]: Flushing usage events
[0m00:04:58.774571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:52.975229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bfed0>]}


============================== 00:07:52.977499 | 959808c4-8b40-46a9-aaf2-d0ac5189df35 ==============================
[0m00:07:52.977499 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:07:52.977750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:07:52.985329 [info ] [MainThread]: dbt version: 1.9.0
[0m00:07:52.985498 [info ] [MainThread]: python version: 3.13.1
[0m00:07:52.985612 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m00:07:52.985710 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m00:07:53.009513 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m00:07:53.009741 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m00:07:53.009854 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m00:07:53.010103 [info ] [MainThread]: adapter type: postgres
[0m00:07:53.010208 [info ] [MainThread]: adapter version: 1.9.0
[0m00:07:53.041674 [info ] [MainThread]: Configuration:
[0m00:07:53.041904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:07:53.042017 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:07:53.042113 [info ] [MainThread]: Required dependencies:
[0m00:07:53.042266 [debug] [MainThread]: Executing "git --help"
[0m00:07:53.052298 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:07:53.052710 [debug] [MainThread]: STDERR: "b''"
[0m00:07:53.052829 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:07:53.052949 [info ] [MainThread]: Connection:
[0m00:07:53.053085 [info ] [MainThread]:   host: localhost
[0m00:07:53.053184 [info ] [MainThread]:   port: 5432
[0m00:07:53.053277 [info ] [MainThread]:   user: postgres
[0m00:07:53.053367 [info ] [MainThread]:   database: RetailSales
[0m00:07:53.053459 [info ] [MainThread]:   schema: dw
[0m00:07:53.053556 [info ] [MainThread]:   connect_timeout: 10
[0m00:07:53.053661 [info ] [MainThread]:   role: None
[0m00:07:53.053750 [info ] [MainThread]:   search_path: None
[0m00:07:53.053846 [info ] [MainThread]:   keepalives_idle: 0
[0m00:07:53.053938 [info ] [MainThread]:   sslmode: None
[0m00:07:53.054031 [info ] [MainThread]:   sslcert: None
[0m00:07:53.054123 [info ] [MainThread]:   sslkey: None
[0m00:07:53.054209 [info ] [MainThread]:   sslrootcert: None
[0m00:07:53.054321 [info ] [MainThread]:   application_name: dbt
[0m00:07:53.054425 [info ] [MainThread]:   retries: 1
[0m00:07:53.054909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:07:53.085109 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:07:53.103330 [debug] [MainThread]: Using postgres connection "debug"
[0m00:07:53.103484 [debug] [MainThread]: On debug: select 1 as id
[0m00:07:53.103587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:53.118588 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m00:07:53.119020 [debug] [MainThread]: On debug: Close
[0m00:07:53.119155 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:07:53.119282 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:07:53.120557 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.17110063, "process_in_blocks": "0", "process_kernel_time": 0.118338, "process_mem_max_rss": "119013376", "process_out_blocks": "0", "process_user_time": 0.517062}
[0m00:07:53.120766 [debug] [MainThread]: Command `dbt debug` succeeded at 00:07:53.120721 after 0.17 seconds
[0m00:07:53.120891 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:07:53.121026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ad6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd4380>]}
[0m00:07:53.121179 [debug] [MainThread]: Flushing usage events
[0m00:07:53.334707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:57.600894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103565e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3ed0>]}


============================== 00:07:57.602738 | cd3990de-fb86-47f9-b027-03d3a99a5ace ==============================
[0m00:07:57.602738 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:07:57.603013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:57.661879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f25ba0>]}
[0m00:07:57.678761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e718c0>]}
[0m00:07:57.679108 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:07:57.710992 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:07:57.755379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:57.755555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:57.766658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7f850>]}
[0m00:07:57.789456 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:07:57.795015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:07:57.801954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e81400>]}
[0m00:07:57.802129 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m00:07:57.802262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107391a90>]}
[0m00:07:57.803089 [info ] [MainThread]: 
[0m00:07:57.803232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:57.803328 [info ] [MainThread]: 
[0m00:07:57.803512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:57.803834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:07:57.823999 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:07:57.824175 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:07:57.824283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:57.838527 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m00:07:57.839077 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:07:57.839351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now create_RetailSales_dw)
[0m00:07:57.839526 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw"
"
[0m00:07:57.841289 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw"
[0m00:07:57.841396 [debug] [ThreadPool]: On create_RetailSales_dw: BEGIN
[0m00:07:57.841482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:57.846830 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:07:57.846925 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw"
[0m00:07:57.847007 [debug] [ThreadPool]: On create_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw"} */
create schema if not exists "dw"
[0m00:07:57.850816 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m00:07:57.851101 [debug] [ThreadPool]: On create_RetailSales_dw: COMMIT
[0m00:07:57.851202 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw"
[0m00:07:57.851283 [debug] [ThreadPool]: On create_RetailSales_dw: COMMIT
[0m00:07:57.851949 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:07:57.852038 [debug] [ThreadPool]: On create_RetailSales_dw: Close
[0m00:07:57.852426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw, now list_RetailSales_dw)
[0m00:07:57.854306 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:07:57.854434 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m00:07:57.854530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:57.857275 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:07:57.857379 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:07:57.857474 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m00:07:57.862167 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:07:57.862598 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m00:07:57.862796 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m00:07:57.864364 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.864473 [debug] [MainThread]: On master: BEGIN
[0m00:07:57.864558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:57.867395 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:07:57.867494 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.867626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:07:57.879585 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m00:07:57.880024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107829090>]}
[0m00:07:57.880214 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:57.880474 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.880572 [debug] [MainThread]: On master: BEGIN
[0m00:07:57.880837 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:07:57.880935 [debug] [MainThread]: On master: COMMIT
[0m00:07:57.881027 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.881115 [debug] [MainThread]: On master: COMMIT
[0m00:07:57.881279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:57.881371 [debug] [MainThread]: On master: Close
[0m00:07:57.881856 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m00:07:57.882055 [info ] [Thread-1 (]: 1 of 1 START sql view model dw.stg_sales ....................................... [RUN]
[0m00:07:57.882226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_sales)
[0m00:07:57.882352 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m00:07:57.885053 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m00:07:57.885509 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m00:07:57.899288 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m00:07:57.899877 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:07:57.900005 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m00:07:57.900107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:57.904319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:07:57.904453 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:07:57.904564 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from source
  );
[0m00:07:57.912061 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m00:07:57.914208 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:07:57.914337 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m00:07:57.915051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:07:57.919968 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:07:57.920096 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:07:57.920203 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:07:57.920900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:07:57.922837 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."stg_sales__dbt_backup"
[0m00:07:57.924494 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:07:57.924615 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw"."stg_sales__dbt_backup" cascade
[0m00:07:57.924889 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:07:57.925727 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m00:07:57.926521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd3990de-fb86-47f9-b027-03d3a99a5ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107347710>]}
[0m00:07:57.926762 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw.stg_sales .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m00:07:57.926978 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m00:07:57.927462 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.927569 [debug] [MainThread]: On master: BEGIN
[0m00:07:57.927671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:57.930661 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:07:57.930796 [debug] [MainThread]: On master: COMMIT
[0m00:07:57.930906 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:57.931009 [debug] [MainThread]: On master: COMMIT
[0m00:07:57.931177 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:57.931272 [debug] [MainThread]: On master: Close
[0m00:07:57.931412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:57.931504 [debug] [MainThread]: Connection 'model.retail_warehouse.stg_sales' was properly closed.
[0m00:07:57.931603 [info ] [MainThread]: 
[0m00:07:57.931715 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m00:07:57.932114 [debug] [MainThread]: Command end result
[0m00:07:57.939227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:07:57.939975 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:07:57.942385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:07:57.942531 [info ] [MainThread]: 
[0m00:07:57.942688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:57.942790 [info ] [MainThread]: 
[0m00:07:57.942903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:07:57.944024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36749476, "process_in_blocks": "0", "process_kernel_time": 0.119488, "process_mem_max_rss": "129007616", "process_out_blocks": "0", "process_user_time": 0.661871}
[0m00:07:57.944203 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:57.944168 after 0.37 seconds
[0m00:07:57.944352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107323960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c54f0>]}
[0m00:07:57.944485 [debug] [MainThread]: Flushing usage events
[0m00:07:58.106815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:05.639756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104669e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c3ed0>]}


============================== 00:33:05.642079 | e3f9553c-4a5a-4c42-b192-32f3b7ca3095 ==============================
[0m00:33:05.642079 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:33:05.642343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:33:05.703384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3f9553c-4a5a-4c42-b192-32f3b7ca3095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c21ba0>]}
[0m00:33:05.719919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3f9553c-4a5a-4c42-b192-32f3b7ca3095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064718c0>]}
[0m00:33:05.720412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:33:05.753431 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:33:05.795586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:33:05.795779 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:33:05.795913 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:33:05.852561 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:33:05.855680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2421115, "process_in_blocks": "0", "process_kernel_time": 0.111882, "process_mem_max_rss": "119226368", "process_out_blocks": "0", "process_user_time": 0.599976}
[0m00:33:05.855986 [debug] [MainThread]: Command `dbt run` failed at 00:33:05.855928 after 0.24 seconds
[0m00:33:05.856206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078234d0>]}
[0m00:33:05.856397 [debug] [MainThread]: Flushing usage events
[0m00:33:06.071309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:29.338172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d29e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a83c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a83ed0>]}


============================== 00:33:29.339808 | ec2ea1a7-0069-45e5-b123-78882ef191d5 ==============================
[0m00:33:29.339808 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:33:29.340057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:33:29.393310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec2ea1a7-0069-45e5-b123-78882ef191d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5ba0>]}
[0m00:33:29.409912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec2ea1a7-0069-45e5-b123-78882ef191d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b318c0>]}
[0m00:33:29.410244 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:33:29.441531 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:33:29.475944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:33:29.476153 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:33:29.476286 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:33:29.531721 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:33:29.532880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.21714288, "process_in_blocks": "0", "process_kernel_time": 0.098878, "process_mem_max_rss": "120389632", "process_out_blocks": "0", "process_user_time": 0.590942}
[0m00:33:29.533076 [debug] [MainThread]: Command `dbt run` failed at 00:33:29.533032 after 0.22 seconds
[0m00:33:29.533224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782b4d0>]}
[0m00:33:29.533354 [debug] [MainThread]: Flushing usage events
[0m00:33:29.887170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:25.314464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121469e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225c3ed0>]}


============================== 00:34:25.316723 | 3c687ab3-62d1-476c-b763-148885b5a34b ==============================
[0m00:34:25.316723 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:34:25.316973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:25.372344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c687ab3-62d1-476c-b763-148885b5a34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121821ba0>]}
[0m00:34:25.388936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c687ab3-62d1-476c-b763-148885b5a34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226718c0>]}
[0m00:34:25.389480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:34:25.423160 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:34:25.465763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:34:25.466048 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:34:25.466216 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:34:25.521512 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:34:25.523606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.23243113, "process_in_blocks": "0", "process_kernel_time": 0.107513, "process_mem_max_rss": "119848960", "process_out_blocks": "0", "process_user_time": 0.592918}
[0m00:34:25.523809 [debug] [MainThread]: Command `dbt run` failed at 00:34:25.523768 after 0.23 seconds
[0m00:34:25.523965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12267fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12267fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235134d0>]}
[0m00:34:25.524095 [debug] [MainThread]: Flushing usage events
[0m00:34:25.751525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:07.041989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a79e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3ed0>]}


============================== 00:38:07.044200 | 3ed4ce71-5e61-4fdb-9376-7cb0db50c803 ==============================
[0m00:38:07.044200 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:38:07.044450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:38:07.100048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ed4ce71-5e61-4fdb-9376-7cb0db50c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d31ba0>]}
[0m00:38:07.117106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ed4ce71-5e61-4fdb-9376-7cb0db50c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048818c0>]}
[0m00:38:07.118271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:38:07.151938 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:38:07.194982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:38:07.195218 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:38:07.195356 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:38:07.250794 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:38:07.252848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.23421805, "process_in_blocks": "0", "process_kernel_time": 0.106233, "process_mem_max_rss": "119504896", "process_out_blocks": "0", "process_user_time": 0.597092}
[0m00:38:07.253049 [debug] [MainThread]: Command `dbt run` failed at 00:38:07.253008 after 0.23 seconds
[0m00:38:07.253205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf4d0>]}
[0m00:38:07.253340 [debug] [MainThread]: Flushing usage events
[0m00:38:07.504539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:16.611162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3ed0>]}


============================== 00:41:16.613414 | 2df8aacf-fdff-4ef0-b946-04f3cb153b90 ==============================
[0m00:41:16.613414 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:16.613658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:16.669039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2df8aacf-fdff-4ef0-b946-04f3cb153b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106421ba0>]}
[0m00:41:16.686485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2df8aacf-fdff-4ef0-b946-04f3cb153b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726d8c0>]}
[0m00:41:16.687753 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:16.720948 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:41:16.763681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:41:16.763872 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:41:16.763999 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:41:16.818892 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:41:16.820571 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.2337488, "process_in_blocks": "0", "process_kernel_time": 0.107507, "process_mem_max_rss": "119111680", "process_out_blocks": "0", "process_user_time": 0.59325}
[0m00:41:16.820773 [debug] [MainThread]: Command `dbt run-operation` failed at 00:41:16.820733 after 0.23 seconds
[0m00:41:16.820990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081134d0>]}
[0m00:41:16.821125 [debug] [MainThread]: Flushing usage events
[0m00:41:17.123043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:37.787251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190c3ed0>]}


============================== 00:41:37.788830 | de7d585f-64df-4dfa-9ce4-fefef67ac5c0 ==============================
[0m00:41:37.788830 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:37.789092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:37.798229 [info ] [MainThread]: dbt version: 1.9.0
[0m00:41:37.798565 [info ] [MainThread]: python version: 3.13.1
[0m00:41:37.798687 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m00:41:37.798778 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m00:41:37.819831 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m00:41:37.820085 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m00:41:37.820214 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m00:41:37.820432 [info ] [MainThread]: adapter type: postgres
[0m00:41:37.820533 [info ] [MainThread]: adapter version: 1.9.0
[0m00:41:37.853027 [info ] [MainThread]: Configuration:
[0m00:41:37.853251 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:41:37.853376 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:41:37.853476 [info ] [MainThread]: Required dependencies:
[0m00:41:37.853636 [debug] [MainThread]: Executing "git --help"
[0m00:41:37.863329 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:41:37.863726 [debug] [MainThread]: STDERR: "b''"
[0m00:41:37.863848 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:41:37.863984 [info ] [MainThread]: Connection:
[0m00:41:37.864118 [info ] [MainThread]:   host: localhost
[0m00:41:37.864213 [info ] [MainThread]:   port: 5432
[0m00:41:37.864310 [info ] [MainThread]:   user: postgres
[0m00:41:37.864405 [info ] [MainThread]:   database: RetailSales
[0m00:41:37.864502 [info ] [MainThread]:   schema: dw
[0m00:41:37.864599 [info ] [MainThread]:   connect_timeout: 10
[0m00:41:37.864701 [info ] [MainThread]:   role: None
[0m00:41:37.864792 [info ] [MainThread]:   search_path: None
[0m00:41:37.864888 [info ] [MainThread]:   keepalives_idle: 0
[0m00:41:37.864983 [info ] [MainThread]:   sslmode: None
[0m00:41:37.865076 [info ] [MainThread]:   sslcert: None
[0m00:41:37.865169 [info ] [MainThread]:   sslkey: None
[0m00:41:37.865265 [info ] [MainThread]:   sslrootcert: None
[0m00:41:37.865352 [info ] [MainThread]:   application_name: dbt
[0m00:41:37.865448 [info ] [MainThread]:   retries: 1
[0m00:41:37.865729 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:37.895398 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:41:37.914214 [debug] [MainThread]: Using postgres connection "debug"
[0m00:41:37.914381 [debug] [MainThread]: On debug: select 1 as id
[0m00:41:37.914490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:37.929172 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m00:41:37.929648 [debug] [MainThread]: On debug: Close
[0m00:41:37.929797 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:41:37.929931 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:41:37.931058 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.16606192, "process_in_blocks": "0", "process_kernel_time": 0.102714, "process_mem_max_rss": "120078336", "process_out_blocks": "0", "process_user_time": 0.50711}
[0m00:41:37.931255 [debug] [MainThread]: Command `dbt debug` succeeded at 00:41:37.931217 after 0.17 seconds
[0m00:41:37.931382 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:41:37.931512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119be56e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11956d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119548380>]}
[0m00:41:37.931674 [debug] [MainThread]: Flushing usage events
[0m00:41:38.088352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:44.094658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121071e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224c3ed0>]}


============================== 00:41:44.096318 | a11ced1c-2cf6-4b1f-95da-72b0ef92eb86 ==============================
[0m00:41:44.096318 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:44.096592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:41:44.149241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a11ced1c-2cf6-4b1f-95da-72b0ef92eb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121625ba0>]}
[0m00:41:44.166411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a11ced1c-2cf6-4b1f-95da-72b0ef92eb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12256d8c0>]}
[0m00:41:44.166748 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:44.197954 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:41:44.231342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:41:44.231546 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/products/stg_products.sql
[0m00:41:44.231686 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/sales/stg_sales.sql
[0m00:41:44.286491 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m00:41:44.287700 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.21526071, "process_in_blocks": "0", "process_kernel_time": 0.085069, "process_mem_max_rss": "120127488", "process_out_blocks": "0", "process_user_time": 0.577138}
[0m00:41:44.287886 [debug] [MainThread]: Command `dbt run-operation` failed at 00:41:44.287847 after 0.22 seconds
[0m00:41:44.288028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12257bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12257bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234174d0>]}
[0m00:41:44.288156 [debug] [MainThread]: Flushing usage events
[0m00:41:44.451585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:34.460128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73ed0>]}


============================== 00:46:34.462428 | 4467ea70-d1f8-4c07-bfad-85d3b9d490a2 ==============================
[0m00:46:34.462428 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:46:34.462681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:46:34.523269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4467ea70-d1f8-4c07-bfad-85d3b9d490a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d5ba0>]}
[0m00:46:34.540509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4467ea70-d1f8-4c07-bfad-85d3b9d490a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1d8c0>]}
[0m00:46:34.540951 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:46:34.574725 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:46:34.608512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:34.608672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:34.619865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4467ea70-d1f8-4c07-bfad-85d3b9d490a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2b850>]}
[0m00:46:34.642638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:46:34.648574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:46:34.656149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4467ea70-d1f8-4c07-bfad-85d3b9d490a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105954aa0>]}
[0m00:46:34.656321 [info ] [MainThread]: Found 2 models, 2 sources, 433 macros
[0m00:46:34.656455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4467ea70-d1f8-4c07-bfad-85d3b9d490a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b770>]}
[0m00:46:34.656665 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:46:34.656788 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:46:34.656884 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:46:34.656976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:46:34.674479 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:46:34.674662 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:46:34.674763 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:46:34.674850 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:46:34.675086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:46:34.675270 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:46:34.675430 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package
[0m00:46:34.676292 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package

[0m00:46:34.676472 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_yaml' in any package
[0m00:46:34.677822 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.24395588, "process_in_blocks": "0", "process_kernel_time": 0.110244, "process_mem_max_rss": "120619008", "process_out_blocks": "0", "process_user_time": 0.583444}
[0m00:46:34.677997 [debug] [MainThread]: Command `dbt run-operation` failed at 00:46:34.677962 after 0.24 seconds
[0m00:46:34.678108 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:46:34.678224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595c120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a49c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105980b90>]}
[0m00:46:34.678348 [debug] [MainThread]: Flushing usage events
[0m00:46:34.874724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:43.324244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109059e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c3ed0>]}


============================== 00:49:43.326529 | f0802b5e-2cb2-4a5d-9511-0ff85471b200 ==============================
[0m00:49:43.326529 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:49:43.326786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:49:43.364959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0802b5e-2cb2-4a5d-9511-0ff85471b200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109421ba0>]}
[0m00:49:43.374863 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:49:43.375338 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:49:43.376857 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.077659294, "process_in_blocks": "0", "process_kernel_time": 0.087738, "process_mem_max_rss": "108199936", "process_out_blocks": "0", "process_user_time": 0.46569}
[0m00:49:43.377040 [debug] [MainThread]: Command `dbt deps` succeeded at 00:49:43.376999 after 0.08 seconds
[0m00:49:43.377170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f5ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a033c50>]}
[0m00:49:43.377283 [debug] [MainThread]: Flushing usage events
[0m00:49:43.577736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:22.780088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3ed0>]}


============================== 00:52:22.782299 | 1450ca87-7220-4ad8-9918-41e60c4737f5 ==============================
[0m00:52:22.782299 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:52:22.782575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:52:22.820374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1450ca87-7220-4ad8-9918-41e60c4737f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021ba0>]}
[0m00:52:22.829665 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:52:22.830149 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:52:22.831637 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07548625, "process_in_blocks": "0", "process_kernel_time": 0.084909, "process_mem_max_rss": "108494848", "process_out_blocks": "0", "process_user_time": 0.463113}
[0m00:52:22.831823 [debug] [MainThread]: Command `dbt deps` succeeded at 00:52:22.831787 after 0.08 seconds
[0m00:52:22.831955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef1ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c33c50>]}
[0m00:52:22.832077 [debug] [MainThread]: Flushing usage events
[0m00:52:23.043704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:14.665304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104165e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebfed0>]}


============================== 00:54:14.667649 | 5397b4e3-c13f-4eb3-a941-13d04099fe77 ==============================
[0m00:54:14.667649 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:54:14.667901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m00:54:14.709458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5397b4e3-c13f-4eb3-a941-13d04099fe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441dba0>]}
[0m00:54:14.720080 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-lpq_pezr'
[0m00:54:14.720322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:54:14.779585 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:54:14.779944 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m00:54:14.830629 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m00:54:14.833170 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:54:14.886429 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:54:14.893084 [info ] [MainThread]: Updating lock file in file path: /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/package-lock.yml
[0m00:54:14.914860 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-9bu20mj5'
[0m00:54:14.916899 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:54:15.158822 [info ] [MainThread]: Installed from version 0.13.1
[0m00:54:15.159104 [info ] [MainThread]: Up to date!
[0m00:54:15.159319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5397b4e3-c13f-4eb3-a941-13d04099fe77', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502bce0>]}
[0m00:54:15.159544 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:54:15.391476 [info ] [MainThread]: Installed from version 1.3.0
[0m00:54:15.391728 [info ] [MainThread]: Up to date!
[0m00:54:15.391905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5397b4e3-c13f-4eb3-a941-13d04099fe77', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105027450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bb5c0>]}
[0m00:54:15.393836 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7591481, "process_in_blocks": "0", "process_kernel_time": 0.157325, "process_mem_max_rss": "111132672", "process_out_blocks": "0", "process_user_time": 0.517658}
[0m00:54:15.394073 [debug] [MainThread]: Command `dbt deps` succeeded at 00:54:15.394019 after 0.76 seconds
[0m00:54:15.394236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ac30>]}
[0m00:54:15.394386 [debug] [MainThread]: Flushing usage events
[0m00:54:15.638676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:27.964823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c3ed0>]}


============================== 00:55:27.967022 | f7ad9b25-da9d-4777-b6bd-e636dc3247e0 ==============================
[0m00:55:27.967022 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:55:27.967269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:28.024538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107321ba0>]}
[0m00:55:28.041947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016dae0>]}
[0m00:55:28.042351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:55:28.079547 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:55:28.106779 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:55:28.107012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110175b50>]}
[0m00:55:28.546977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110179400>]}
[0m00:55:28.571347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:55:28.577364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:55:28.583540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133cd550>]}
[0m00:55:28.583708 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m00:55:28.583834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ad9b25-da9d-4777-b6bd-e636dc3247e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112add570>]}
[0m00:55:28.584044 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:55:28.584166 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:55:28.584265 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:55:28.584355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:28.600052 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:55:28.600272 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:55:28.600380 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:55:28.600472 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:55:28.600678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:28.629727 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:55:28.629893 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:55:28.630149 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:55:28.630239 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:55:28.630339 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "RetailSales".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'
        
        and table_schema = 'dw'
        
      order by ordinal_position

  
[0m00:55:28.640643 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m00:55:28.641714 [info ] [MainThread]: version: 2

models:
  - name: stg_products
    description: ""
    columns:
[0m00:55:28.641887 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m00:55:28.642159 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:55:28.644682 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:55:28.646149 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.70458835, "process_in_blocks": "0", "process_kernel_time": 0.131273, "process_mem_max_rss": "132808704", "process_out_blocks": "0", "process_user_time": 1.008413}
[0m00:55:28.646315 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:55:28.646282 after 0.70 seconds
[0m00:55:28.646418 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:55:28.646526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c1440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c15a0>]}
[0m00:55:28.646650 [debug] [MainThread]: Flushing usage events
[0m00:55:28.807256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:57:48.677736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105071e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c3ed0>]}


============================== 00:57:48.679878 | 0f79aab6-5378-4951-b77d-d178088d7573 ==============================
[0m00:57:48.679878 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:57:48.680132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'send_anonymous_usage_stats': 'True'}
[0m00:57:48.737289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f79aab6-5378-4951-b77d-d178088d7573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105621ba0>]}
[0m00:57:48.754732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f79aab6-5378-4951-b77d-d178088d7573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656dae0>]}
[0m00:57:48.755205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:57:48.798758 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:57:48.847887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:57:48.848064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:57:48.859288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f79aab6-5378-4951-b77d-d178088d7573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e8250>]}
[0m00:57:48.884373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:57:48.889404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:57:48.895366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f79aab6-5378-4951-b77d-d178088d7573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072317c0>]}
[0m00:57:48.895543 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m00:57:48.895683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f79aab6-5378-4951-b77d-d178088d7573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107227af0>]}
[0m00:57:48.895899 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m00:57:48.896023 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:57:48.896122 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:57:48.896206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:57:48.910919 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m00:57:48.911126 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:57:48.911234 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:57:48.911324 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m00:57:48.911507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:57:48.939343 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:57:48.939489 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m00:57:48.939757 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:57:48.939848 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m00:57:48.939937 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "RetailSales".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'
        
        and table_schema = 'dw'
        
      order by ordinal_position

  
[0m00:57:48.951320 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m00:57:48.952412 [info ] [MainThread]: version: 2

models:
  - name: stg_products
    description: ""
    columns:
[0m00:57:48.952578 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m00:57:48.952839 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m00:57:48.955233 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:57:48.956779 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.30323997, "process_in_blocks": "0", "process_kernel_time": 0.12339, "process_mem_max_rss": "126828544", "process_out_blocks": "0", "process_user_time": 0.617881}
[0m00:57:48.956981 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:57:48.956940 after 0.30 seconds
[0m00:57:48.957104 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:57:48.957224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076da680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106399c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b2d50>]}
[0m00:57:48.957348 [debug] [MainThread]: Flushing usage events
[0m00:57:49.293344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:41.803570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e05e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5fed0>]}


============================== 01:01:41.805802 | 8d60e1de-ceee-49f6-83be-38fa42ae5761 ==============================
[0m01:01:41.805802 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:01:41.806070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:01:41.870459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d60e1de-ceee-49f6-83be-38fa42ae5761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bdba0>]}
[0m01:01:41.888056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d60e1de-ceee-49f6-83be-38fa42ae5761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c09ae0>]}
[0m01:01:41.888545 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:01:41.926114 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:01:41.962664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:01:41.962820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:01:41.973824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d60e1de-ceee-49f6-83be-38fa42ae5761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109940250>]}
[0m01:01:41.999475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:01:42.005057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:01:42.012481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d60e1de-ceee-49f6-83be-38fa42ae5761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098757c0>]}
[0m01:01:42.012661 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:01:42.012797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d60e1de-ceee-49f6-83be-38fa42ae5761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999faf0>]}
[0m01:01:42.013026 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m01:01:42.013154 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:01:42.013253 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:01:42.013343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:42.093781 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m01:01:42.094010 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:01:42.094123 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:01:42.094219 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:01:42.094484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:01:42.130032 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:01:42.130244 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:01:42.130586 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:01:42.130693 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:01:42.130798 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "RetailSales".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'
        
        and table_schema = 'dw'
        
      order by ordinal_position

  
[0m01:01:42.145234 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m01:01:42.146613 [info ] [MainThread]: version: 2

models:
  - name: stg_products
    description: ""
    columns:
[0m01:01:42.146812 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m01:01:42.147078 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m01:01:42.150013 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:01:42.151568 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.3737863, "process_in_blocks": "0", "process_kernel_time": 0.127172, "process_mem_max_rss": "129564672", "process_out_blocks": "0", "process_user_time": 0.615969}
[0m01:01:42.151799 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:01:42.151753 after 0.37 seconds
[0m01:01:42.151939 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:01:42.152092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c22680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f6d50>]}
[0m01:01:42.152233 [debug] [MainThread]: Flushing usage events
[0m01:01:42.435816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:17.153203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc3ed0>]}


============================== 01:06:17.155488 | feaecd74-056e-4b8b-8559-675910f29e14 ==============================
[0m01:06:17.155488 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:06:17.155750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_products"]}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:17.220059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feaecd74-056e-4b8b-8559-675910f29e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105121ba0>]}
[0m01:06:17.237713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feaecd74-056e-4b8b-8559-675910f29e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606dae0>]}
[0m01:06:17.238209 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:06:17.274765 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:06:17.313328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:17.313484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:17.324266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feaecd74-056e-4b8b-8559-675910f29e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef0250>]}
[0m01:06:17.349439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:06:17.355538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:06:17.363757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feaecd74-056e-4b8b-8559-675910f29e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e317c0>]}
[0m01:06:17.363934 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:06:17.364071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feaecd74-056e-4b8b-8559-675910f29e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2baf0>]}
[0m01:06:17.364291 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m01:06:17.364419 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:06:17.364509 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:06:17.364592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:17.381684 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:06:17.381899 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:06:17.382007 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:06:17.382098 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:06:17.382310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:06:17.412262 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:06:17.412433 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:06:17.412736 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:06:17.412827 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:06:17.412917 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "RetailSales".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'
        
        and table_schema = 'dw'
        
      order by ordinal_position

  
[0m01:06:17.424577 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m01:06:17.425725 [info ] [MainThread]: version: 2

models:
  - name: stg_products
    description: ""
    columns:
[0m01:06:17.425896 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m01:06:17.426182 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m01:06:17.428472 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:06:17.429780 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.3022318, "process_in_blocks": "0", "process_kernel_time": 0.129148, "process_mem_max_rss": "127025152", "process_out_blocks": "0", "process_user_time": 0.609988}
[0m01:06:17.429970 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:06:17.429933 after 0.30 seconds
[0m01:06:17.430085 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:06:17.430201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071da680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb2d50>]}
[0m01:06:17.430319 [debug] [MainThread]: Flushing usage events
[0m01:06:17.693760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:40.776052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107159e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c3ed0>]}


============================== 01:08:40.778420 | fb28032d-f8fc-4cd2-bf69-6ae060b8376f ==============================
[0m01:08:40.778420 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:08:40.778686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:08:40.814567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb28032d-f8fc-4cd2-bf69-6ae060b8376f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107521ba0>]}
[0m01:08:40.842162 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-clq8ujdm'
[0m01:08:40.842372 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:08:41.016913 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:08:41.017652 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:08:41.078075 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:08:41.081579 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:08:41.140396 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:08:41.142908 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:08:41.390625 [info ] [MainThread]: Installed from version 0.13.1
[0m01:08:41.390942 [info ] [MainThread]: Up to date!
[0m01:08:41.391181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb28032d-f8fc-4cd2-bf69-6ae060b8376f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832fce0>]}
[0m01:08:41.391429 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:08:41.618995 [info ] [MainThread]: Installed from version 1.3.0
[0m01:08:41.619246 [info ] [MainThread]: Up to date!
[0m01:08:41.619418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb28032d-f8fc-4cd2-bf69-6ae060b8376f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108327650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ab5c0>]}
[0m01:08:41.621245 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.87278825, "process_in_blocks": "0", "process_kernel_time": 0.155422, "process_mem_max_rss": "112328704", "process_out_blocks": "0", "process_user_time": 0.533714}
[0m01:08:41.621472 [debug] [MainThread]: Command `dbt deps` succeeded at 01:08:41.621420 after 0.87 seconds
[0m01:08:41.621628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108046ea0>]}
[0m01:08:41.621770 [debug] [MainThread]: Flushing usage events
[0m01:08:41.860301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:11.804862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110561e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119c3ed0>]}


============================== 01:09:11.806496 | d4fe2e62-bf85-41ff-a781-566ddb5b020b ==============================
[0m01:09:11.806496 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:09:11.806760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_source_yaml --args {"source_name":"oltp","table_name":"products"}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:09:11.864904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4fe2e62-bf85-41ff-a781-566ddb5b020b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b21ba0>]}
[0m01:09:11.882457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4fe2e62-bf85-41ff-a781-566ddb5b020b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a6dae0>]}
[0m01:09:11.883696 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:09:11.920882 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:09:11.966411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:09:11.966568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:09:11.977490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4fe2e62-bf85-41ff-a781-566ddb5b020b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be4250>]}
[0m01:09:12.003638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:09:12.008668 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:09:12.012408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4fe2e62-bf85-41ff-a781-566ddb5b020b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2d7c0>]}
[0m01:09:12.012603 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:09:12.012742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fe2e62-bf85-41ff-a781-566ddb5b020b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b27af0>]}
[0m01:09:12.012970 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_source_yaml'
[0m01:09:12.013103 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:09:12.013204 [debug] [MainThread]: On macro_generate_source_yaml: BEGIN
[0m01:09:12.013289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:12.027397 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m01:09:12.027574 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:09:12.027680 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:09:12.027776 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:09:12.028085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:09:12.028331 [debug] [MainThread]: On macro_generate_source_yaml: Close
[0m01:09:12.028507 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package
[0m01:09:12.029354 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package

[0m01:09:12.029504 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_source_yaml' in any package
[0m01:09:12.030572 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.24876471, "process_in_blocks": "0", "process_kernel_time": 0.097879, "process_mem_max_rss": "121946112", "process_out_blocks": "0", "process_user_time": 0.582144}
[0m01:09:12.030733 [debug] [MainThread]: Command `dbt run-operation` failed at 01:09:12.030698 after 0.25 seconds
[0m01:09:12.030840 [debug] [MainThread]: Connection 'macro_generate_source_yaml' was properly closed.
[0m01:09:12.030947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130475f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111799c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c1610>]}
[0m01:09:12.031068 [debug] [MainThread]: Flushing usage events
[0m01:09:12.177289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:59.925064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105851e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065abed0>]}


============================== 01:09:59.927406 | 928c6f17-6c3e-4ca1-856c-7a4a76d6b7b5 ==============================
[0m01:09:59.927406 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:09:59.927649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:09:59.964125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '928c6f17-6c3e-4ca1-856c-7a4a76d6b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b09ba0>]}
[0m01:09:59.986504 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-ls4dz85b'
[0m01:09:59.986706 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:10:00.128822 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:10:00.129346 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:10:00.210755 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:10:00.213946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:10:00.269152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:10:00.271700 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:10:00.486829 [info ] [MainThread]: Installed from version 0.13.1
[0m01:10:00.487154 [info ] [MainThread]: Up to date!
[0m01:10:00.487403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '928c6f17-6c3e-4ca1-856c-7a4a76d6b7b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dbce0>]}
[0m01:10:00.487661 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:10:00.720512 [info ] [MainThread]: Installed from version 1.3.0
[0m01:10:00.720765 [info ] [MainThread]: Up to date!
[0m01:10:00.720945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '928c6f17-6c3e-4ca1-856c-7a4a76d6b7b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106717650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a75c0>]}
[0m01:10:00.723004 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8221041, "process_in_blocks": "0", "process_kernel_time": 0.150014, "process_mem_max_rss": "112082944", "process_out_blocks": "0", "process_user_time": 0.523101}
[0m01:10:00.723232 [debug] [MainThread]: Command `dbt deps` succeeded at 01:10:00.723182 after 0.82 seconds
[0m01:10:00.723397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642eea0>]}
[0m01:10:00.723541 [debug] [MainThread]: Flushing usage events
[0m01:10:00.951170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:15.403634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121469e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226c3ed0>]}


============================== 01:10:15.405887 | cae54743-6832-4a91-a24d-b5dfb103d6eb ==============================
[0m01:10:15.405887 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:10:15.406142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_source_yaml --args {"source_name":"oltp","table_name":"products"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:15.464703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae54743-6832-4a91-a24d-b5dfb103d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121821ba0>]}
[0m01:10:15.482001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae54743-6832-4a91-a24d-b5dfb103d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12276dae0>]}
[0m01:10:15.482553 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:10:15.520473 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:10:15.568453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:15.568605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:15.579508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae54743-6832-4a91-a24d-b5dfb103d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236e8250>]}
[0m01:10:15.604547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:10:15.609416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:10:15.615723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cae54743-6832-4a91-a24d-b5dfb103d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12362d7c0>]}
[0m01:10:15.615900 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:10:15.616034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae54743-6832-4a91-a24d-b5dfb103d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123627af0>]}
[0m01:10:15.616244 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_source_yaml'
[0m01:10:15.616372 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:10:15.616472 [debug] [MainThread]: On macro_generate_source_yaml: BEGIN
[0m01:10:15.616568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:15.632343 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m01:10:15.632534 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:10:15.632643 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:10:15.632738 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:10:15.632971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:10:15.633182 [debug] [MainThread]: On macro_generate_source_yaml: Close
[0m01:10:15.633341 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package
[0m01:10:15.634106 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package

[0m01:10:15.634251 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_source_yaml' in any package
[0m01:10:15.635634 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.25583574, "process_in_blocks": "0", "process_kernel_time": 0.109992, "process_mem_max_rss": "123142144", "process_out_blocks": "0", "process_user_time": 0.591155}
[0m01:10:15.635802 [debug] [MainThread]: Command `dbt run-operation` failed at 01:10:15.635769 after 0.26 seconds
[0m01:10:15.635913 [debug] [MainThread]: Connection 'macro_generate_source_yaml' was properly closed.
[0m01:10:15.636024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12373b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122599c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237a9610>]}
[0m01:10:15.636145 [debug] [MainThread]: Flushing usage events
[0m01:10:15.793637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:20.628615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122069e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc3ed0>]}


============================== 01:10:20.630254 | 7fc6d70b-4952-4b4f-8831-687516683359 ==============================
[0m01:10:20.630254 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:10:20.630509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_source_yaml --args {"source_name":"oltp","table_name":"products"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:10:20.684655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc6d70b-4952-4b4f-8831-687516683359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122421ba0>]}
[0m01:10:20.702125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc6d70b-4952-4b4f-8831-687516683359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d6dae0>]}
[0m01:10:20.702456 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:10:20.737614 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:10:20.774622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:20.774775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:20.785672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc6d70b-4952-4b4f-8831-687516683359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124994250>]}
[0m01:10:20.811262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:10:20.814217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:10:20.817623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc6d70b-4952-4b4f-8831-687516683359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248dd7c0>]}
[0m01:10:20.817800 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:10:20.817984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc6d70b-4952-4b4f-8831-687516683359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248d7af0>]}
[0m01:10:20.818210 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_source_yaml'
[0m01:10:20.818341 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:10:20.818442 [debug] [MainThread]: On macro_generate_source_yaml: BEGIN
[0m01:10:20.818541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:20.831321 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:10:20.831517 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:10:20.831620 [debug] [MainThread]: Using postgres connection "macro_generate_source_yaml"
[0m01:10:20.831713 [debug] [MainThread]: On macro_generate_source_yaml: COMMIT
[0m01:10:20.832057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:10:20.832264 [debug] [MainThread]: On macro_generate_source_yaml: Close
[0m01:10:20.832420 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package
[0m01:10:20.833017 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1259, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_source_yaml" in any package

[0m01:10:20.833172 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_source_yaml' in any package
[0m01:10:20.834256 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.2279832, "process_in_blocks": "0", "process_kernel_time": 0.113903, "process_mem_max_rss": "123387904", "process_out_blocks": "0", "process_user_time": 0.606514}
[0m01:10:20.834423 [debug] [MainThread]: Command `dbt run-operation` failed at 01:10:20.834391 after 0.23 seconds
[0m01:10:20.834579 [debug] [MainThread]: Connection 'macro_generate_source_yaml' was properly closed.
[0m01:10:20.834766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a59610>]}
[0m01:10:20.834948 [debug] [MainThread]: Flushing usage events
[0m01:10:21.025231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:52.338695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180c3ed0>]}


============================== 01:15:52.340920 | db01d713-0186-4132-982a-3f11e7caf1c9 ==============================
[0m01:15:52.340920 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:15:52.341167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:15:52.376370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db01d713-0186-4132-982a-3f11e7caf1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107325ba0>]}
[0m01:15:52.384799 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-f_m8rci0'
[0m01:15:52.384998 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:15:52.440043 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:15:52.440400 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:15:52.493766 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:15:52.496377 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:15:52.552856 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:15:52.560477 [info ] [MainThread]: Updating lock file in file path: /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/package-lock.yml
[0m01:15:52.581273 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-y6dbvx2e'
[0m01:15:52.583268 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:15:52.804166 [info ] [MainThread]: Installed from version 0.13.1
[0m01:15:52.804435 [info ] [MainThread]: Up to date!
[0m01:15:52.804635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db01d713-0186-4132-982a-3f11e7caf1c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f3ce0>]}
[0m01:15:52.804839 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:15:53.040471 [info ] [MainThread]: Installed from version 1.3.0
[0m01:15:53.040796 [info ] [MainThread]: Up to date!
[0m01:15:53.041019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db01d713-0186-4132-982a-3f11e7caf1c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11822b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c075c0>]}
[0m01:15:53.042983 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72882855, "process_in_blocks": "0", "process_kernel_time": 0.148418, "process_mem_max_rss": "111329280", "process_out_blocks": "0", "process_user_time": 0.515593}
[0m01:15:53.043241 [debug] [MainThread]: Command `dbt deps` succeeded at 01:15:53.043181 after 0.73 seconds
[0m01:15:53.043445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181d1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11826ec30>]}
[0m01:15:53.043594 [debug] [MainThread]: Flushing usage events
[0m01:15:53.270571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:28.375201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3ed0>]}


============================== 01:16:28.377398 | 58ed5c49-e072-4dcd-9dfd-0c3d5e199048 ==============================
[0m01:16:28.377398 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:16:28.377669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names":["stg_products"]}', 'send_anonymous_usage_stats': 'True'}
[0m01:16:28.436393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ed5c49-e072-4dcd-9dfd-0c3d5e199048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e25ba0>]}
[0m01:16:28.453590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ed5c49-e072-4dcd-9dfd-0c3d5e199048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6dae0>]}
[0m01:16:28.454728 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:16:28.493251 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:16:28.540932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:16:28.541202 [debug] [MainThread]: Partial parsing: updated file: retail_warehouse://models/staging/products/schema.yml
[0m01:16:28.599627 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_products' (models/staging/products/stg_products.sql) depends on a source named 'oltp.products' which was not found
[0m01:16:28.601330 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.24956696, "process_in_blocks": "0", "process_kernel_time": 0.124063, "process_mem_max_rss": "121061376", "process_out_blocks": "0", "process_user_time": 0.648979}
[0m01:16:28.601541 [debug] [MainThread]: Command `dbt run-operation` failed at 01:16:28.601499 after 0.25 seconds
[0m01:16:28.601691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f40410>]}
[0m01:16:28.601820 [debug] [MainThread]: Flushing usage events
[0m01:16:28.760279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:23.863394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104449e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105363c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105363ed0>]}


============================== 01:17:23.865725 | 97d311b4-caa0-456e-9a5f-8c513952a047 ==============================
[0m01:17:23.865725 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:17:23.865992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names":["stg_products"]}', 'send_anonymous_usage_stats': 'True'}
[0m01:17:23.923639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d311b4-caa0-456e-9a5f-8c513952a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bdba0>]}
[0m01:17:23.940832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97d311b4-caa0-456e-9a5f-8c513952a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540dae0>]}
[0m01:17:23.943613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:17:23.979807 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:17:24.016619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:24.016802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:24.027698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97d311b4-caa0-456e-9a5f-8c513952a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f74250>]}
[0m01:17:24.053019 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:17:24.058893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:17:24.065323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97d311b4-caa0-456e-9a5f-8c513952a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb17c0>]}
[0m01:17:24.065508 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:17:24.065652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97d311b4-caa0-456e-9a5f-8c513952a047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eabaf0>]}
[0m01:17:24.065879 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m01:17:24.066010 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:17:24.066110 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:17:24.066207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:24.081111 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m01:17:24.081299 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:17:24.081407 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:17:24.081499 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m01:17:24.081715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:17:24.111708 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:17:24.111889 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m01:17:24.112245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:17:24.112402 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m01:17:24.112522 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "RetailSales".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'
        
        and table_schema = 'dw'
        
      order by ordinal_position

  
[0m01:17:24.125997 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m01:17:24.127103 [info ] [MainThread]: version: 2

models:
  - name: stg_products
    description: ""
    columns:
[0m01:17:24.127285 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m01:17:24.127541 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m01:17:24.129970 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:17:24.131402 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.29353145, "process_in_blocks": "0", "process_kernel_time": 0.120318, "process_mem_max_rss": "125730816", "process_out_blocks": "0", "process_user_time": 0.606573}
[0m01:17:24.131568 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:17:24.131537 after 0.29 seconds
[0m01:17:24.131679 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:17:24.131796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602ed50>]}
[0m01:17:24.131939 [debug] [MainThread]: Flushing usage events
[0m01:17:24.377539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:19.018657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103879e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d3ed0>]}


============================== 01:29:19.021144 | e4da299d-b555-4ca5-8bf3-e40ea3074954 ==============================
[0m01:29:19.021144 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:29:19.021404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_products', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:29:19.090718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b35ba0>]}
[0m01:29:19.112195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104681ae0>]}
[0m01:29:19.112945 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:29:19.151591 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:29:19.194741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:29:19.194940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:29:19.207121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b4450>]}
[0m01:29:19.234257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:29:19.240690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:29:19.251364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468f5c0>]}
[0m01:29:19.251561 [info ] [MainThread]: Found 2 models, 2 sources, 571 macros
[0m01:29:19.251703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c9710>]}
[0m01:29:19.252256 [info ] [MainThread]: 
[0m01:29:19.252398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:29:19.252501 [info ] [MainThread]: 
[0m01:29:19.252694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:29:19.253022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:29:19.276778 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:29:19.276986 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:29:19.277099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:19.295471 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m01:29:19.296147 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:29:19.297928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:29:19.300348 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:29:19.300534 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:29:19.300634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:19.306974 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m01:29:19.307151 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:29:19.307257 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:29:19.313268 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m01:29:19.313743 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:29:19.313984 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:29:19.315619 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.315748 [debug] [MainThread]: On master: BEGIN
[0m01:29:19.315839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:19.320040 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:29:19.320220 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.320369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:29:19.334887 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m01:29:19.335427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105851090>]}
[0m01:29:19.335613 [debug] [MainThread]: On master: ROLLBACK
[0m01:29:19.335854 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.335947 [debug] [MainThread]: On master: BEGIN
[0m01:29:19.336206 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:29:19.336300 [debug] [MainThread]: On master: COMMIT
[0m01:29:19.336384 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.336462 [debug] [MainThread]: On master: COMMIT
[0m01:29:19.336616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:29:19.336705 [debug] [MainThread]: On master: Close
[0m01:29:19.337528 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m01:29:19.337711 [info ] [Thread-1 (]: 1 of 1 START sql view model dw.stg_products .................................... [RUN]
[0m01:29:19.337886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_products)
[0m01:29:19.338001 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m01:29:19.340832 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m01:29:19.341383 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m01:29:19.354590 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m01:29:19.355228 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:29:19.355377 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m01:29:19.355492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:19.359300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:29:19.359505 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:29:19.359658 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m01:29:19.363653 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:29:19.366222 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:29:19.366383 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:29:19.366792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:29:19.372004 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:29:19.372151 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:29:19.372263 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:29:19.372859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:29:19.374886 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."stg_products__dbt_backup"
[0m01:29:19.376583 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:29:19.376716 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw"."stg_products__dbt_backup" cascade
[0m01:29:19.376997 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:29:19.377874 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m01:29:19.378705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4da299d-b555-4ca5-8bf3-e40ea3074954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dc110>]}
[0m01:29:19.378953 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw.stg_products ............................... [[32mCREATE VIEW[0m in 0.04s]
[0m01:29:19.379179 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m01:29:19.379674 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.379778 [debug] [MainThread]: On master: BEGIN
[0m01:29:19.379872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:19.382981 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:29:19.383082 [debug] [MainThread]: On master: COMMIT
[0m01:29:19.383166 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:19.383247 [debug] [MainThread]: On master: COMMIT
[0m01:29:19.383413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:29:19.383501 [debug] [MainThread]: On master: Close
[0m01:29:19.383620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:19.383704 [debug] [MainThread]: Connection 'model.retail_warehouse.stg_products' was properly closed.
[0m01:29:19.383796 [info ] [MainThread]: 
[0m01:29:19.383910 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:29:19.384307 [debug] [MainThread]: Command end result
[0m01:29:19.393864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:29:19.394728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:29:19.397383 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:29:19.397565 [info ] [MainThread]: 
[0m01:29:19.397720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:29:19.397824 [info ] [MainThread]: 
[0m01:29:19.397937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:29:19.399540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40789875, "process_in_blocks": "0", "process_kernel_time": 0.139945, "process_mem_max_rss": "128811008", "process_out_blocks": "0", "process_user_time": 0.706275}
[0m01:29:19.399793 [debug] [MainThread]: Command `dbt run` succeeded at 01:29:19.399749 after 0.41 seconds
[0m01:29:19.399975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b1090>]}
[0m01:29:19.400133 [debug] [MainThread]: Flushing usage events
[0m01:29:19.620291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:07.281054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109569e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc3ed0>]}


============================== 01:32:07.283329 | c5cf6dca-7f52-431f-bbe3-9b4dab174af3 ==============================
[0m01:32:07.283329 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:32:07.283592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:32:07.350961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a121ba0>]}
[0m01:32:07.369755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b071ae0>]}
[0m01:32:07.370308 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:32:07.408409 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:32:07.459369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:32:07.459535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:32:07.472161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed4450>]}
[0m01:32:07.499291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:32:07.504625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:32:07.515254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07f5c0>]}
[0m01:32:07.515437 [info ] [MainThread]: Found 3 models, 3 sources, 571 macros
[0m01:32:07.515571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c109470>]}
[0m01:32:07.516182 [info ] [MainThread]: 
[0m01:32:07.516334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:07.516442 [info ] [MainThread]: 
[0m01:32:07.516634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:32:07.516975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:32:07.539803 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:32:07.539990 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:32:07.540100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:07.559052 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m01:32:07.559662 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:32:07.561667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:32:07.563722 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:32:07.563847 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:32:07.563948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:07.569201 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:32:07.569326 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:32:07.569433 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:32:07.573126 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m01:32:07.573628 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:32:07.573834 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:32:07.575928 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.576087 [debug] [MainThread]: On master: BEGIN
[0m01:32:07.576181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:07.582098 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m01:32:07.582218 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.582344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:32:07.598076 [debug] [MainThread]: SQL status: SELECT 2 in 0.015 seconds
[0m01:32:07.599814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c33da50>]}
[0m01:32:07.600188 [debug] [MainThread]: On master: ROLLBACK
[0m01:32:07.600518 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.600689 [debug] [MainThread]: On master: BEGIN
[0m01:32:07.601021 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:32:07.601215 [debug] [MainThread]: On master: COMMIT
[0m01:32:07.601327 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.601419 [debug] [MainThread]: On master: COMMIT
[0m01:32:07.601593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:32:07.601695 [debug] [MainThread]: On master: Close
[0m01:32:07.602435 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m01:32:07.602653 [info ] [Thread-1 (]: 1 of 1 START sql view model dw.stg_customers ................................... [RUN]
[0m01:32:07.602841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_customers)
[0m01:32:07.602952 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m01:32:07.605889 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m01:32:07.606421 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m01:32:07.619276 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m01:32:07.619765 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:32:07.619894 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m01:32:07.620003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:07.623087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:32:07.623296 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:32:07.623459 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m01:32:07.626209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:32:07.628672 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:32:07.628815 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:32:07.629170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:32:07.634794 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:32:07.635003 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:32:07.635116 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:32:07.635539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:32:07.637666 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."stg_customers__dbt_backup"
[0m01:32:07.639397 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:32:07.639526 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw"."stg_customers__dbt_backup" cascade
[0m01:32:07.639777 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:32:07.640734 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m01:32:07.641589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5cf6dca-7f52-431f-bbe3-9b4dab174af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c530350>]}
[0m01:32:07.641818 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m01:32:07.642030 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m01:32:07.642555 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.642684 [debug] [MainThread]: On master: BEGIN
[0m01:32:07.642783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:07.646416 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:32:07.646517 [debug] [MainThread]: On master: COMMIT
[0m01:32:07.646606 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:07.646686 [debug] [MainThread]: On master: COMMIT
[0m01:32:07.646828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:32:07.646910 [debug] [MainThread]: On master: Close
[0m01:32:07.647022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:07.647100 [debug] [MainThread]: Connection 'model.retail_warehouse.stg_customers' was properly closed.
[0m01:32:07.647190 [info ] [MainThread]: 
[0m01:32:07.647305 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:32:07.647661 [debug] [MainThread]: Command end result
[0m01:32:07.657395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:32:07.658346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:32:07.660906 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:32:07.661088 [info ] [MainThread]: 
[0m01:32:07.661258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:07.661376 [info ] [MainThread]: 
[0m01:32:07.661502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:32:07.663286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40906337, "process_in_blocks": "0", "process_kernel_time": 0.135033, "process_mem_max_rss": "128466944", "process_out_blocks": "0", "process_user_time": 0.690961}
[0m01:32:07.663492 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:07.663457 after 0.41 seconds
[0m01:32:07.663668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c374890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c504b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c504d70>]}
[0m01:32:07.663802 [debug] [MainThread]: Flushing usage events
[0m01:32:07.898766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:33:59.864571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e09e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201c3ed0>]}


============================== 01:33:59.866868 | f29bc0eb-9ed5-45a1-a068-2c86c5bdb012 ==============================
[0m01:33:59.866868 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:33:59.867120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_promotions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:59.932953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f29bc0eb-9ed5-45a1-a068-2c86c5bdb012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421ba0>]}
[0m01:33:59.951689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f29bc0eb-9ed5-45a1-a068-2c86c5bdb012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120271ae0>]}
[0m01:33:59.952219 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:33:59.994185 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:34:00.046226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:34:00.046486 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/promotions/schema.yml
[0m01:34:00.046607 [debug] [MainThread]: Partial parsing: added file: retail_warehouse://models/staging/promotions/stg_promotions.sql
[0m01:34:00.130159 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_warehouse.stg_promotions' (models/staging/promotions/stg_promotions.sql) depends on a source named 'oltp.promotions' which was not found
[0m01:34:00.133025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2969647, "process_in_blocks": "0", "process_kernel_time": 0.117245, "process_mem_max_rss": "120389632", "process_out_blocks": "0", "process_user_time": 0.655032}
[0m01:34:00.133244 [debug] [MainThread]: Command `dbt run` failed at 01:34:00.133198 after 0.30 seconds
[0m01:34:00.133430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220f0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220f1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12224c140>]}
[0m01:34:00.133569 [debug] [MainThread]: Flushing usage events
[0m01:34:00.346125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:10.693593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108869e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc3ed0>]}


============================== 01:37:10.695823 | d236797e-c280-446f-bd6d-6aeb25ff075a ==============================
[0m01:37:10.695823 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:37:10.696092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_promotions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:37:10.763773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e25ba0>]}
[0m01:37:10.783596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d75ae0>]}
[0m01:37:10.784269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:37:10.823848 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:37:10.866831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:10.867028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:10.879292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aacc450>]}
[0m01:37:10.907026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:37:10.913058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:37:10.924448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d835c0>]}
[0m01:37:10.924671 [info ] [MainThread]: Found 4 models, 4 sources, 571 macros
[0m01:37:10.924816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abfda90>]}
[0m01:37:10.925413 [info ] [MainThread]: 
[0m01:37:10.925552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:10.925653 [info ] [MainThread]: 
[0m01:37:10.925846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:37:10.926191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:37:10.949548 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:37:10.949737 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:37:10.949856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:10.966883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m01:37:10.967463 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:37:10.969321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:37:10.971638 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:37:10.971772 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:37:10.971872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:10.976755 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:37:10.976891 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:37:10.976996 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:37:10.982821 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m01:37:10.983297 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:37:10.983493 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:37:10.985372 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:10.985501 [debug] [MainThread]: On master: BEGIN
[0m01:37:10.985594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:10.991208 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m01:37:10.991316 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:10.991447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:37:11.006842 [debug] [MainThread]: SQL status: SELECT 3 in 0.015 seconds
[0m01:37:11.007611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae16410>]}
[0m01:37:11.007819 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:11.008072 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:11.008171 [debug] [MainThread]: On master: BEGIN
[0m01:37:11.008437 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:37:11.008540 [debug] [MainThread]: On master: COMMIT
[0m01:37:11.008633 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:11.008716 [debug] [MainThread]: On master: COMMIT
[0m01:37:11.008875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:11.008974 [debug] [MainThread]: On master: Close
[0m01:37:11.009515 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m01:37:11.009704 [info ] [Thread-1 (]: 1 of 1 START sql view model dw.stg_promotions .................................. [RUN]
[0m01:37:11.009873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_promotions)
[0m01:37:11.009995 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m01:37:11.012896 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m01:37:11.013493 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m01:37:11.027160 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m01:37:11.027670 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:11.027787 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m01:37:11.027895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:11.032140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:37:11.032314 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:11.032457 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m01:37:11.036043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:11.038231 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:11.038381 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m01:37:11.038866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:11.044170 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:37:11.044356 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:11.044471 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:37:11.045423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:11.047492 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."stg_promotions__dbt_backup"
[0m01:37:11.049195 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:11.049327 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw"."stg_promotions__dbt_backup" cascade
[0m01:37:11.049681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:11.050574 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m01:37:11.051393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd236797e-c280-446f-bd6d-6aeb25ff075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1244d0>]}
[0m01:37:11.051654 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw.stg_promotions ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m01:37:11.051902 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m01:37:11.052411 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:11.052543 [debug] [MainThread]: On master: BEGIN
[0m01:37:11.052648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:11.059440 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:37:11.059566 [debug] [MainThread]: On master: COMMIT
[0m01:37:11.059669 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:11.059764 [debug] [MainThread]: On master: COMMIT
[0m01:37:11.059936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:11.060025 [debug] [MainThread]: On master: Close
[0m01:37:11.060149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:11.060234 [debug] [MainThread]: Connection 'model.retail_warehouse.stg_promotions' was properly closed.
[0m01:37:11.060327 [info ] [MainThread]: 
[0m01:37:11.060444 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:37:11.060680 [debug] [MainThread]: Command end result
[0m01:37:11.070739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:37:11.071633 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:37:11.074276 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:37:11.074432 [info ] [MainThread]: 
[0m01:37:11.074611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:11.074777 [info ] [MainThread]: 
[0m01:37:11.074932 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:37:11.076520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40863812, "process_in_blocks": "0", "process_kernel_time": 0.137776, "process_mem_max_rss": "131809280", "process_out_blocks": "0", "process_user_time": 0.704834}
[0m01:37:11.076798 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:11.076713 after 0.41 seconds
[0m01:37:11.077183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae587e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee1db0>]}
[0m01:37:11.077343 [debug] [MainThread]: Flushing usage events
[0m01:37:11.348683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:28.794780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3ed0>]}


============================== 01:38:28.797061 | 4f4cc8d6-84c6-4a74-b237-82c3bad67993 ==============================
[0m01:38:28.797061 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:38:28.797324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stores', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:38:28.865260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107921ba0>]}
[0m01:38:28.884396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108871ae0>]}
[0m01:38:28.884948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:38:28.924458 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:38:28.976647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:38:28.976823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:38:28.988789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d8650>]}
[0m01:38:29.016349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:38:29.021658 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:38:29.032176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887f5c0>]}
[0m01:38:29.032381 [info ] [MainThread]: Found 5 models, 5 sources, 571 macros
[0m01:38:29.032519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a829fd0>]}
[0m01:38:29.033082 [info ] [MainThread]: 
[0m01:38:29.033215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:38:29.033314 [info ] [MainThread]: 
[0m01:38:29.033508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:38:29.033836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:38:29.057043 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:38:29.057261 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:38:29.057379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:29.075389 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m01:38:29.076008 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:38:29.077807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:38:29.079927 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:38:29.080065 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:38:29.080168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:29.085096 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:38:29.085209 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:38:29.085308 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:38:29.091370 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m01:38:29.091821 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:38:29.092060 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:38:29.093710 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.093833 [debug] [MainThread]: On master: BEGIN
[0m01:38:29.093925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:29.099698 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m01:38:29.099813 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.099955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:38:29.112067 [debug] [MainThread]: SQL status: SELECT 4 in 0.012 seconds
[0m01:38:29.112890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa12c30>]}
[0m01:38:29.113082 [debug] [MainThread]: On master: ROLLBACK
[0m01:38:29.113300 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.113401 [debug] [MainThread]: On master: BEGIN
[0m01:38:29.113660 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:38:29.113761 [debug] [MainThread]: On master: COMMIT
[0m01:38:29.113848 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.113933 [debug] [MainThread]: On master: COMMIT
[0m01:38:29.114083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:38:29.114177 [debug] [MainThread]: On master: Close
[0m01:38:29.114687 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m01:38:29.114890 [info ] [Thread-1 (]: 1 of 1 START sql view model dw.stg_stores ...................................... [RUN]
[0m01:38:29.115066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_stores)
[0m01:38:29.115187 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m01:38:29.117916 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m01:38:29.118466 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m01:38:29.131536 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m01:38:29.131953 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:38:29.132066 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m01:38:29.132166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:29.136052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:38:29.136262 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:38:29.136385 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m01:38:29.141445 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m01:38:29.143859 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:38:29.144003 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m01:38:29.144575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:38:29.149783 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:38:29.149939 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:38:29.150044 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:38:29.150763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:38:29.153170 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."stg_stores__dbt_backup"
[0m01:38:29.154903 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:38:29.155031 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw"."stg_stores__dbt_backup" cascade
[0m01:38:29.155351 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:38:29.156252 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m01:38:29.157134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4cc8d6-84c6-4a74-b237-82c3bad67993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac40290>]}
[0m01:38:29.157366 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dw.stg_stores ................................. [[32mCREATE VIEW[0m in 0.04s]
[0m01:38:29.157595 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m01:38:29.158108 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.158246 [debug] [MainThread]: On master: BEGIN
[0m01:38:29.158351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:38:29.161283 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:38:29.161405 [debug] [MainThread]: On master: COMMIT
[0m01:38:29.161503 [debug] [MainThread]: Using postgres connection "master"
[0m01:38:29.161593 [debug] [MainThread]: On master: COMMIT
[0m01:38:29.161752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:38:29.161834 [debug] [MainThread]: On master: Close
[0m01:38:29.161952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:29.162034 [debug] [MainThread]: Connection 'model.retail_warehouse.stg_stores' was properly closed.
[0m01:38:29.162127 [info ] [MainThread]: 
[0m01:38:29.162239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:38:29.162628 [debug] [MainThread]: Command end result
[0m01:38:29.172478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:38:29.173239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:38:29.175644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:38:29.175793 [info ] [MainThread]: 
[0m01:38:29.175947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:38:29.176060 [info ] [MainThread]: 
[0m01:38:29.176302 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:38:29.178037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41075617, "process_in_blocks": "0", "process_kernel_time": 0.137293, "process_mem_max_rss": "129236992", "process_out_blocks": "0", "process_user_time": 0.697344}
[0m01:38:29.178263 [debug] [MainThread]: Command `dbt run` succeeded at 01:38:29.178231 after 0.41 seconds
[0m01:38:29.178411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa7d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab09ef0>]}
[0m01:38:29.178545 [debug] [MainThread]: Flushing usage events
[0m01:38:29.381629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:44.795651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2bed0>]}


============================== 00:16:44.800225 | 106ede75-1c6e-47c2-bc34-4df38610e8dc ==============================
[0m00:16:44.800225 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:44.800647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select core.dimensions.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:44.911597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '106ede75-1c6e-47c2-bc34-4df38610e8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104289ba0>]}
[0m00:16:44.941024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '106ede75-1c6e-47c2-bc34-4df38610e8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd9ae0>]}
[0m00:16:44.941770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:16:45.002812 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:45.094275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:45.094593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:45.119208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '106ede75-1c6e-47c2-bc34-4df38610e8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de2050>]}
[0m00:16:45.171259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:16:45.179780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:16:45.194756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '106ede75-1c6e-47c2-bc34-4df38610e8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de75c0>]}
[0m00:16:45.195049 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:16:45.195257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '106ede75-1c6e-47c2-bc34-4df38610e8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5e0b0>]}
[0m00:16:45.195666 [warn ] [MainThread]: The selection criterion 'core.dimensions.*' does not match any enabled nodes
[0m00:16:45.196367 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:16:45.197395 [debug] [MainThread]: Command end result
[0m00:16:45.214458 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:16:45.215517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:16:45.217593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:16:45.220117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47022095, "process_in_blocks": "0", "process_kernel_time": 0.190663, "process_mem_max_rss": "120176640", "process_out_blocks": "0", "process_user_time": 1.034803}
[0m00:16:45.220413 [debug] [MainThread]: Command `dbt run` succeeded at 00:16:45.220361 after 0.47 seconds
[0m00:16:45.220641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d160d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c01c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bfab10>]}
[0m00:16:45.220838 [debug] [MainThread]: Flushing usage events
[0m00:16:45.431944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:13.325347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c3ed0>]}


============================== 00:18:13.328535 | cf374442-8f8a-42e5-a9ad-509f023775ec ==============================
[0m00:18:13.328535 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:13.328923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/marts/core/dimensions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:18:13.429086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118121ba0>]}
[0m00:18:13.458609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119871ae0>]}
[0m00:18:13.459328 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:18:13.519146 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:13.609500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:13.609766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:13.634169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11987e050>]}
[0m00:18:13.685098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:18:13.692432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:18:13.707200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198835c0>]}
[0m00:18:13.707513 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:18:13.707728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b14a0b0>]}
[0m00:18:13.709233 [info ] [MainThread]: 
[0m00:18:13.709460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:13.709615 [info ] [MainThread]: 
[0m00:18:13.709917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:18:13.712172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:18:13.752625 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:18:13.752922 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:18:13.753108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:13.789362 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m00:18:13.790298 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:18:13.791582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m00:18:13.794975 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:18:13.795179 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m00:18:13.795338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:13.800259 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:18:13.800426 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:18:13.800585 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m00:18:13.808138 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m00:18:13.808889 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m00:18:13.809202 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m00:18:13.811977 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.812137 [debug] [MainThread]: On master: BEGIN
[0m00:18:13.812272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:13.817801 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m00:18:13.817952 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.818153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:13.846967 [debug] [MainThread]: SQL status: SELECT 5 in 0.029 seconds
[0m00:18:13.847745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3bd300>]}
[0m00:18:13.848056 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:13.848480 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.848656 [debug] [MainThread]: On master: BEGIN
[0m00:18:13.849174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:18:13.849325 [debug] [MainThread]: On master: COMMIT
[0m00:18:13.849467 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.849603 [debug] [MainThread]: On master: COMMIT
[0m00:18:13.849893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:13.850038 [debug] [MainThread]: On master: Close
[0m00:18:13.851204 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:18:13.851478 [info ] [Thread-1 (]: 1 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m00:18:13.851734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.dim_customers)
[0m00:18:13.851918 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:18:13.855985 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:18:13.856771 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:18:13.878508 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:18:13.879512 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:18:13.879768 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:18:13.879963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:13.883771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:18:13.884008 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:18:13.884203 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw"."stg_customers"
  );
  
[0m00:18:13.885813 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_sk_seq" does not exist
LINE 15:      nextval('customer_sk_seq') as customer_sk
                      ^

[0m00:18:13.886002 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:18:13.886358 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:18:13.892167 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:18:13.893376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b548710>]}
[0m00:18:13.893767 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dw.dim_customers ......................... [[31mERROR[0m in 0.04s]
[0m00:18:13.894089 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:18:13.894305 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:18:13.894586 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:18:13.894845 [info ] [Thread-1 (]: 2 of 4 START sql table model dw.dim_products ................................... [RUN]
[0m00:18:13.895504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:18:13.895713 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:18:13.897260 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:18:13.897703 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:18:13.899837 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:18:13.900589 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:18:13.900802 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:18:13.900976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:13.906030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:18:13.906316 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:18:13.906515 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw"."stg_products"
  );
  
[0m00:18:13.907364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "product_sk_seq" does not exist
LINE 15:      nextval('product_sk_seq') as product_sk,
                      ^

[0m00:18:13.907566 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:18:13.907928 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:18:13.910133 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:18:13.910475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b12a780>]}
[0m00:18:13.910920 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model dw.dim_products .......................... [[31mERROR[0m in 0.01s]
[0m00:18:13.911252 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:18:13.911468 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:18:13.911724 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:18:13.911972 [info ] [Thread-1 (]: 3 of 4 START sql table model dw.dim_promotions ................................. [RUN]
[0m00:18:13.912326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:18:13.912515 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:18:13.914299 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:18:13.914934 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:18:13.917268 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:18:13.917837 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:18:13.918140 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:18:13.918472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:13.923432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:18:13.923674 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:18:13.923887 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw"."stg_promotions"
  );
  
[0m00:18:13.925073 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "promotion_sk_seq" does not exist
LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                      ^

[0m00:18:13.925271 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:18:13.925807 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:18:13.928165 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:18:13.928458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b575590>]}
[0m00:18:13.928818 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model dw.dim_promotions ........................ [[31mERROR[0m in 0.02s]
[0m00:18:13.929120 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:18:13.929321 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:18:13.929586 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:18:13.929893 [info ] [Thread-1 (]: 4 of 4 START sql table model dw.dim_stores ..................................... [RUN]
[0m00:18:13.930293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:18:13.930514 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:18:13.932208 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:18:13.932741 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:18:13.934908 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:18:13.935508 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:18:13.935703 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:18:13.935876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:13.941038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:18:13.941248 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:18:13.941431 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw"."stg_stores"
  );
  
[0m00:18:13.942414 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_sk_seq" does not exist
LINE 15:      nextval('store_sk_seq') as store_sk,
                      ^

[0m00:18:13.942600 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:18:13.942923 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:18:13.945127 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:18:13.945395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf374442-8f8a-42e5-a9ad-509f023775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5b6550>]}
[0m00:18:13.945740 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dw.dim_stores ............................ [[31mERROR[0m in 0.02s]
[0m00:18:13.946040 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:18:13.946282 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:18:13.947040 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.947232 [debug] [MainThread]: On master: BEGIN
[0m00:18:13.947381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:13.961417 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m00:18:13.961742 [debug] [MainThread]: On master: COMMIT
[0m00:18:13.961930 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:13.962088 [debug] [MainThread]: On master: COMMIT
[0m00:18:13.962377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:13.962536 [debug] [MainThread]: On master: Close
[0m00:18:13.962775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:13.962933 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:18:13.963124 [info ] [MainThread]: 
[0m00:18:13.963298 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:18:13.963858 [debug] [MainThread]: Command end result
[0m00:18:14.016285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:18:14.017496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:18:14.021280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:18:14.021514 [info ] [MainThread]: 
[0m00:18:14.021722 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:18:14.021886 [info ] [MainThread]: 
[0m00:18:14.022085 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:18:14.022241 [info ] [MainThread]: 
[0m00:18:14.022421 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:18:14.022567 [info ] [MainThread]: 
[0m00:18:14.022741 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:18:14.022884 [info ] [MainThread]: 
[0m00:18:14.023047 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:18:14.023197 [info ] [MainThread]: 
[0m00:18:14.023361 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:18:14.026095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7395922, "process_in_blocks": "0", "process_kernel_time": 0.221941, "process_mem_max_rss": "129613824", "process_out_blocks": "0", "process_user_time": 1.177535}
[0m00:18:14.026427 [debug] [MainThread]: Command `dbt run` failed at 00:18:14.026370 after 0.74 seconds
[0m00:18:14.026651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd5f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198ff070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd5250>]}
[0m00:18:14.026858 [debug] [MainThread]: Flushing usage events
[0m00:18:14.220378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:38.395537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec3ed0>]}


============================== 00:19:38.398708 | 8522740e-99c1-48ab-9aa3-213ba35424b1 ==============================
[0m00:19:38.398708 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:19:38.399074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/marts/core/dimensions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:38.501829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108825ba0>]}
[0m00:19:38.532083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f71ae0>]}
[0m00:19:38.532797 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:19:38.592549 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:19:38.685080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:38.685356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:38.711495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7e050>]}
[0m00:19:38.767110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:19:38.776673 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:19:38.789741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f835c0>]}
[0m00:19:38.790058 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:19:38.790264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2460b0>]}
[0m00:19:38.791865 [info ] [MainThread]: 
[0m00:19:38.792090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:38.792247 [info ] [MainThread]: 
[0m00:19:38.792556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:19:38.795162 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:19:38.830578 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:19:38.830837 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:19:38.831006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:38.852346 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.021 seconds
[0m00:19:38.853252 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:19:38.854344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m00:19:38.858133 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:19:38.858349 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m00:19:38.858503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:38.866119 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m00:19:38.866585 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m00:19:38.866848 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m00:19:38.871983 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:19:38.872843 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m00:19:38.873198 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m00:19:38.876366 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:38.876565 [debug] [MainThread]: On master: BEGIN
[0m00:19:38.876712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:38.881981 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:19:38.882271 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:38.882513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:19:38.902786 [debug] [MainThread]: SQL status: SELECT 5 in 0.020 seconds
[0m00:19:38.903686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c1300>]}
[0m00:19:38.903987 [debug] [MainThread]: On master: ROLLBACK
[0m00:19:38.904437 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:38.904598 [debug] [MainThread]: On master: BEGIN
[0m00:19:38.904977 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:19:38.905133 [debug] [MainThread]: On master: COMMIT
[0m00:19:38.905275 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:38.905413 [debug] [MainThread]: On master: COMMIT
[0m00:19:38.905637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:19:38.905791 [debug] [MainThread]: On master: Close
[0m00:19:38.907122 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:19:38.907490 [info ] [Thread-1 (]: 1 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m00:19:38.907776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.dim_customers)
[0m00:19:38.907976 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:19:38.912415 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:19:38.912930 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:19:38.935108 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:19:38.935715 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:19:38.935913 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:19:38.936088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:38.940050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:19:38.940336 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:19:38.940541 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw"."stg_customers"
  );
  
[0m00:19:38.941631 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_sk_seq" does not exist
LINE 15:      nextval('customer_sk_seq') as customer_sk
                      ^

[0m00:19:38.941903 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:19:38.942294 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:19:38.948566 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:19:38.949942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b648710>]}
[0m00:19:38.950372 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dw.dim_customers ......................... [[31mERROR[0m in 0.04s]
[0m00:19:38.950720 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:19:38.950948 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:19:38.951463 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:19:38.951191 [info ] [Thread-1 (]: 2 of 4 START sql table model dw.dim_products ................................... [RUN]
[0m00:19:38.952296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:19:38.952522 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:19:38.954305 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:19:38.954800 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:19:38.956999 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:19:38.957476 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:19:38.957665 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:19:38.957835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:38.962700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:19:38.962927 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:19:38.963115 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw"."stg_products"
  );
  
[0m00:19:38.964235 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "product_sk_seq" does not exist
LINE 15:      nextval('product_sk_seq') as product_sk,
                      ^

[0m00:19:38.964553 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:19:38.964927 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:19:38.967428 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:19:38.967793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22a780>]}
[0m00:19:38.968192 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model dw.dim_products .......................... [[31mERROR[0m in 0.02s]
[0m00:19:38.968506 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:19:38.968722 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:19:38.969065 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:19:38.969404 [info ] [Thread-1 (]: 3 of 4 START sql table model dw.dim_promotions ................................. [RUN]
[0m00:19:38.969802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:19:38.970023 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:19:38.971687 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:19:38.972128 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:19:38.974356 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:19:38.974915 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:19:38.975175 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:19:38.975425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:38.979966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:19:38.980231 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:19:38.980420 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw"."stg_promotions"
  );
  
[0m00:19:38.981326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "promotion_sk_seq" does not exist
LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                      ^

[0m00:19:38.981635 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:19:38.982028 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:19:38.984351 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:19:38.984638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b679590>]}
[0m00:19:38.984991 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model dw.dim_promotions ........................ [[31mERROR[0m in 0.01s]
[0m00:19:38.985285 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:19:38.985482 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:19:38.985853 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:19:38.986218 [info ] [Thread-1 (]: 4 of 4 START sql table model dw.dim_stores ..................................... [RUN]
[0m00:19:38.986613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:19:38.986822 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:19:38.988588 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:19:38.989166 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:19:38.991672 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:19:38.992208 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:19:38.992395 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:19:38.992563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:38.996545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:19:38.996881 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:19:38.997158 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw"."stg_stores"
  );
  
[0m00:19:38.998159 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_sk_seq" does not exist
LINE 15:      nextval('store_sk_seq') as store_sk,
                      ^

[0m00:19:38.998395 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:19:38.998797 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:19:39.001385 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:19:39.001686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8522740e-99c1-48ab-9aa3-213ba35424b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ba550>]}
[0m00:19:39.002060 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dw.dim_stores ............................ [[31mERROR[0m in 0.02s]
[0m00:19:39.002365 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:19:39.002786 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:19:39.004002 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:39.004225 [debug] [MainThread]: On master: BEGIN
[0m00:19:39.004390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:39.007822 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:19:39.008033 [debug] [MainThread]: On master: COMMIT
[0m00:19:39.008184 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:39.008327 [debug] [MainThread]: On master: COMMIT
[0m00:19:39.008860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:19:39.009089 [debug] [MainThread]: On master: Close
[0m00:19:39.009346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:39.009505 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:19:39.009715 [info ] [MainThread]: 
[0m00:19:39.009909 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:19:39.010484 [debug] [MainThread]: Command end result
[0m00:19:39.064021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:19:39.065210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:19:39.068849 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:19:39.069062 [info ] [MainThread]: 
[0m00:19:39.069277 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:19:39.069443 [info ] [MainThread]: 
[0m00:19:39.069648 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:19:39.069809 [info ] [MainThread]: 
[0m00:19:39.069983 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:19:39.070132 [info ] [MainThread]: 
[0m00:19:39.070336 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:19:39.070591 [info ] [MainThread]: 
[0m00:19:39.070802 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:19:39.070974 [info ] [MainThread]: 
[0m00:19:39.071152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:19:39.073489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7175094, "process_in_blocks": "0", "process_kernel_time": 0.213763, "process_mem_max_rss": "130580480", "process_out_blocks": "0", "process_user_time": 1.186498}
[0m00:19:39.073781 [debug] [MainThread]: Command `dbt run` failed at 00:19:39.073724 after 0.72 seconds
[0m00:19:39.074000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc9f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fff070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107619c10>]}
[0m00:19:39.074202 [debug] [MainThread]: Flushing usage events
[0m00:19:39.275138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:15.544393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997ed0>]}


============================== 00:38:15.547901 | 9170a519-c40e-4181-bb8d-797f2a4940a9 ==============================
[0m00:38:15.547901 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:38:15.548302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/marts/core/dimensions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:15.650038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5ba0>]}
[0m00:38:15.680521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a45ae0>]}
[0m00:38:15.681260 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:38:15.737810 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:38:15.813562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:15.813850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:15.817023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m00:38:15.840407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52050>]}
[0m00:38:15.892946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:38:15.900381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:38:15.914320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a575c0>]}
[0m00:38:15.914613 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:38:15.914815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d20b0>]}
[0m00:38:15.916258 [info ] [MainThread]: 
[0m00:38:15.916472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:15.916624 [info ] [MainThread]: 
[0m00:38:15.916897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:38:15.919084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:38:15.954296 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:38:15.954562 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:38:15.954739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:15.977154 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.022 seconds
[0m00:38:15.978005 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:38:15.978428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now create_RetailSales_dw_dw)
[0m00:38:15.978894 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw_dw"
"
[0m00:38:15.981987 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m00:38:15.982218 [debug] [ThreadPool]: On create_RetailSales_dw_dw: BEGIN
[0m00:38:15.982378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:15.987706 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:38:15.988123 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m00:38:15.988478 [debug] [ThreadPool]: On create_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw_dw"} */
create schema if not exists "dw_dw"
[0m00:38:15.990530 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m00:38:15.991224 [debug] [ThreadPool]: On create_RetailSales_dw_dw: COMMIT
[0m00:38:15.991414 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m00:38:15.991564 [debug] [ThreadPool]: On create_RetailSales_dw_dw: COMMIT
[0m00:38:15.993417 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m00:38:15.993568 [debug] [ThreadPool]: On create_RetailSales_dw_dw: Close
[0m00:38:15.994502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m00:38:15.997952 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:38:15.998144 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:38:15.998290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:16.003170 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:38:16.003330 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:38:16.003510 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:38:16.008178 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m00:38:16.008809 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:38:16.009129 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:38:16.009386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now list_RetailSales_dw_dw)
[0m00:38:16.010352 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:38:16.010518 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:38:16.010653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:38:16.015922 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:38:16.016085 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:38:16.016243 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:38:16.020099 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m00:38:16.020701 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:38:16.020990 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:38:16.023368 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.023541 [debug] [MainThread]: On master: BEGIN
[0m00:38:16.023679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:16.027414 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:38:16.027604 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.027811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:16.046570 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m00:38:16.047305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b498b0>]}
[0m00:38:16.047578 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:16.047872 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.048027 [debug] [MainThread]: On master: BEGIN
[0m00:38:16.048361 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:38:16.048509 [debug] [MainThread]: On master: COMMIT
[0m00:38:16.048653 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.048786 [debug] [MainThread]: On master: COMMIT
[0m00:38:16.048996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:38:16.049140 [debug] [MainThread]: On master: Close
[0m00:38:16.050070 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:38:16.050498 [info ] [Thread-1 (]: 1 of 4 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:38:16.050909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now model.retail_warehouse.dim_customers)
[0m00:38:16.051111 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:38:16.055879 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:38:16.056571 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:38:16.078036 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:38:16.078763 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:38:16.078991 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:38:16.079175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:16.083404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:38:16.083664 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:38:16.083872 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:38:16.084678 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_customers" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
              ^

[0m00:38:16.084870 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:38:16.085200 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:38:16.091069 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:38:16.092371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1ca10>]}
[0m00:38:16.092781 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dw_dw.dim_customers ...................... [[31mERROR[0m in 0.04s]
[0m00:38:16.093114 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:38:16.093330 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:38:16.093607 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:38:16.093876 [info ] [Thread-1 (]: 2 of 4 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:38:16.094616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:38:16.094816 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:38:16.096491 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:38:16.096916 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:38:16.099159 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:38:16.099584 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:38:16.099770 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:38:16.099948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:16.104721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:38:16.104981 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:38:16.105178 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:38:16.105739 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_products" does not exist
LINE 25: from "RetailSales"."dw_oltp"."stg_products"
              ^

[0m00:38:16.105932 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:38:16.106261 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:38:16.108661 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:38:16.108984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789e780>]}
[0m00:38:16.109345 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model dw_dw.dim_products ....................... [[31mERROR[0m in 0.01s]
[0m00:38:16.109642 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:38:16.109850 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:38:16.110095 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:38:16.110350 [info ] [Thread-1 (]: 3 of 4 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:38:16.110738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:38:16.110974 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:38:16.112708 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:38:16.113180 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:38:16.115280 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:38:16.115615 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:38:16.115787 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:38:16.115942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:16.120483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:38:16.120677 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:38:16.120854 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:38:16.121400 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_promotions" does not exist
LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
              ^

[0m00:38:16.121577 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:38:16.121909 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:38:16.124047 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:38:16.124315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d84410>]}
[0m00:38:16.124720 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model dw_dw.dim_promotions ..................... [[31mERROR[0m in 0.01s]
[0m00:38:16.125294 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:38:16.125546 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:38:16.125815 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:38:16.126122 [info ] [Thread-1 (]: 4 of 4 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:38:16.126483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:38:16.126685 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:38:16.128280 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:38:16.128671 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:38:16.132710 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:38:16.133205 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:38:16.133397 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:38:16.133783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:16.137860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:38:16.138103 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:38:16.138293 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:38:16.138943 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_stores" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
              ^

[0m00:38:16.139125 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:38:16.139444 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:38:16.141951 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:38:16.142318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9170a519-c40e-4181-bb8d-797f2a4940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105129ed0>]}
[0m00:38:16.142707 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dw_dw.dim_stores ......................... [[31mERROR[0m in 0.02s]
[0m00:38:16.143018 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:38:16.143338 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:38:16.144112 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.144286 [debug] [MainThread]: On master: BEGIN
[0m00:38:16.144426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:16.150610 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m00:38:16.150922 [debug] [MainThread]: On master: COMMIT
[0m00:38:16.151294 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:16.151480 [debug] [MainThread]: On master: COMMIT
[0m00:38:16.151839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:38:16.152027 [debug] [MainThread]: On master: Close
[0m00:38:16.152247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:16.152392 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:38:16.152580 [info ] [MainThread]: 
[0m00:38:16.152762 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:38:16.153366 [debug] [MainThread]: Command end result
[0m00:38:16.204934 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:38:16.206058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:38:16.209790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:38:16.210008 [info ] [MainThread]: 
[0m00:38:16.210220 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:38:16.210388 [info ] [MainThread]: 
[0m00:38:16.210588 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:38:16.210751 [info ] [MainThread]: 
[0m00:38:16.210928 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:38:16.211086 [info ] [MainThread]: 
[0m00:38:16.211261 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:38:16.211411 [info ] [MainThread]: 
[0m00:38:16.211582 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:38:16.211726 [info ] [MainThread]: 
[0m00:38:16.211891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:38:16.213863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.71415114, "process_in_blocks": "0", "process_kernel_time": 0.205023, "process_mem_max_rss": "129531904", "process_out_blocks": "0", "process_user_time": 1.19357}
[0m00:38:16.214111 [debug] [MainThread]: Command `dbt run` failed at 00:38:16.214062 after 0.71 seconds
[0m00:38:16.214325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024ddf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdeed0>]}
[0m00:38:16.214524 [debug] [MainThread]: Flushing usage events
[0m00:38:16.412347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:32.527194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c3ed0>]}


============================== 00:40:32.530514 | 97ebe46f-47f4-445e-95db-d1f20807e282 ==============================
[0m00:40:32.530514 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:40:32.530871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/marts/core/dimensions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:40:32.633891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107321ba0>]}
[0m00:40:32.663027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110171ae0>]}
[0m00:40:32.663791 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:40:32.720511 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:40:32.808379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:32.808642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:32.811682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m00:40:32.834550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017e050>]}
[0m00:40:32.885819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:40:32.893381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:40:32.909856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101835c0>]}
[0m00:40:32.910255 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:40:32.910475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122460b0>]}
[0m00:40:32.912092 [info ] [MainThread]: 
[0m00:40:32.912313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:40:32.912469 [info ] [MainThread]: 
[0m00:40:32.912755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:40:32.915074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:40:32.949608 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:40:32.949909 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:40:32.950093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:32.972769 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m00:40:32.973669 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:40:32.974864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw_dw)
[0m00:40:32.978207 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:40:32.978449 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:40:32.978608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:32.982605 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:40:32.982781 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:40:32.982945 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:40:32.986585 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m00:40:32.987398 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:40:32.987726 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:40:32.988015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m00:40:32.989053 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:40:32.989218 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:40:32.989357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:32.992877 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:40:32.993033 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:40:32.993189 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:40:32.997562 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m00:40:32.998166 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:40:32.998458 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:40:33.001382 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.001612 [debug] [MainThread]: On master: BEGIN
[0m00:40:33.001761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:33.005837 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:40:33.006023 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.006235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:40:33.022240 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m00:40:33.022892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c53d0>]}
[0m00:40:33.023139 [debug] [MainThread]: On master: ROLLBACK
[0m00:40:33.023417 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.023561 [debug] [MainThread]: On master: BEGIN
[0m00:40:33.023905 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:40:33.024057 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.024195 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.024327 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.024622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:40:33.024770 [debug] [MainThread]: On master: Close
[0m00:40:33.025529 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:40:33.025799 [info ] [Thread-1 (]: 1 of 4 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:40:33.026040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now model.retail_warehouse.dim_customers)
[0m00:40:33.026219 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:40:33.030471 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:40:33.031071 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:40:33.053455 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:40:33.054312 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:40:33.054558 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:40:33.054752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.059917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:40:33.060124 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:40:33.060315 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:40:33.060766 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_customers" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
              ^

[0m00:40:33.060952 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:40:33.061256 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:40:33.066938 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:40:33.068109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125947d0>]}
[0m00:40:33.068557 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dw_dw.dim_customers ...................... [[31mERROR[0m in 0.04s]
[0m00:40:33.068913 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:40:33.069137 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:40:33.069401 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:40:33.069671 [info ] [Thread-1 (]: 2 of 4 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:40:33.070333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:40:33.070564 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:40:33.072421 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:40:33.072807 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:40:33.074632 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:40:33.075014 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:40:33.075197 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:40:33.075364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.078789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:40:33.079021 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:40:33.079212 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:40:33.079778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_products" does not exist
LINE 25: from "RetailSales"."dw_oltp"."stg_products"
              ^

[0m00:40:33.080007 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:40:33.080353 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:40:33.082522 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:40:33.082789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112236570>]}
[0m00:40:33.083132 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model dw_dw.dim_products ....................... [[31mERROR[0m in 0.01s]
[0m00:40:33.083431 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:40:33.083628 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:40:33.083883 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:40:33.084127 [info ] [Thread-1 (]: 3 of 4 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:40:33.084413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:40:33.084593 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:40:33.086462 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:40:33.086851 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:40:33.088502 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:40:33.088911 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:40:33.089083 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:40:33.089249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.094465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:40:33.094701 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:40:33.094887 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:40:33.095561 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_promotions" does not exist
LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
              ^

[0m00:40:33.095840 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:40:33.096184 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:40:33.098345 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:40:33.098598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112673bb0>]}
[0m00:40:33.098927 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model dw_dw.dim_promotions ..................... [[31mERROR[0m in 0.01s]
[0m00:40:33.099216 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:40:33.099406 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:40:33.099628 [info ] [Thread-1 (]: 4 of 4 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:40:33.099933 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:40:33.100179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:40:33.100421 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:40:33.102376 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:40:33.102792 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:40:33.104463 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:40:33.104835 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:40:33.105158 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:40:33.105369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:33.109256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:40:33.109545 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:40:33.109737 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:40:33.110344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_stores" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
              ^

[0m00:40:33.110593 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:40:33.111032 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:40:33.113248 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:40:33.113525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ebe46f-47f4-445e-95db-d1f20807e282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f2e50>]}
[0m00:40:33.113876 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dw_dw.dim_stores ......................... [[31mERROR[0m in 0.01s]
[0m00:40:33.114183 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:40:33.114423 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:40:33.115243 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.115409 [debug] [MainThread]: On master: BEGIN
[0m00:40:33.115551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:33.120339 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:40:33.120648 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.120816 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:33.120957 [debug] [MainThread]: On master: COMMIT
[0m00:40:33.121259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:40:33.121482 [debug] [MainThread]: On master: Close
[0m00:40:33.121741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:33.121897 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:40:33.122098 [info ] [MainThread]: 
[0m00:40:33.122280 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m00:40:33.122843 [debug] [MainThread]: Command end result
[0m00:40:33.178832 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:40:33.180032 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:40:33.183726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:40:33.184002 [info ] [MainThread]: 
[0m00:40:33.184232 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:40:33.184491 [info ] [MainThread]: 
[0m00:40:33.184710 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:40:33.184871 [info ] [MainThread]: 
[0m00:40:33.185050 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:40:33.185199 [info ] [MainThread]: 
[0m00:40:33.185373 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:40:33.185515 [info ] [MainThread]: 
[0m00:40:33.185682 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:40:33.185828 [info ] [MainThread]: 
[0m00:40:33.185996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:40:33.188031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.70051, "process_in_blocks": "0", "process_kernel_time": 0.204939, "process_mem_max_rss": "128335872", "process_out_blocks": "0", "process_user_time": 1.173382}
[0m00:40:33.188358 [debug] [MainThread]: Command `dbt run` failed at 00:40:33.188301 after 0.70 seconds
[0m00:40:33.188596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102755f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101fdf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2f110>]}
[0m00:40:33.188805 [debug] [MainThread]: Flushing usage events
[0m00:40:33.412898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:52.568815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511fed0>]}


============================== 00:41:52.572069 | d334b4e5-a109-48a6-97e2-42f4dd786b16 ==============================
[0m00:41:52.572069 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:41:52.572432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/marts/core/dimensions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:41:52.674071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104681ba0>]}
[0m00:41:52.703474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cdae0>]}
[0m00:41:52.704220 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:52.761177 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:41:52.833785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:52.834052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:52.837040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m00:41:52.859546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051da050>]}
[0m00:41:52.911522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:41:52.922135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:41:52.938712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051df5c0>]}
[0m00:41:52.939059 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:41:52.939268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4a0b0>]}
[0m00:41:52.940762 [info ] [MainThread]: 
[0m00:41:52.940976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:52.941124 [info ] [MainThread]: 
[0m00:41:52.941769 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:52.944488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:41:52.982538 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:41:52.982830 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:41:52.983014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:53.002388 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m00:41:53.003276 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:41:53.004333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw_oltp)
[0m00:41:53.007812 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:41:53.008074 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:41:53.008242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:53.011977 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:41:53.012218 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:41:53.012386 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:41:53.014968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m00:41:53.015600 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:41:53.015885 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:41:53.016170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now list_RetailSales_dw_dw)
[0m00:41:53.017292 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:41:53.017521 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:41:53.017681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:53.021480 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:41:53.021678 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:41:53.021855 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:41:53.025276 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m00:41:53.025919 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:41:53.026213 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:41:53.029167 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.029348 [debug] [MainThread]: On master: BEGIN
[0m00:41:53.029485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:53.033094 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:41:53.033248 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.033459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:53.051194 [debug] [MainThread]: SQL status: SELECT 5 in 0.018 seconds
[0m00:41:53.051933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec53d0>]}
[0m00:41:53.052189 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:53.052483 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.052629 [debug] [MainThread]: On master: BEGIN
[0m00:41:53.052974 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:41:53.053123 [debug] [MainThread]: On master: COMMIT
[0m00:41:53.053260 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.053391 [debug] [MainThread]: On master: COMMIT
[0m00:41:53.053636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:41:53.053775 [debug] [MainThread]: On master: Close
[0m00:41:53.054537 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:41:53.054845 [info ] [Thread-1 (]: 1 of 4 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:41:53.055112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now model.retail_warehouse.dim_customers)
[0m00:41:53.055298 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:41:53.059558 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:41:53.060191 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:41:53.081753 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:41:53.082578 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:41:53.082904 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:41:53.083117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.087346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:41:53.087600 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:41:53.087787 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:41:53.088288 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_customers" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
              ^

[0m00:41:53.088463 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:41:53.088794 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:41:53.094965 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:41:53.096268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f887d0>]}
[0m00:41:53.096664 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dw_dw.dim_customers ...................... [[31mERROR[0m in 0.04s]
[0m00:41:53.096990 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:41:53.097201 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:41:53.097491 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:41:53.097776 [info ] [Thread-1 (]: 2 of 4 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:41:53.098465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:41:53.098664 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:41:53.100556 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:41:53.100924 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:41:53.102602 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:41:53.102931 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:41:53.103196 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:41:53.103432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.106698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:41:53.106923 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:41:53.107105 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:41:53.107654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_products" does not exist
LINE 25: from "RetailSales"."dw_oltp"."stg_products"
              ^

[0m00:41:53.107932 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:41:53.108325 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:41:53.110612 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:41:53.110933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2e570>]}
[0m00:41:53.111293 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model dw_dw.dim_products ....................... [[31mERROR[0m in 0.01s]
[0m00:41:53.111599 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:41:53.111800 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:41:53.112118 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:41:53.112455 [info ] [Thread-1 (]: 3 of 4 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:41:53.112810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:41:53.113017 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:41:53.114943 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:41:53.115342 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:41:53.117031 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:41:53.117391 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:41:53.117565 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:41:53.117721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.121321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:41:53.121556 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:41:53.121732 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:41:53.122328 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_promotions" does not exist
LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
              ^

[0m00:41:53.122622 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:41:53.122987 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:41:53.125444 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:41:53.125679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806bbb0>]}
[0m00:41:53.125980 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model dw_dw.dim_promotions ..................... [[31mERROR[0m in 0.01s]
[0m00:41:53.126256 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:41:53.126441 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:41:53.126773 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:41:53.127127 [info ] [Thread-1 (]: 4 of 4 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:41:53.127480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:41:53.127685 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:41:53.129593 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:41:53.130004 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:41:53.131651 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:41:53.132000 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:41:53.132170 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:41:53.132373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.136924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:41:53.137192 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:41:53.137394 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:41:53.137886 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw_oltp.stg_stores" does not exist
LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
              ^

[0m00:41:53.138150 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:41:53.138504 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:41:53.140658 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:41:53.140936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd334b4e5-a109-48a6-97e2-42f4dd786b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eee50>]}
[0m00:41:53.141298 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dw_dw.dim_stores ......................... [[31mERROR[0m in 0.01s]
[0m00:41:53.141597 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:41:53.141864 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:41:53.142780 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.142954 [debug] [MainThread]: On master: BEGIN
[0m00:41:53.143101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:53.148605 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:41:53.148777 [debug] [MainThread]: On master: COMMIT
[0m00:41:53.148919 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:53.149053 [debug] [MainThread]: On master: COMMIT
[0m00:41:53.149325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:41:53.149484 [debug] [MainThread]: On master: Close
[0m00:41:53.149684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:53.149823 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:41:53.150014 [info ] [MainThread]: 
[0m00:41:53.150237 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m00:41:53.150854 [debug] [MainThread]: Command end result
[0m00:41:53.204349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:41:53.205463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:41:53.209398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:41:53.209599 [info ] [MainThread]: 
[0m00:41:53.209814 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:41:53.209983 [info ] [MainThread]: 
[0m00:41:53.210182 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw_oltp.stg_customers" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_customers"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:41:53.210337 [info ] [MainThread]: 
[0m00:41:53.210516 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw_oltp.stg_products" does not exist
  LINE 25: from "RetailSales"."dw_oltp"."stg_products"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:41:53.210660 [info ] [MainThread]: 
[0m00:41:53.210835 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw_oltp.stg_promotions" does not exist
  LINE 22: from "RetailSales"."dw_oltp"."stg_promotions"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:41:53.210976 [info ] [MainThread]: 
[0m00:41:53.211142 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw_oltp.stg_stores" does not exist
  LINE 23: from "RetailSales"."dw_oltp"."stg_stores"
                ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:41:53.211287 [info ] [MainThread]: 
[0m00:41:53.211442 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:41:53.213368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.684405, "process_in_blocks": "0", "process_kernel_time": 0.192079, "process_mem_max_rss": "131661824", "process_out_blocks": "0", "process_user_time": 1.174253}
[0m00:41:53.213655 [debug] [MainThread]: Command `dbt run` failed at 00:41:53.213599 after 0.68 seconds
[0m00:41:53.213879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c45f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105259f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045edf10>]}
[0m00:41:53.214085 [debug] [MainThread]: Flushing usage events
[0m00:41:53.423524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:30.862901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104489e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e3ed0>]}


============================== 00:44:30.866338 | 828096e1-fd89-4c46-8ec7-c7361296b489 ==============================
[0m00:44:30.866338 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:44:30.866724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:44:30.973369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104741ba0>]}
[0m00:44:31.004358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105291ae0>]}
[0m00:44:31.005171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:44:31.061855 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:44:31.153340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:31.153629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:31.156776 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.core.facts
- models.retail_warehouse.marts.intermediate
[0m00:44:31.180592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529a050>]}
[0m00:44:31.235134 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:44:31.243122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:44:31.257513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529f5c0>]}
[0m00:44:31.257842 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:44:31.258048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ca0b0>]}
[0m00:44:31.259498 [info ] [MainThread]: 
[0m00:44:31.259708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:44:31.259859 [info ] [MainThread]: 
[0m00:44:31.260154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:31.262571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:44:31.297992 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:44:31.298270 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:44:31.298441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:31.321913 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m00:44:31.322827 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:44:31.324290 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:44:31.324577 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:44:31.324797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:31.329515 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m00:44:31.330227 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:44:31.330607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now create_RetailSales_dw_oltp)
[0m00:44:31.330857 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw_oltp"
"
[0m00:44:31.335073 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m00:44:31.335373 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: BEGIN
[0m00:44:31.335538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:31.340535 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.340812 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m00:44:31.340985 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw_oltp"} */
create schema if not exists "dw_oltp"
[0m00:44:31.342472 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:44:31.343448 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m00:44:31.343630 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m00:44:31.343786 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m00:44:31.345296 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:44:31.345452 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: Close
[0m00:44:31.346348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw_oltp, now list_RetailSales_dw_dw)
[0m00:44:31.349518 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:44:31.349705 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:44:31.349854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:31.355777 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m00:44:31.355939 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:44:31.356096 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:44:31.361165 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m00:44:31.361783 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:44:31.362098 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:44:31.362361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m00:44:31.363365 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:44:31.363545 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:44:31.363690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:31.367223 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:44:31.367384 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:44:31.367546 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:44:31.371464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m00:44:31.372026 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:44:31.372355 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:44:31.375333 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.375540 [debug] [MainThread]: On master: BEGIN
[0m00:44:31.375705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:31.384039 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:44:31.384209 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.384412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:44:31.402269 [debug] [MainThread]: SQL status: SELECT 5 in 0.018 seconds
[0m00:44:31.403057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106341570>]}
[0m00:44:31.403331 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:31.403681 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.403834 [debug] [MainThread]: On master: BEGIN
[0m00:44:31.404183 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:44:31.404336 [debug] [MainThread]: On master: COMMIT
[0m00:44:31.404476 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.404613 [debug] [MainThread]: On master: COMMIT
[0m00:44:31.404827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:31.404971 [debug] [MainThread]: On master: Close
[0m00:44:31.405772 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m00:44:31.406049 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m00:44:31.406297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now model.retail_warehouse.stg_customers)
[0m00:44:31.406482 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m00:44:31.410922 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m00:44:31.411968 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m00:44:31.432445 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m00:44:31.433333 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:44:31.433577 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m00:44:31.433766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.438309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.438532 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:44:31.438725 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m00:44:31.442682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:44:31.447294 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:44:31.447562 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:44:31.448429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:31.456580 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:44:31.456799 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:44:31.456976 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:44:31.457898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:44:31.461095 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m00:44:31.463679 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:44:31.463879 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m00:44:31.464336 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:44:31.465654 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m00:44:31.466883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106444050>]}
[0m00:44:31.467231 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:44:31.467638 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m00:44:31.467925 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m00:44:31.468223 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m00:44:31.468526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m00:44:31.468725 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m00:44:31.470546 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m00:44:31.471111 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m00:44:31.472817 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m00:44:31.473168 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:44:31.473342 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m00:44:31.473511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.478029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:44:31.478286 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:44:31.478489 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m00:44:31.483731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:44:31.487831 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:44:31.488085 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:44:31.488853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:31.489644 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:44:31.489847 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:44:31.490020 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:44:31.490498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:44:31.491640 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m00:44:31.492034 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:44:31.492221 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m00:44:31.492619 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:44:31.493326 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m00:44:31.493649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106096570>]}
[0m00:44:31.493999 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m00:44:31.494305 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m00:44:31.494520 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m00:44:31.494856 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m00:44:31.495208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m00:44:31.495425 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m00:44:31.533833 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m00:44:31.534890 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m00:44:31.536801 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m00:44:31.537214 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:44:31.537403 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m00:44:31.537574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.541701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:44:31.541942 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:44:31.542149 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m00:44:31.545743 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:44:31.547585 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:44:31.547784 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m00:44:31.548348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:44:31.549072 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:44:31.549260 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:44:31.549427 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:44:31.549952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:44:31.551025 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m00:44:31.551396 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:44:31.551579 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m00:44:31.551965 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:44:31.552676 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m00:44:31.552966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105743250>]}
[0m00:44:31.553298 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m00:44:31.553614 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m00:44:31.553824 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m00:44:31.554163 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m00:44:31.554463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m00:44:31.554731 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m00:44:31.556613 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m00:44:31.557253 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m00:44:31.558912 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m00:44:31.559438 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:44:31.559826 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m00:44:31.560116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.564258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:44:31.564450 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:44:31.564628 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m00:44:31.569111 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:44:31.570928 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:44:31.571124 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m00:44:31.571733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:44:31.572471 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:44:31.572662 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:44:31.572828 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:44:31.573652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:44:31.574785 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m00:44:31.575160 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:44:31.575342 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m00:44:31.575719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:44:31.576769 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m00:44:31.577147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057446d0>]}
[0m00:44:31.577512 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.02s]
[0m00:44:31.577817 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m00:44:31.578028 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m00:44:31.578350 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m00:44:31.578673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m00:44:31.578877 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m00:44:31.580895 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m00:44:31.581705 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m00:44:31.583960 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m00:44:31.584609 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:44:31.584823 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m00:44:31.584998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.589768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.590053 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:44:31.590269 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m00:44:31.595533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:44:31.597217 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:44:31.597422 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:44:31.598141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:31.599133 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:44:31.599324 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:44:31.599492 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:44:31.600065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:44:31.601325 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m00:44:31.601724 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:44:31.601920 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m00:44:31.602311 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:44:31.603012 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m00:44:31.603311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065394e0>]}
[0m00:44:31.603647 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.02s]
[0m00:44:31.603956 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m00:44:31.604163 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:44:31.604483 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:44:31.604832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m00:44:31.605089 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:44:31.606798 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:44:31.607473 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:44:31.621264 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:44:31.622105 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:44:31.622328 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:44:31.622512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.627372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.627666 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:44:31.627869 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:44:31.628982 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_sk_seq" does not exist
LINE 15:      nextval('customer_sk_seq') as customer_sk
                      ^

[0m00:44:31.629178 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:44:31.629516 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:44:31.635337 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:44:31.635623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106586e70>]}
[0m00:44:31.635992 [error] [Thread-1 (]: 6 of 9 ERROR creating sql table model dw_dw.dim_customers ...................... [[31mERROR[0m in 0.03s]
[0m00:44:31.636306 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:44:31.636512 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:44:31.636777 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:44:31.637031 [info ] [Thread-1 (]: 7 of 9 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:44:31.637739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:44:31.637983 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:44:31.639987 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:44:31.640481 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:44:31.642240 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:44:31.642927 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:44:31.643224 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:44:31.643403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.648255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.648451 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:44:31.648629 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:44:31.650007 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "product_sk_seq" does not exist
LINE 15:      nextval('product_sk_seq') as product_sk,
                      ^

[0m00:44:31.650214 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:44:31.650582 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:44:31.652693 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:44:31.652954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b13d0>]}
[0m00:44:31.653396 [error] [Thread-1 (]: 7 of 9 ERROR creating sql table model dw_dw.dim_products ....................... [[31mERROR[0m in 0.02s]
[0m00:44:31.653800 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:44:31.654051 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:44:31.654300 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:44:31.654546 [info ] [Thread-1 (]: 8 of 9 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:44:31.654848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:44:31.655033 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:44:31.656979 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:44:31.657453 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:44:31.659349 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:44:31.659960 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:44:31.660188 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:44:31.660364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.665022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.665244 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:44:31.665424 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:44:31.666440 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "promotion_sk_seq" does not exist
LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                      ^

[0m00:44:31.666656 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:44:31.667018 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:44:31.669252 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:44:31.669535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b1970>]}
[0m00:44:31.669892 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model dw_dw.dim_promotions ..................... [[31mERROR[0m in 0.01s]
[0m00:44:31.670521 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:44:31.670770 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:44:31.671028 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:44:31.671293 [info ] [Thread-1 (]: 9 of 9 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:44:31.671628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:44:31.671860 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:44:31.673931 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:44:31.674443 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:44:31.676621 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:44:31.677121 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:44:31.677319 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:44:31.677489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:31.681369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:44:31.681556 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:44:31.681734 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:44:31.682945 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_sk_seq" does not exist
LINE 15:      nextval('store_sk_seq') as store_sk,
                      ^

[0m00:44:31.683134 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:44:31.683446 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:44:31.685652 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:44:31.685927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828096e1-fd89-4c46-8ec7-c7361296b489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b1a30>]}
[0m00:44:31.686281 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model dw_dw.dim_stores ......................... [[31mERROR[0m in 0.01s]
[0m00:44:31.686719 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:44:31.687106 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:44:31.687885 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.688072 [debug] [MainThread]: On master: BEGIN
[0m00:44:31.688220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:44:31.693474 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:44:31.693707 [debug] [MainThread]: On master: COMMIT
[0m00:44:31.693864 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:31.694019 [debug] [MainThread]: On master: COMMIT
[0m00:44:31.694332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:31.694483 [debug] [MainThread]: On master: Close
[0m00:44:31.694699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:31.694842 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:44:31.695043 [info ] [MainThread]: 
[0m00:44:31.695238 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m00:44:31.696112 [debug] [MainThread]: Command end result
[0m00:44:31.716325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:44:31.717560 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:44:31.721334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:44:31.721558 [info ] [MainThread]: 
[0m00:44:31.721773 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:44:31.721945 [info ] [MainThread]: 
[0m00:44:31.722150 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "customer_sk_seq" does not exist
  LINE 15:      nextval('customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:44:31.722317 [info ] [MainThread]: 
[0m00:44:31.722493 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "product_sk_seq" does not exist
  LINE 15:      nextval('product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:44:31.722645 [info ] [MainThread]: 
[0m00:44:31.722824 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "promotion_sk_seq" does not exist
  LINE 15:      nextval('promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:44:31.722970 [info ] [MainThread]: 
[0m00:44:31.723143 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "store_sk_seq" does not exist
  LINE 15:      nextval('store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:44:31.723290 [info ] [MainThread]: 
[0m00:44:31.723463 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=4 SKIP=0 TOTAL=9
[0m00:44:31.725560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9045169, "process_in_blocks": "0", "process_kernel_time": 0.217267, "process_mem_max_rss": "129236992", "process_out_blocks": "0", "process_user_time": 1.299003}
[0m00:44:31.725974 [debug] [MainThread]: Command `dbt run` failed at 00:44:31.725901 after 0.90 seconds
[0m00:44:31.726225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106586e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065908f0>]}
[0m00:44:31.726446 [debug] [MainThread]: Flushing usage events
[0m00:44:31.962009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:31.730637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc3ed0>]}


============================== 00:47:31.733908 | a7817e47-177d-4b0b-827e-962ac8be8b18 ==============================
[0m00:47:31.733908 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:47:31.734302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:47:31.836119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107121ba0>]}
[0m00:47:31.865190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108871ae0>]}
[0m00:47:31.865938 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:47:31.924064 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:47:32.008335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:32.008648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:32.012021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m00:47:32.035147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887e050>]}
[0m00:47:32.087493 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:47:32.095317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:47:32.109196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088875c0>]}
[0m00:47:32.109487 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:47:32.109698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097520b0>]}
[0m00:47:32.110949 [info ] [MainThread]: 
[0m00:47:32.111152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:47:32.111299 [info ] [MainThread]: 
[0m00:47:32.111571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:47:32.113921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:47:32.148786 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:47:32.149079 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:47:32.149266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:32.172024 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.023 seconds
[0m00:47:32.172907 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:47:32.174194 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:47:32.174420 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:47:32.174576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:32.180079 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m00:47:32.181135 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:47:32.182293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw_oltp)
[0m00:47:32.185652 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:47:32.185833 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:47:32.185974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:32.190698 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:47:32.190866 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:47:32.191021 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:47:32.197001 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:47:32.198085 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:47:32.198411 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:47:32.198677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now list_RetailSales_dw_dw)
[0m00:47:32.200037 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:47:32.200210 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:47:32.200351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:32.204036 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.204228 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:47:32.204409 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:47:32.208416 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m00:47:32.209043 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:47:32.209382 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:47:32.211981 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.212177 [debug] [MainThread]: On master: BEGIN
[0m00:47:32.212320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:32.216343 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.216502 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.216700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:47:32.239223 [debug] [MainThread]: SQL status: SELECT 10 in 0.022 seconds
[0m00:47:32.239975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c8e20>]}
[0m00:47:32.240260 [debug] [MainThread]: On master: ROLLBACK
[0m00:47:32.240542 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.240697 [debug] [MainThread]: On master: BEGIN
[0m00:47:32.241065 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:47:32.241210 [debug] [MainThread]: On master: COMMIT
[0m00:47:32.241347 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.241478 [debug] [MainThread]: On master: COMMIT
[0m00:47:32.241720 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:47:32.241868 [debug] [MainThread]: On master: Close
[0m00:47:32.242733 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m00:47:32.243023 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m00:47:32.243262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now model.retail_warehouse.stg_customers)
[0m00:47:32.243438 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m00:47:32.248165 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m00:47:32.249745 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m00:47:32.269571 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m00:47:32.270108 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.270299 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m00:47:32.270471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.274643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.274894 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.275098 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m00:47:32.278813 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:47:32.282473 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.282705 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:47:32.283615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:32.285439 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.285635 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:47:32.286172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:47:32.294909 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:47:32.295114 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.295284 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:47:32.296305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:47:32.299331 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m00:47:32.302064 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:47:32.302266 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m00:47:32.306330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m00:47:32.307633 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m00:47:32.308781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4cb90>]}
[0m00:47:32.309135 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:47:32.309444 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m00:47:32.309649 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m00:47:32.309934 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m00:47:32.310205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m00:47:32.310381 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m00:47:32.312129 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m00:47:32.312722 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m00:47:32.314463 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m00:47:32.314802 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.314976 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m00:47:32.315143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.319377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.319650 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.319877 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m00:47:32.323805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:47:32.327621 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.327836 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products" rename to "stg_products__dbt_backup"
[0m00:47:32.328846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:32.330249 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.330441 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:47:32.330900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:47:32.331693 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:47:32.331880 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.332047 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:47:32.333183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:47:32.365748 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m00:47:32.366195 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:47:32.366393 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m00:47:32.368818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:47:32.369557 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m00:47:32.369870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097268e0>]}
[0m00:47:32.370218 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:47:32.370537 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m00:47:32.370752 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m00:47:32.371056 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m00:47:32.371405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m00:47:32.371631 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m00:47:32.373230 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m00:47:32.374052 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m00:47:32.376048 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m00:47:32.376627 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.376810 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m00:47:32.376973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.381375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.381608 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.381799 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m00:47:32.386567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:47:32.388251 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.388440 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m00:47:32.389125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:32.390765 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.390952 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m00:47:32.391495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:47:32.392292 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:47:32.392486 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.392661 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:47:32.393464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:47:32.394590 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m00:47:32.394956 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:47:32.395137 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m00:47:32.396551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:47:32.397270 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m00:47:32.397647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c24690>]}
[0m00:47:32.398000 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m00:47:32.398323 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m00:47:32.398522 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m00:47:32.398844 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m00:47:32.399207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m00:47:32.399464 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m00:47:32.401173 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m00:47:32.401846 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m00:47:32.404071 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m00:47:32.404613 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.404827 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m00:47:32.404999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.410263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:47:32.410497 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.410690 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m00:47:32.416782 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:47:32.418527 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.418722 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales" rename to "stg_sales__dbt_backup"
[0m00:47:32.419486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:32.421171 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.421367 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m00:47:32.421756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:47:32.422624 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:47:32.422823 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.422999 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:47:32.423637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:47:32.424758 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m00:47:32.425115 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:47:32.425288 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m00:47:32.426858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:47:32.427567 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m00:47:32.427889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3a6d0>]}
[0m00:47:32.428237 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m00:47:32.428546 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m00:47:32.428754 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m00:47:32.429038 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m00:47:32.429289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m00:47:32.429476 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m00:47:32.431669 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m00:47:32.432526 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m00:47:32.434474 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m00:47:32.434920 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.435090 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m00:47:32.435259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.439595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.439776 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.439952 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m00:47:32.443385 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:47:32.445186 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.445376 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores" rename to "stg_stores__dbt_backup"
[0m00:47:32.446276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:32.447704 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.447922 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:47:32.448306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:47:32.449166 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:47:32.449386 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.449565 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:47:32.450104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:47:32.451449 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m00:47:32.451814 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:47:32.451990 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m00:47:32.453688 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:47:32.454346 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m00:47:32.454625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a99710>]}
[0m00:47:32.454944 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m00:47:32.455240 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m00:47:32.455440 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:47:32.455671 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:47:32.455972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m00:47:32.456252 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:47:32.457845 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:47:32.458441 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:47:32.471437 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:47:32.472141 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:47:32.472329 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:47:32.472532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.477531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:47:32.477763 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:47:32.477950 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.customer_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:47:32.478990 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw.customer_sk_seq" does not exist
LINE 15:      nextval('dw.customer_sk_seq') as customer_sk
                      ^

[0m00:47:32.479190 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: ROLLBACK
[0m00:47:32.479547 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:47:32.485530 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw.customer_sk_seq" does not exist
  LINE 15:      nextval('dw.customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:47:32.485854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c18b30>]}
[0m00:47:32.486210 [error] [Thread-1 (]: 6 of 9 ERROR creating sql table model dw_dw.dim_customers ...................... [[31mERROR[0m in 0.03s]
[0m00:47:32.486521 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:47:32.486723 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:47:32.486999 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw.customer_sk_seq" does not exist
  LINE 15:      nextval('dw.customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql.
[0m00:47:32.487259 [info ] [Thread-1 (]: 7 of 9 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:47:32.487918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:47:32.488115 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:47:32.489746 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:47:32.490177 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:47:32.492260 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:47:32.492663 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:47:32.492872 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:47:32.493046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.497644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:47:32.497832 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:47:32.498011 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.product_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:47:32.499177 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw.product_sk_seq" does not exist
LINE 15:      nextval('dw.product_sk_seq') as product_sk,
                      ^

[0m00:47:32.499371 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: ROLLBACK
[0m00:47:32.499699 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:47:32.502011 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw.product_sk_seq" does not exist
  LINE 15:      nextval('dw.product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:47:32.502364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c28b90>]}
[0m00:47:32.502737 [error] [Thread-1 (]: 7 of 9 ERROR creating sql table model dw_dw.dim_products ....................... [[31mERROR[0m in 0.01s]
[0m00:47:32.503041 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:47:32.503238 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:47:32.503508 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw.product_sk_seq" does not exist
  LINE 15:      nextval('dw.product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql.
[0m00:47:32.503790 [info ] [Thread-1 (]: 8 of 9 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:47:32.504108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:47:32.504299 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:47:32.505947 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:47:32.506404 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:47:32.508388 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:47:32.508729 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:47:32.508911 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:47:32.509139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.512924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.513235 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:47:32.513445 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.promotion_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:47:32.514937 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw.promotion_sk_seq" does not exist
LINE 15:      nextval('dw.promotion_sk_seq') as promotion_sk,
                      ^

[0m00:47:32.515148 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: ROLLBACK
[0m00:47:32.515471 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:47:32.518047 [debug] [Thread-1 (]: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw.promotion_sk_seq" does not exist
  LINE 15:      nextval('dw.promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:47:32.518434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3cb30>]}
[0m00:47:32.518821 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model dw_dw.dim_promotions ..................... [[31mERROR[0m in 0.01s]
[0m00:47:32.519132 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:47:32.519336 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:47:32.519632 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_promotions' to be skipped because of status 'error'.  Reason: Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw.promotion_sk_seq" does not exist
  LINE 15:      nextval('dw.promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql.
[0m00:47:32.519962 [info ] [Thread-1 (]: 9 of 9 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:47:32.520332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:47:32.520524 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:47:32.522168 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:47:32.522609 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:47:32.524797 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:47:32.525212 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:47:32.525405 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:47:32.525567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:32.529338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:47:32.529563 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:47:32.529751 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.store_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:47:32.530839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dw.store_sk_seq" does not exist
LINE 15:      nextval('dw.store_sk_seq') as store_sk,
                      ^

[0m00:47:32.531142 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: ROLLBACK
[0m00:47:32.531504 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:47:32.533698 [debug] [Thread-1 (]: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw.store_sk_seq" does not exist
  LINE 15:      nextval('dw.store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:47:32.534011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7817e47-177d-4b0b-827e-962ac8be8b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c45b50>]}
[0m00:47:32.534476 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model dw_dw.dim_stores ......................... [[31mERROR[0m in 0.01s]
[0m00:47:32.534810 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:47:32.535061 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw.store_sk_seq" does not exist
  LINE 15:      nextval('dw.store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql.
[0m00:47:32.535791 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.535964 [debug] [MainThread]: On master: BEGIN
[0m00:47:32.536109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:32.541586 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:47:32.541773 [debug] [MainThread]: On master: COMMIT
[0m00:47:32.541928 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:32.542068 [debug] [MainThread]: On master: COMMIT
[0m00:47:32.542374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:47:32.542522 [debug] [MainThread]: On master: Close
[0m00:47:32.542727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:32.542874 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:47:32.543079 [info ] [MainThread]: 
[0m00:47:32.543255 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m00:47:32.544104 [debug] [MainThread]: Command end result
[0m00:47:32.564441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:47:32.565856 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:47:32.569437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:47:32.569637 [info ] [MainThread]: 
[0m00:47:32.569843 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:47:32.570007 [info ] [MainThread]: 
[0m00:47:32.570201 [error] [MainThread]:   Database Error in model dim_customers (models/marts/core/dimensions/customers/dim_customers.sql)
  relation "dw.customer_sk_seq" does not exist
  LINE 15:      nextval('dw.customer_sk_seq') as customer_sk
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/customers/dim_customers.sql
[0m00:47:32.570361 [info ] [MainThread]: 
[0m00:47:32.570532 [error] [MainThread]:   Database Error in model dim_products (models/marts/core/dimensions/products/dim_products.sql)
  relation "dw.product_sk_seq" does not exist
  LINE 15:      nextval('dw.product_sk_seq') as product_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/products/dim_products.sql
[0m00:47:32.570683 [info ] [MainThread]: 
[0m00:47:32.570858 [error] [MainThread]:   Database Error in model dim_promotions (models/marts/core/dimensions/promotions/dim_promotions.sql)
  relation "dw.promotion_sk_seq" does not exist
  LINE 15:      nextval('dw.promotion_sk_seq') as promotion_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/promotions/dim_promotions.sql
[0m00:47:32.571006 [info ] [MainThread]: 
[0m00:47:32.571179 [error] [MainThread]:   Database Error in model dim_stores (models/marts/core/dimensions/stores/dim_stores.sql)
  relation "dw.store_sk_seq" does not exist
  LINE 15:      nextval('dw.store_sk_seq') as store_sk,
                        ^
  compiled code at target/run/retail_warehouse/models/marts/core/dimensions/stores/dim_stores.sql
[0m00:47:32.571322 [info ] [MainThread]: 
[0m00:47:32.571493 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=4 SKIP=0 TOTAL=9
[0m00:47:32.573476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88277584, "process_in_blocks": "0", "process_kernel_time": 0.216875, "process_mem_max_rss": "130334720", "process_out_blocks": "0", "process_user_time": 1.284107}
[0m00:47:32.573718 [debug] [MainThread]: Command `dbt run` failed at 00:47:32.573670 after 0.88 seconds
[0m00:47:32.573918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3c2f0>]}
[0m00:47:32.574106 [debug] [MainThread]: Flushing usage events
[0m00:47:32.812708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:08.445913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120959e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ac3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ac3ed0>]}


============================== 00:51:08.449451 | 0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9 ==============================
[0m00:51:08.449451 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:51:08.449861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:08.553742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d25ba0>]}
[0m00:51:08.583497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c71ae0>]}
[0m00:51:08.584210 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:51:08.641803 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:51:08.715158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:51:08.715427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:51:08.718516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.core.facts
- models.retail_warehouse.marts.intermediate
[0m00:51:08.742106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c7e050>]}
[0m00:51:08.794513 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:51:08.802102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:51:08.816969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c835c0>]}
[0m00:51:08.817262 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:51:08.817463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235520b0>]}
[0m00:51:08.818779 [info ] [MainThread]: 
[0m00:51:08.818995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:08.819145 [info ] [MainThread]: 
[0m00:51:08.819421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:51:08.821790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:51:08.856193 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:51:08.856509 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:51:08.856737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:08.877207 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m00:51:08.878068 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:51:08.879859 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:51:08.880316 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:51:08.880632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:08.886822 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m00:51:08.887570 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:51:08.888509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw_dw)
[0m00:51:08.891835 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:51:08.892039 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:51:08.892194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:08.897654 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:51:08.897824 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:51:08.897989 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:51:08.904215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:51:08.904809 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:51:08.905115 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:51:08.905370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m00:51:08.906735 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:51:08.906927 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:51:08.907070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:08.910929 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:51:08.911088 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:51:08.911246 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:51:08.915468 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m00:51:08.916138 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:51:08.916446 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:51:08.919213 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:08.919378 [debug] [MainThread]: On master: BEGIN
[0m00:51:08.919516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:51:08.923708 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:51:08.923858 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:08.924056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:51:08.944978 [debug] [MainThread]: SQL status: SELECT 10 in 0.021 seconds
[0m00:51:08.945854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237cce20>]}
[0m00:51:08.946108 [debug] [MainThread]: On master: ROLLBACK
[0m00:51:08.946407 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:08.946553 [debug] [MainThread]: On master: BEGIN
[0m00:51:08.946919 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:51:08.947064 [debug] [MainThread]: On master: COMMIT
[0m00:51:08.947201 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:08.947335 [debug] [MainThread]: On master: COMMIT
[0m00:51:08.947592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:51:08.947736 [debug] [MainThread]: On master: Close
[0m00:51:08.948487 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m00:51:08.948813 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m00:51:08.949068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now model.retail_warehouse.stg_customers)
[0m00:51:08.949264 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m00:51:08.953902 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m00:51:08.955413 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m00:51:08.975876 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m00:51:08.976479 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:08.976682 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m00:51:08.976881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:08.980944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:08.981175 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:08.981356 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m00:51:08.987127 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:51:08.990661 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:08.990868 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:51:08.991765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:08.993460 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:08.993644 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:51:08.994202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.002644 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:51:09.002849 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:09.003020 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:51:09.004051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.007077 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m00:51:09.009915 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:51:09.010149 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m00:51:09.011826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:51:09.013131 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m00:51:09.014273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123948ad0>]}
[0m00:51:09.014680 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:51:09.015034 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m00:51:09.015248 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m00:51:09.015555 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m00:51:09.015860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m00:51:09.016056 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m00:51:09.017764 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m00:51:09.018303 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m00:51:09.019982 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m00:51:09.020307 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.020475 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m00:51:09.020634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.025146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:09.025444 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.025666 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m00:51:09.031355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:51:09.035816 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.036062 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products" rename to "stg_products__dbt_backup"
[0m00:51:09.036925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.038430 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.038643 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:51:09.039288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.040191 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:51:09.040401 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.040571 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:51:09.041506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.072895 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m00:51:09.073514 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:51:09.073734 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m00:51:09.076329 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:51:09.077107 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m00:51:09.077422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12352e8e0>]}
[0m00:51:09.077769 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:51:09.078091 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m00:51:09.078295 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m00:51:09.078603 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m00:51:09.078909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m00:51:09.079116 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m00:51:09.080712 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m00:51:09.081544 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m00:51:09.083498 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m00:51:09.084006 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.084218 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m00:51:09.084399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.088169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:09.088386 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.088572 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m00:51:09.092925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:51:09.094682 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.094895 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m00:51:09.095575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.097326 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.097530 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m00:51:09.098091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.098911 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:51:09.099104 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.099271 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:51:09.099873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:51:09.100975 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m00:51:09.101326 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:51:09.101497 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m00:51:09.103107 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:51:09.103740 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m00:51:09.104046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222240f0>]}
[0m00:51:09.104380 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m00:51:09.104683 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m00:51:09.104884 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m00:51:09.105172 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m00:51:09.105469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m00:51:09.105668 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m00:51:09.107311 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m00:51:09.108028 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m00:51:09.110112 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m00:51:09.110659 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.110838 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m00:51:09.110998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.115267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:09.115447 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.115618 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m00:51:09.120383 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:51:09.121978 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.122165 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales" rename to "stg_sales__dbt_backup"
[0m00:51:09.122896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.124633 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.124830 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m00:51:09.125395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.126139 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:51:09.126320 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.126480 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:51:09.127251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.128323 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m00:51:09.128681 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:51:09.128852 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m00:51:09.130254 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:51:09.130908 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m00:51:09.131229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12223ae50>]}
[0m00:51:09.131633 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m00:51:09.132017 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m00:51:09.132254 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m00:51:09.132527 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m00:51:09.132760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m00:51:09.132934 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m00:51:09.134840 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m00:51:09.135579 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m00:51:09.137325 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m00:51:09.137701 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.137869 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m00:51:09.138028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.144317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:51:09.144521 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.144697 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m00:51:09.148566 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:51:09.150344 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.150527 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores" rename to "stg_stores__dbt_backup"
[0m00:51:09.151210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.152547 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.152720 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:51:09.153378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.154117 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:51:09.154293 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.154460 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:51:09.155318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.156650 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m00:51:09.157056 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:51:09.157240 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m00:51:09.159073 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:51:09.159772 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m00:51:09.160069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12379b620>]}
[0m00:51:09.160403 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m00:51:09.160695 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m00:51:09.161028 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:51:09.161442 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:51:09.161825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m00:51:09.162047 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:51:09.163758 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:51:09.164392 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:51:09.177432 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:51:09.178192 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:51:09.178402 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:51:09.178588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.182402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:09.182605 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:51:09.182790 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:51:09.191351 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.008 seconds
[0m00:51:09.194996 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:51:09.195205 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw_dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m00:51:09.195867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:51:09.196623 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m00:51:09.196800 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:51:09.196963 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m00:51:09.197711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.199155 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_customers__dbt_backup"
[0m00:51:09.200728 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:51:09.200913 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw_dw"."dim_customers__dbt_backup" cascade
[0m00:51:09.201281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m00:51:09.201938 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:51:09.202236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c10770>]}
[0m00:51:09.202564 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw_dw.dim_customers .......................... [[32mSELECT 100[0m in 0.04s]
[0m00:51:09.202868 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:51:09.203066 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:51:09.203355 [info ] [Thread-1 (]: 7 of 9 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:51:09.203638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:51:09.203838 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:51:09.205318 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:51:09.205747 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:51:09.207697 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:51:09.208030 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:51:09.208206 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:51:09.208364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.211821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:51:09.212018 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:51:09.212193 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:51:09.219809 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.007 seconds
[0m00:51:09.221535 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:51:09.221719 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw_dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m00:51:09.222611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.223324 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m00:51:09.223499 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:51:09.223654 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m00:51:09.224413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.225722 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_products__dbt_backup"
[0m00:51:09.226089 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:51:09.226264 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw_dw"."dim_products__dbt_backup" cascade
[0m00:51:09.226627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m00:51:09.227242 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:51:09.227533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c74410>]}
[0m00:51:09.227858 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw_dw.dim_products ........................... [[32mSELECT 50[0m in 0.02s]
[0m00:51:09.228138 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:51:09.228341 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:51:09.228640 [info ] [Thread-1 (]: 8 of 9 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:51:09.228944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:51:09.229146 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:51:09.230750 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:51:09.231212 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:51:09.235338 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:51:09.235743 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:51:09.235924 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:51:09.236090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.240493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:51:09.240721 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:51:09.240915 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:51:09.246013 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m00:51:09.247723 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:51:09.247914 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m00:51:09.248760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.249453 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m00:51:09.249630 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:51:09.249791 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m00:51:09.250640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.251710 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_promotions__dbt_backup"
[0m00:51:09.252068 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:51:09.252240 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw_dw"."dim_promotions__dbt_backup" cascade
[0m00:51:09.252613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m00:51:09.253246 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:51:09.253534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cf65d0>]}
[0m00:51:09.253852 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw_dw.dim_promotions ......................... [[32mSELECT 15[0m in 0.02s]
[0m00:51:09.254157 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:51:09.254357 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:51:09.254636 [info ] [Thread-1 (]: 9 of 9 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:51:09.254905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:51:09.255087 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:51:09.256976 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:51:09.257360 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:51:09.259021 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:51:09.259341 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:51:09.259513 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:51:09.259679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.264925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:51:09.265274 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:51:09.265504 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:51:09.269081 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m00:51:09.271172 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:51:09.271376 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw_dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m00:51:09.272149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:09.272900 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m00:51:09.273086 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:51:09.273246 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m00:51:09.274163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:51:09.275277 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_stores__dbt_backup"
[0m00:51:09.275636 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:51:09.275807 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw_dw"."dim_stores__dbt_backup" cascade
[0m00:51:09.276236 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m00:51:09.276889 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:51:09.277201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6d3a88-8a5b-4ef1-bca0-3b86f200f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120893170>]}
[0m00:51:09.277545 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw_dw.dim_stores ............................. [[32mSELECT 10[0m in 0.02s]
[0m00:51:09.278008 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:51:09.278897 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:09.279076 [debug] [MainThread]: On master: BEGIN
[0m00:51:09.279221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:51:09.284157 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:51:09.284440 [debug] [MainThread]: On master: COMMIT
[0m00:51:09.284616 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:09.284763 [debug] [MainThread]: On master: COMMIT
[0m00:51:09.285107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:51:09.285271 [debug] [MainThread]: On master: Close
[0m00:51:09.285488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:09.285627 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:51:09.285827 [info ] [MainThread]: 
[0m00:51:09.286009 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:51:09.286848 [debug] [MainThread]: Command end result
[0m00:51:09.304417 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:51:09.305778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:51:09.309603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:51:09.309807 [info ] [MainThread]: 
[0m00:51:09.310008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:09.310168 [info ] [MainThread]: 
[0m00:51:09.310327 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m00:51:09.312477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.90737987, "process_in_blocks": "0", "process_kernel_time": 0.210688, "process_mem_max_rss": "129368064", "process_out_blocks": "0", "process_user_time": 1.287242}
[0m00:51:09.312783 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:09.312730 after 0.91 seconds
[0m00:51:09.313001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238bba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238bb9b0>]}
[0m00:51:09.313206 [debug] [MainThread]: Flushing usage events
[0m00:51:09.663832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:13.645045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105197c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105197ed0>]}


============================== 00:55:13.648554 | 6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf ==============================
[0m00:55:13.648554 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:55:13.648964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:13.752506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f5ba0>]}
[0m00:55:13.782203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105245ae0>]}
[0m00:55:13.782945 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:55:13.840774 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:55:13.934297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:13.934576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:13.937830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.core.facts
- models.retail_warehouse.marts.intermediate
[0m00:55:13.960975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524e050>]}
[0m00:55:14.014291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:55:14.022094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:55:14.036542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052535c0>]}
[0m00:55:14.036876 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m00:55:14.037086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d20b0>]}
[0m00:55:14.038438 [info ] [MainThread]: 
[0m00:55:14.038652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:14.038808 [info ] [MainThread]: 
[0m00:55:14.039103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:14.041537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m00:55:14.076930 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:55:14.077230 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:55:14.077406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:14.099631 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m00:55:14.100542 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:55:14.101836 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m00:55:14.102079 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m00:55:14.102304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:14.108020 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m00:55:14.108744 [debug] [ThreadPool]: On list_RetailSales: Close
[0m00:55:14.109725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw_dw)
[0m00:55:14.113948 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:55:14.114214 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m00:55:14.114379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:14.121776 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m00:55:14.121984 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m00:55:14.122153 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m00:55:14.128538 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m00:55:14.129259 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m00:55:14.129567 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m00:55:14.129845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m00:55:14.131674 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:55:14.131851 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m00:55:14.131991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:14.137699 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m00:55:14.137861 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m00:55:14.138019 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m00:55:14.141579 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m00:55:14.142258 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m00:55:14.142515 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m00:55:14.145393 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.145562 [debug] [MainThread]: On master: BEGIN
[0m00:55:14.145699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:14.149819 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.149977 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.150170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:55:14.175452 [debug] [MainThread]: SQL status: SELECT 10 in 0.025 seconds
[0m00:55:14.176166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106350e20>]}
[0m00:55:14.176422 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:14.176731 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.176877 [debug] [MainThread]: On master: BEGIN
[0m00:55:14.177249 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:55:14.177398 [debug] [MainThread]: On master: COMMIT
[0m00:55:14.177536 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.177671 [debug] [MainThread]: On master: COMMIT
[0m00:55:14.177917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:14.178060 [debug] [MainThread]: On master: Close
[0m00:55:14.178857 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m00:55:14.179135 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m00:55:14.179373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now model.retail_warehouse.stg_customers)
[0m00:55:14.179554 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m00:55:14.184186 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m00:55:14.185496 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m00:55:14.205920 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m00:55:14.206491 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.206694 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m00:55:14.206868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.211106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.211349 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.211558 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m00:55:14.215051 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:55:14.218530 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.218772 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:55:14.220112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.221873 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.222082 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:55:14.224411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:55:14.233339 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:55:14.233570 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.233757 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m00:55:14.234371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:55:14.237705 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m00:55:14.240352 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m00:55:14.240556 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m00:55:14.242175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:55:14.243542 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m00:55:14.244689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c8ad0>]}
[0m00:55:14.245059 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:55:14.245381 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m00:55:14.245591 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m00:55:14.245875 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m00:55:14.246188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m00:55:14.246394 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m00:55:14.248328 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m00:55:14.249063 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m00:55:14.250832 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m00:55:14.251181 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.251362 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m00:55:14.251568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.255018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:55:14.255333 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.255523 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m00:55:14.259717 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:55:14.263580 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.263821 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products" rename to "stg_products__dbt_backup"
[0m00:55:14.264539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.266013 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.266204 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:55:14.266882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.267717 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:55:14.267903 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.268071 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m00:55:14.268686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:55:14.297942 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m00:55:14.298414 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m00:55:14.298616 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m00:55:14.300631 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:55:14.301364 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m00:55:14.301675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a6ba0>]}
[0m00:55:14.302015 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:55:14.302333 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m00:55:14.302539 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m00:55:14.302876 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m00:55:14.303284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m00:55:14.303498 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m00:55:14.305142 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m00:55:14.305741 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m00:55:14.307721 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m00:55:14.308237 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.308515 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m00:55:14.308715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.312263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.312474 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.312670 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m00:55:14.316606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:55:14.318209 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.318395 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m00:55:14.318986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.320666 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.320853 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m00:55:14.321358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.322146 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:55:14.322323 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.322482 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m00:55:14.323783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.324868 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m00:55:14.325223 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m00:55:14.325395 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m00:55:14.326796 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:55:14.327414 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m00:55:14.327719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571c870>]}
[0m00:55:14.328049 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.02s]
[0m00:55:14.328344 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m00:55:14.328544 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m00:55:14.328769 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m00:55:14.329047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m00:55:14.329228 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m00:55:14.330967 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m00:55:14.331749 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m00:55:14.334126 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m00:55:14.334866 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.335104 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m00:55:14.335293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.341029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:55:14.341221 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.341403 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m00:55:14.344529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:55:14.346345 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.346546 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales" rename to "stg_sales__dbt_backup"
[0m00:55:14.347943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.349697 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.349894 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m00:55:14.350251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.351069 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:55:14.351250 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.351410 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m00:55:14.352182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.353259 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m00:55:14.353612 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m00:55:14.353781 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m00:55:14.355304 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:55:14.355916 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m00:55:14.356200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574c750>]}
[0m00:55:14.356524 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m00:55:14.356818 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m00:55:14.357013 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m00:55:14.357295 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m00:55:14.357571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m00:55:14.357757 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m00:55:14.359600 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m00:55:14.360306 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m00:55:14.362053 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m00:55:14.362503 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.362790 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m00:55:14.363110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.368646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:55:14.368904 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.369090 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m00:55:14.374235 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:55:14.376227 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.376432 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores" rename to "stg_stores__dbt_backup"
[0m00:55:14.377158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.378555 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.378751 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:55:14.379303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.380105 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:55:14.380294 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.380460 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m00:55:14.381379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.382855 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m00:55:14.383259 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m00:55:14.383451 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m00:55:14.384878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:55:14.385593 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m00:55:14.385909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b1400>]}
[0m00:55:14.386246 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m00:55:14.386558 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m00:55:14.386761 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m00:55:14.386985 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m00:55:14.387213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m00:55:14.387475 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m00:55:14.389190 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m00:55:14.390044 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m00:55:14.402634 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m00:55:14.403476 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.403741 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m00:55:14.403922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.408211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.408428 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.408617 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m00:55:14.413997 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.005 seconds
[0m00:55:14.417935 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.418141 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw_dw"."dim_customers" rename to "dim_customers__dbt_backup"
[0m00:55:14.418747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.420437 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.420639 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw_dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m00:55:14.421548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.422353 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m00:55:14.422531 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.422691 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m00:55:14.423507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.424570 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_customers__dbt_backup"
[0m00:55:14.426135 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m00:55:14.426323 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw_dw"."dim_customers__dbt_backup" cascade
[0m00:55:14.429659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:55:14.430312 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m00:55:14.430609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105099eb0>]}
[0m00:55:14.430934 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw_dw.dim_customers .......................... [[32mSELECT 100[0m in 0.04s]
[0m00:55:14.431235 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m00:55:14.431430 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m00:55:14.431721 [info ] [Thread-1 (]: 7 of 9 START sql table model dw_dw.dim_products ................................ [RUN]
[0m00:55:14.432008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m00:55:14.432203 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m00:55:14.434059 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m00:55:14.434479 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m00:55:14.436268 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m00:55:14.436605 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.436785 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m00:55:14.436953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.441246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.441454 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.441639 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m00:55:14.446850 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m00:55:14.448750 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.448941 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw_dw"."dim_products" rename to "dim_products__dbt_backup"
[0m00:55:14.449587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.450981 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.451163 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw_dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m00:55:14.452106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.452857 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m00:55:14.453030 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.453188 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m00:55:14.453953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.455029 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_products__dbt_backup"
[0m00:55:14.455384 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m00:55:14.455558 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw_dw"."dim_products__dbt_backup" cascade
[0m00:55:14.458439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:55:14.459054 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m00:55:14.459340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509bef0>]}
[0m00:55:14.459660 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw_dw.dim_products ........................... [[32mSELECT 50[0m in 0.03s]
[0m00:55:14.459963 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m00:55:14.460156 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m00:55:14.460442 [info ] [Thread-1 (]: 8 of 9 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m00:55:14.460726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m00:55:14.460915 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m00:55:14.464890 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m00:55:14.465394 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m00:55:14.467456 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m00:55:14.468007 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.468211 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m00:55:14.468380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.473455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:55:14.473668 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.473854 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m00:55:14.479086 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m00:55:14.481166 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.481374 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw_dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m00:55:14.481956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:14.483499 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.483740 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m00:55:14.484600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:55:14.485469 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m00:55:14.485658 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.485840 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m00:55:14.486823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:14.488187 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_promotions__dbt_backup"
[0m00:55:14.488557 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m00:55:14.488739 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw_dw"."dim_promotions__dbt_backup" cascade
[0m00:55:14.491157 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:55:14.491816 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m00:55:14.492110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057378f0>]}
[0m00:55:14.492440 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw_dw.dim_promotions ......................... [[32mSELECT 15[0m in 0.03s]
[0m00:55:14.492750 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m00:55:14.492944 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m00:55:14.493210 [info ] [Thread-1 (]: 9 of 9 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m00:55:14.493471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m00:55:14.493655 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m00:55:14.495117 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m00:55:14.495509 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m00:55:14.497580 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m00:55:14.497988 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.498169 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m00:55:14.498338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:14.502806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:55:14.503044 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.503226 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m00:55:14.512842 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.009 seconds
[0m00:55:14.514581 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.514784 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw_dw"."dim_stores" rename to "dim_stores__dbt_backup"
[0m00:55:14.518141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:55:14.519779 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.519978 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw_dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m00:55:14.525190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m00:55:14.525991 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m00:55:14.526167 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.526326 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m00:55:14.526955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:55:14.528441 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_stores__dbt_backup"
[0m00:55:14.528813 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m00:55:14.528994 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw_dw"."dim_stores__dbt_backup" cascade
[0m00:55:14.530789 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:55:14.531695 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m00:55:14.532035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac8ba14-b242-4aa7-b7c9-fbd84f1559cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509bb90>]}
[0m00:55:14.532428 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw_dw.dim_stores ............................. [[32mSELECT 10[0m in 0.04s]
[0m00:55:14.532885 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m00:55:14.533889 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.534051 [debug] [MainThread]: On master: BEGIN
[0m00:55:14.534193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:14.540794 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:55:14.541020 [debug] [MainThread]: On master: COMMIT
[0m00:55:14.541183 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:14.541323 [debug] [MainThread]: On master: COMMIT
[0m00:55:14.541606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:14.541761 [debug] [MainThread]: On master: Close
[0m00:55:14.541980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:14.542130 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m00:55:14.542358 [info ] [MainThread]: 
[0m00:55:14.542542 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m00:55:14.543566 [debug] [MainThread]: Command end result
[0m00:55:14.561305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m00:55:14.562740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m00:55:14.566937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m00:55:14.567192 [info ] [MainThread]: 
[0m00:55:14.567428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:14.567645 [info ] [MainThread]: 
[0m00:55:14.567847 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m00:55:14.570095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.96819025, "process_in_blocks": "0", "process_kernel_time": 0.218817, "process_mem_max_rss": "128958464", "process_out_blocks": "0", "process_user_time": 1.308949}
[0m00:55:14.570358 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:14.570305 after 0.97 seconds
[0m00:55:14.570580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d3d70>]}
[0m00:55:14.570783 [debug] [MainThread]: Flushing usage events
[0m00:55:14.815917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:27.277960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108051e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc3ed0>]}


============================== 01:08:27.281259 | 23a98ae5-fefc-410e-bf92-23b97538f4b6 ==============================
[0m01:08:27.281259 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:08:27.281627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m01:08:27.351044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23a98ae5-fefc-410e-bf92-23b97538f4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108309ba0>]}
[0m01:08:27.405717 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16980267, "process_in_blocks": "0", "process_kernel_time": 0.162099, "process_mem_max_rss": "106790912", "process_out_blocks": "0", "process_user_time": 0.774191}
[0m01:08:27.406046 [debug] [MainThread]: Command `dbt clean` succeeded at 01:08:27.405975 after 0.17 seconds
[0m01:08:27.406266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a28490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a29040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a36550>]}
[0m01:08:27.406477 [debug] [MainThread]: Flushing usage events
[0m01:08:27.612654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:38.359887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106869e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac3ed0>]}


============================== 01:08:38.362518 | 892ea7e0-eeb8-47c1-8a34-f7a9f39ecf3f ==============================
[0m01:08:38.362518 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:08:38.362893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:08:38.399256 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "retail_warehouse", target "dev" invalid: 'schema' is a required property
[0m01:08:38.401047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.077860415, "process_in_blocks": "0", "process_kernel_time": 0.111026, "process_mem_max_rss": "110493696", "process_out_blocks": "0", "process_user_time": 0.733565}
[0m01:08:38.401353 [debug] [MainThread]: Command `dbt run` failed at 01:08:38.401290 after 0.08 seconds
[0m01:08:38.401570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f05250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b71590>]}
[0m01:08:38.401784 [debug] [MainThread]: Flushing usage events
[0m01:08:38.561179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:54.287562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c2710>]}


============================== 01:13:54.291578 | 8ca97aae-d5b0-407c-a2b9-b0f5338d07bb ==============================
[0m01:13:54.291578 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:13:54.291973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:13:54.366793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ca97aae-d5b0-407c-a2b9-b0f5338d07bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106621ba0>]}
[0m01:13:54.378877 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10911171, "process_in_blocks": "0", "process_kernel_time": 0.131926, "process_mem_max_rss": "106020864", "process_out_blocks": "0", "process_user_time": 0.754629}
[0m01:13:54.379180 [debug] [MainThread]: Command `dbt clean` succeeded at 01:13:54.379103 after 0.11 seconds
[0m01:13:54.379383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d2550>]}
[0m01:13:54.379588 [debug] [MainThread]: Flushing usage events
[0m01:13:54.586721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:06.711770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c2710>]}


============================== 01:14:06.715307 | b507d6aa-d3ed-440f-abbd-940ff3fdf845 ==============================
[0m01:14:06.715307 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:14:06.715701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:14:06.717771 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |       dbname: RetailSales
    5  |       host: localhost
    6  |       pass: Qrious@1985$
    7  |    retail_warehouse:
    8  |   outputs:
    9  |     dev:
    10 |       type: postgres
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 2, column 3
    did not find expected key
      in "<unicode string>", line 7, column 4
  
[0m01:14:06.719884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.025683792, "process_in_blocks": "0", "process_kernel_time": 0.118084, "process_mem_max_rss": "105086976", "process_out_blocks": "0", "process_user_time": 0.688104}
[0m01:14:06.720201 [debug] [MainThread]: Command `dbt run` failed at 01:14:06.720133 after 0.03 seconds
[0m01:14:06.720405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11365a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113910490>]}
[0m01:14:06.720596 [debug] [MainThread]: Flushing usage events
[0m01:14:06.878752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:52.276860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a269e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c3ed0>]}


============================== 01:20:52.280807 | bb9edcf2-018a-4eba-a811-8d331235de00 ==============================
[0m01:20:52.280807 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:20:52.281192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:52.388368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb9edcf2-018a-4eba-a811-8d331235de00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a821ba0>]}
[0m01:20:52.421476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb9edcf2-018a-4eba-a811-8d331235de00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b671ae0>]}
[0m01:20:52.422297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:20:52.469216 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m01:20:52.471434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.23437504, "process_in_blocks": "0", "process_kernel_time": 0.159547, "process_mem_max_rss": "112246784", "process_out_blocks": "0", "process_user_time": 0.850295}
[0m01:20:52.471828 [debug] [MainThread]: Command `dbt run` failed at 01:20:52.471754 after 0.23 seconds
[0m01:20:52.472140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b67d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b67db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b682030>]}
[0m01:20:52.472375 [debug] [MainThread]: Flushing usage events
[0m01:20:52.646961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:49.102806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104741e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565bed0>]}


============================== 01:21:49.105454 | 922b7fce-d39d-49fe-9c2d-620d19c9d352 ==============================
[0m01:21:49.105454 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:21:49.105821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:21:49.194042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922b7fce-d39d-49fe-9c2d-620d19c9d352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb9ba0>]}
[0m01:21:49.222983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922b7fce-d39d-49fe-9c2d-620d19c9d352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bf9b0>]}
[0m01:21:49.223468 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:21:49.265884 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m01:21:49.267716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.20182829, "process_in_blocks": "0", "process_kernel_time": 0.131245, "process_mem_max_rss": "111558656", "process_out_blocks": "0", "process_user_time": 0.824815}
[0m01:21:49.268011 [debug] [MainThread]: Command `dbt run` failed at 01:21:49.267949 after 0.20 seconds
[0m01:21:49.268266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575db80>]}
[0m01:21:49.268476 [debug] [MainThread]: Flushing usage events
[0m01:21:49.425392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:56.904081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a11e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676bed0>]}


============================== 01:21:56.906854 | 740308de-73d3-493d-8d01-9b3d24cbea4a ==============================
[0m01:21:56.906854 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:21:56.907230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:21:56.965686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '740308de-73d3-493d-8d01-9b3d24cbea4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccdba0>]}
[0m01:21:56.984358 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-o42kwk8k'
[0m01:21:56.984610 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:21:57.164039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:21:57.164760 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:21:57.214397 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:21:57.217498 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:21:57.272330 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:21:57.277650 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:21:57.487864 [info ] [MainThread]: Installed from version 0.13.1
[0m01:21:57.488253 [info ] [MainThread]: Up to date!
[0m01:21:57.488507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '740308de-73d3-493d-8d01-9b3d24cbea4a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dfbd0>]}
[0m01:21:57.488787 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:21:57.728436 [info ] [MainThread]: Installed from version 1.3.0
[0m01:21:57.728717 [info ] [MainThread]: Up to date!
[0m01:21:57.728934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '740308de-73d3-493d-8d01-9b3d24cbea4a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597b4d0>]}
[0m01:21:57.730820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8633575, "process_in_blocks": "0", "process_kernel_time": 0.15575, "process_mem_max_rss": "113278976", "process_out_blocks": "0", "process_user_time": 0.825005}
[0m01:21:57.731098 [debug] [MainThread]: Command `dbt deps` succeeded at 01:21:57.731031 after 0.86 seconds
[0m01:21:57.731294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106773cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065eeea0>]}
[0m01:21:57.731478 [debug] [MainThread]: Flushing usage events
[0m01:21:57.937245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:03.737469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d39e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a93c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a93ed0>]}


============================== 01:22:03.740497 | d69db486-ac45-45e8-8c37-873726f24657 ==============================
[0m01:22:03.740497 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:22:03.740906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:22:03.834798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff1ba0>]}
[0m01:22:03.863726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f79b0>]}
[0m01:22:03.865274 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:22:03.921516 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:22:03.922083 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:22:03.922301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b51050>]}
[0m01:22:04.746837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m01:22:04.752879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107783980>]}
[0m01:22:04.804426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:22:04.812719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:22:04.826192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae3070>]}
[0m01:22:04.826491 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m01:22:04.826687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7fee0>]}
[0m01:22:04.827920 [info ] [MainThread]: 
[0m01:22:04.828121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:04.828262 [info ] [MainThread]: 
[0m01:22:04.828533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:22:04.830940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:22:04.863970 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:22:04.864262 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:22:04.864430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:04.886400 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.022 seconds
[0m01:22:04.887387 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:22:04.888736 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:22:04.888953 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:22:04.889102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:04.898229 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m01:22:04.899236 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:22:04.899753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now create_RetailSales_dw_oltp)
[0m01:22:04.900088 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw_oltp"
"
[0m01:22:04.903142 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:22:04.903334 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: BEGIN
[0m01:22:04.903482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:04.913003 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:22:04.913157 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:22:04.913295 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw_oltp"} */
create schema if not exists "dw_oltp"
[0m01:22:04.914530 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m01:22:04.915420 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m01:22:04.915590 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:22:04.915731 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m01:22:04.917291 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:22:04.917440 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: Close
[0m01:22:04.917717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw_oltp, now create_RetailSales_dw_dw)
[0m01:22:04.917968 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw_dw"
"
[0m01:22:04.918934 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m01:22:04.919095 [debug] [ThreadPool]: On create_RetailSales_dw_dw: BEGIN
[0m01:22:04.919234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:04.923530 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:22:04.923681 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m01:22:04.923816 [debug] [ThreadPool]: On create_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw_dw"} */
create schema if not exists "dw_dw"
[0m01:22:04.924729 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m01:22:04.925181 [debug] [ThreadPool]: On create_RetailSales_dw_dw: COMMIT
[0m01:22:04.925347 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_dw"
[0m01:22:04.925484 [debug] [ThreadPool]: On create_RetailSales_dw_dw: COMMIT
[0m01:22:04.926099 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m01:22:04.926246 [debug] [ThreadPool]: On create_RetailSales_dw_dw: Close
[0m01:22:04.927129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw_dw, now list_RetailSales_dw_oltp)
[0m01:22:04.930237 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m01:22:04.930409 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m01:22:04.930540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:04.935198 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:22:04.935347 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m01:22:04.935498 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m01:22:04.939569 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m01:22:04.940170 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m01:22:04.940478 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m01:22:04.940720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now list_RetailSales_dw_dw)
[0m01:22:04.941976 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m01:22:04.942128 [debug] [ThreadPool]: On list_RetailSales_dw_dw: BEGIN
[0m01:22:04.942255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:04.946438 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:22:04.946585 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_dw"
[0m01:22:04.946728 [debug] [ThreadPool]: On list_RetailSales_dw_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_dw'
  
[0m01:22:04.950325 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:22:04.950885 [debug] [ThreadPool]: On list_RetailSales_dw_dw: ROLLBACK
[0m01:22:04.951207 [debug] [ThreadPool]: On list_RetailSales_dw_dw: Close
[0m01:22:04.953534 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:04.953693 [debug] [MainThread]: On master: BEGIN
[0m01:22:04.953824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:04.958278 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:22:04.958432 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:04.958659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:22:04.975888 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m01:22:04.976847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73e90>]}
[0m01:22:04.977227 [debug] [MainThread]: On master: ROLLBACK
[0m01:22:04.977624 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:04.977817 [debug] [MainThread]: On master: BEGIN
[0m01:22:04.978240 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:22:04.978481 [debug] [MainThread]: On master: COMMIT
[0m01:22:04.978675 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:04.978835 [debug] [MainThread]: On master: COMMIT
[0m01:22:04.979099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:04.979249 [debug] [MainThread]: On master: Close
[0m01:22:04.980028 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m01:22:04.980341 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m01:22:04.980706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_dw, now model.retail_warehouse.stg_customers)
[0m01:22:04.980881 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m01:22:04.987772 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m01:22:04.988601 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m01:22:05.007893 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m01:22:05.008660 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:22:05.008866 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m01:22:05.009033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.013126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:22:05.013302 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:22:05.013482 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m01:22:05.017280 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:22:05.020653 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:22:05.020850 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:22:05.021419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:22:05.029364 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:22:05.029594 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:22:05.029777 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:22:05.030453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:05.034087 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m01:22:05.036725 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:22:05.036917 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m01:22:05.037652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:22:05.039131 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m01:22:05.040327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf1a70>]}
[0m01:22:05.040686 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m01:22:05.041011 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m01:22:05.041228 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m01:22:05.041533 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m01:22:05.041841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m01:22:05.042026 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m01:22:05.043588 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m01:22:05.044033 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m01:22:05.045961 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m01:22:05.046332 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:22:05.046492 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m01:22:05.046656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.052185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:22:05.052351 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:22:05.052522 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m01:22:05.056856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:22:05.058398 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:22:05.058592 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:22:05.059301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.059985 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:22:05.060160 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:22:05.060320 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:22:05.060997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:05.062337 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m01:22:05.062666 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:22:05.062833 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m01:22:05.063242 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:22:05.063952 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m01:22:05.064230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108014f50>]}
[0m01:22:05.064555 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:22:05.064849 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m01:22:05.065042 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m01:22:05.065314 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m01:22:05.065583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m01:22:05.065768 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m01:22:05.067243 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m01:22:05.067675 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m01:22:05.069566 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m01:22:05.069939 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:22:05.070106 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m01:22:05.070269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.074571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:22:05.074741 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:22:05.074911 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m01:22:05.076978 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:22:05.078420 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:22:05.078594 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m01:22:05.079025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:22:05.079685 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:22:05.079852 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:22:05.080004 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:22:05.080464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:22:05.081498 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m01:22:05.081830 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:22:05.081992 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m01:22:05.082333 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:22:05.082933 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m01:22:05.083192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3aa50>]}
[0m01:22:05.083495 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:22:05.083763 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m01:22:05.083945 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m01:22:05.084195 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m01:22:05.084422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m01:22:05.084588 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m01:22:05.086318 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m01:22:05.086723 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m01:22:05.088267 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m01:22:05.088613 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:22:05.088777 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m01:22:05.088927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.094636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:22:05.094824 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:22:05.094991 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m01:22:05.099863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m01:22:05.101765 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:22:05.101955 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m01:22:05.102651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.103360 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:22:05.103541 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:22:05.103708 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:22:05.104607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:05.105658 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m01:22:05.106000 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:22:05.106164 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m01:22:05.106635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:22:05.107259 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m01:22:05.107546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108027e70>]}
[0m01:22:05.107872 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:22:05.108155 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m01:22:05.108353 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m01:22:05.108636 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m01:22:05.108888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m01:22:05.109088 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m01:22:05.110918 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m01:22:05.111483 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m01:22:05.113201 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m01:22:05.113622 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:22:05.113789 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m01:22:05.113942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.118405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:22:05.118572 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:22:05.118734 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m01:22:05.122656 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:22:05.124209 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:22:05.124396 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m01:22:05.124999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:22:05.125644 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:22:05.125808 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:22:05.125956 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:22:05.126746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:05.127768 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m01:22:05.128093 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:22:05.128253 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m01:22:05.128601 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:22:05.129199 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m01:22:05.129461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806c0b0>]}
[0m01:22:05.129769 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:22:05.130039 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m01:22:05.130234 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m01:22:05.130521 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_dw.dim_customers ............................... [RUN]
[0m01:22:05.130844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m01:22:05.131049 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m01:22:05.132597 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m01:22:05.133230 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m01:22:05.144937 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m01:22:05.145477 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:22:05.145655 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m01:22:05.145813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.150673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:22:05.150842 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:22:05.151006 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m01:22:05.158982 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.008 seconds
[0m01:22:05.162557 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:22:05.162743 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw_dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:22:05.163521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.164196 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:22:05.164366 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:22:05.164520 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:22:05.165080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:22:05.166112 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_customers__dbt_backup"
[0m01:22:05.167607 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:22:05.167782 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw_dw"."dim_customers__dbt_backup" cascade
[0m01:22:05.168195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:22:05.168809 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m01:22:05.169061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806c3b0>]}
[0m01:22:05.169359 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw_dw.dim_customers .......................... [[32mSELECT 100[0m in 0.04s]
[0m01:22:05.169633 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m01:22:05.169815 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m01:22:05.170065 [info ] [Thread-1 (]: 7 of 9 START sql table model dw_dw.dim_products ................................ [RUN]
[0m01:22:05.170298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m01:22:05.170469 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m01:22:05.171884 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m01:22:05.172331 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m01:22:05.176261 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m01:22:05.176661 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:22:05.176825 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m01:22:05.176999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.180880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:22:05.181045 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:22:05.181208 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m01:22:05.189345 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.008 seconds
[0m01:22:05.190932 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:22:05.191108 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw_dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:22:05.191919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.192594 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:22:05.192760 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:22:05.192911 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:22:05.194068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:05.195322 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_products__dbt_backup"
[0m01:22:05.195654 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:22:05.195817 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw_dw"."dim_products__dbt_backup" cascade
[0m01:22:05.196226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:22:05.196837 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m01:22:05.197106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efd8b0>]}
[0m01:22:05.197413 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw_dw.dim_products ........................... [[32mSELECT 50[0m in 0.03s]
[0m01:22:05.197690 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m01:22:05.197873 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m01:22:05.198151 [info ] [Thread-1 (]: 8 of 9 START sql table model dw_dw.dim_promotions .............................. [RUN]
[0m01:22:05.198397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m01:22:05.198571 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m01:22:05.200038 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m01:22:05.200438 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m01:22:05.202319 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m01:22:05.202686 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:22:05.202846 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m01:22:05.202997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.207790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:22:05.207978 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:22:05.208149 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m01:22:05.215650 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.007 seconds
[0m01:22:05.217279 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:22:05.217456 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw_dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m01:22:05.218216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.218865 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:22:05.219031 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:22:05.219180 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:22:05.219679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:22:05.220939 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_promotions__dbt_backup"
[0m01:22:05.221266 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:22:05.221433 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw_dw"."dim_promotions__dbt_backup" cascade
[0m01:22:05.221851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:22:05.222444 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m01:22:05.222703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efdcd0>]}
[0m01:22:05.223010 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw_dw.dim_promotions ......................... [[32mSELECT 15[0m in 0.02s]
[0m01:22:05.223282 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m01:22:05.223467 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m01:22:05.223722 [info ] [Thread-1 (]: 9 of 9 START sql table model dw_dw.dim_stores .................................. [RUN]
[0m01:22:05.223950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m01:22:05.224119 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m01:22:05.225530 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m01:22:05.225923 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m01:22:05.227735 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m01:22:05.228095 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:22:05.228251 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m01:22:05.228401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.232175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:22:05.232343 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:22:05.232507 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw_dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m01:22:05.239160 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m01:22:05.240566 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:22:05.240734 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw_dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m01:22:05.241499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:05.242151 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:22:05.242314 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:22:05.242461 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:22:05.243005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:22:05.243996 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_dw"."dim_stores__dbt_backup"
[0m01:22:05.244315 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:22:05.244480 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw_dw"."dim_stores__dbt_backup" cascade
[0m01:22:05.244857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:22:05.245445 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m01:22:05.245687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69db486-ac45-45e8-8c37-873726f24657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806d730>]}
[0m01:22:05.245975 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw_dw.dim_stores ............................. [[32mSELECT 10[0m in 0.02s]
[0m01:22:05.246245 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m01:22:05.247121 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:05.247289 [debug] [MainThread]: On master: BEGIN
[0m01:22:05.247426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:22:05.256205 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:22:05.256457 [debug] [MainThread]: On master: COMMIT
[0m01:22:05.256614 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:05.256758 [debug] [MainThread]: On master: COMMIT
[0m01:22:05.257644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:05.257818 [debug] [MainThread]: On master: Close
[0m01:22:05.258047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:05.258188 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m01:22:05.258398 [info ] [MainThread]: 
[0m01:22:05.258574 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:22:05.259632 [debug] [MainThread]: Command end result
[0m01:22:05.277918 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:22:05.279479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:22:05.283431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:22:05.283653 [info ] [MainThread]: 
[0m01:22:05.283859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:05.284012 [info ] [MainThread]: 
[0m01:22:05.284178 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:22:05.288945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5905099, "process_in_blocks": "0", "process_kernel_time": 0.208433, "process_mem_max_rss": "138756096", "process_out_blocks": "0", "process_user_time": 1.941599}
[0m01:22:05.289827 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:05.289697 after 1.59 seconds
[0m01:22:05.290520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806fe90>]}
[0m01:22:05.291190 [debug] [MainThread]: Flushing usage events
[0m01:22:05.701632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:21.498940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106609e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3ed0>]}


============================== 01:28:21.502401 | d3b81b53-95a8-4dd5-8143-2ee9e3b99bd3 ==============================
[0m01:28:21.502401 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:28:21.502767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:21.598885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21ba0>]}
[0m01:28:21.627653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a279b0>]}
[0m01:28:21.628311 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:28:21.684423 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:28:21.777672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:21.777959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:21.781341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.core.facts
- models.retail_warehouse.marts.intermediate
[0m01:28:21.803130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c81f50>]}
[0m01:28:21.855010 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:28:21.862289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:28:21.875753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccb110>]}
[0m01:28:21.876047 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 571 macros
[0m01:28:21.876238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a63dfd0>]}
[0m01:28:21.877567 [info ] [MainThread]: 
[0m01:28:21.877776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:21.877925 [info ] [MainThread]: 
[0m01:28:21.878194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:28:21.880563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:28:21.914191 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:28:21.914457 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:28:21.914621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:21.933785 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m01:28:21.934652 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:28:21.935910 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:28:21.936128 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:28:21.936296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:21.940210 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m01:28:21.940821 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:28:21.941145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now create_RetailSales_dw_oltp)
[0m01:28:21.941376 [debug] [ThreadPool]: Creating schema "database: "RetailSales"
schema: "dw_oltp"
"
[0m01:28:21.944132 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:28:21.944293 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: BEGIN
[0m01:28:21.944422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:21.950343 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m01:28:21.950527 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:28:21.950687 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "create_RetailSales_dw_oltp"} */
create schema if not exists "dw_oltp"
[0m01:28:21.951648 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m01:28:21.952645 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m01:28:21.952843 [debug] [ThreadPool]: Using postgres connection "create_RetailSales_dw_oltp"
[0m01:28:21.952995 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: COMMIT
[0m01:28:21.953455 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m01:28:21.953641 [debug] [ThreadPool]: On create_RetailSales_dw_oltp: Close
[0m01:28:21.954567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RetailSales_dw_oltp, now list_RetailSales_dw)
[0m01:28:21.958697 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:28:21.958964 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:28:21.959115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:21.963571 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:28:21.963841 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:28:21.964021 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:28:21.967561 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m01:28:21.968355 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:28:21.968657 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:28:21.968934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_dw_oltp)
[0m01:28:21.970407 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m01:28:21.970577 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: BEGIN
[0m01:28:21.970716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:21.974190 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:28:21.974356 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw_oltp"
[0m01:28:21.974509 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_oltp'
  
[0m01:28:21.978071 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:28:21.978739 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: ROLLBACK
[0m01:28:21.979020 [debug] [ThreadPool]: On list_RetailSales_dw_oltp: Close
[0m01:28:21.982001 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:21.982196 [debug] [MainThread]: On master: BEGIN
[0m01:28:21.982338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:21.985552 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:28:21.985707 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:21.985906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:28:22.001539 [debug] [MainThread]: SQL status: SELECT 5 in 0.015 seconds
[0m01:28:22.002237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8cd710>]}
[0m01:28:22.002480 [debug] [MainThread]: On master: ROLLBACK
[0m01:28:22.002776 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:22.002914 [debug] [MainThread]: On master: BEGIN
[0m01:28:22.003257 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:28:22.003395 [debug] [MainThread]: On master: COMMIT
[0m01:28:22.003524 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:22.003646 [debug] [MainThread]: On master: COMMIT
[0m01:28:22.003869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.004003 [debug] [MainThread]: On master: Close
[0m01:28:22.004744 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m01:28:22.005007 [info ] [Thread-1 (]: 1 of 9 START sql view model dw_oltp.stg_customers .............................. [RUN]
[0m01:28:22.005231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw_oltp, now model.retail_warehouse.stg_customers)
[0m01:28:22.005397 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m01:28:22.009579 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m01:28:22.009977 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m01:28:22.028113 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m01:28:22.028722 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:28:22.028916 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m01:28:22.029077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.035059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:28:22.035244 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:28:22.035418 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."dw_oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m01:28:22.038548 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:28:22.041929 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:28:22.042119 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."dw_oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:28:22.042756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.050055 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:28:22.050241 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:28:22.050398 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:28:22.050958 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.053912 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_customers__dbt_backup"
[0m01:28:22.056331 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:28:22.056510 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."dw_oltp"."stg_customers__dbt_backup" cascade
[0m01:28:22.057036 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:28:22.058524 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m01:28:22.064802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d8650>]}
[0m01:28:22.065166 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dw_oltp.stg_customers ......................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:28:22.065477 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m01:28:22.065675 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m01:28:22.065976 [info ] [Thread-1 (]: 2 of 9 START sql view model dw_oltp.stg_products ............................... [RUN]
[0m01:28:22.066289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m01:28:22.066468 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m01:28:22.068385 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m01:28:22.068769 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m01:28:22.070424 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m01:28:22.070755 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:28:22.070918 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m01:28:22.071074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.074835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:28:22.075001 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:28:22.075169 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."dw_oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m01:28:22.078777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:28:22.082574 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:28:22.082773 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."dw_oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:28:22.083314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.084017 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:28:22.084191 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:28:22.084346 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:28:22.084934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.085973 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_products__dbt_backup"
[0m01:28:22.086305 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:28:22.086477 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."dw_oltp"."stg_products__dbt_backup" cascade
[0m01:28:22.086792 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:28:22.087398 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m01:28:22.087687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a632780>]}
[0m01:28:22.088010 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dw_oltp.stg_products .......................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:28:22.088287 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m01:28:22.088474 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m01:28:22.088729 [info ] [Thread-1 (]: 3 of 9 START sql view model dw_oltp.stg_promotions ............................. [RUN]
[0m01:28:22.089013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m01:28:22.089215 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m01:28:22.124210 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m01:28:22.124706 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m01:28:22.126448 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m01:28:22.126808 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:28:22.126982 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m01:28:22.127141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.131071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:28:22.131274 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:28:22.131455 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m01:28:22.134528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:28:22.136261 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:28:22.136441 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."dw_oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m01:28:22.136946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.137627 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:28:22.137797 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:28:22.137951 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:28:22.138856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:28:22.139909 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_promotions__dbt_backup"
[0m01:28:22.140252 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:28:22.140418 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."dw_oltp"."stg_promotions__dbt_backup" cascade
[0m01:28:22.140873 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:28:22.141491 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m01:28:22.141760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109913250>]}
[0m01:28:22.142074 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dw_oltp.stg_promotions ........................ [[32mCREATE VIEW[0m in 0.05s]
[0m01:28:22.142357 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m01:28:22.142544 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m01:28:22.142814 [info ] [Thread-1 (]: 4 of 9 START sql view model dw_oltp.stg_sales .................................. [RUN]
[0m01:28:22.143098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m01:28:22.143268 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m01:28:22.144991 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m01:28:22.145327 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m01:28:22.146922 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m01:28:22.147239 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:28:22.147400 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m01:28:22.147554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.154021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:28:22.154185 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:28:22.154349 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."dw_oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m01:28:22.158980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:28:22.160533 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:28:22.160706 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."dw_oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m01:28:22.161408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:28:22.162057 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:28:22.162224 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:28:22.162374 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:28:22.162970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.163969 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_sales__dbt_backup"
[0m01:28:22.164288 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:28:22.164447 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."dw_oltp"."stg_sales__dbt_backup" cascade
[0m01:28:22.164813 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:28:22.165385 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m01:28:22.165621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109914650>]}
[0m01:28:22.165907 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dw_oltp.stg_sales ............................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:28:22.166175 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m01:28:22.166357 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m01:28:22.166599 [info ] [Thread-1 (]: 5 of 9 START sql view model dw_oltp.stg_stores ................................. [RUN]
[0m01:28:22.166822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m01:28:22.166987 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m01:28:22.168736 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m01:28:22.169244 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m01:28:22.170806 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m01:28:22.171085 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:28:22.171237 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m01:28:22.171388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.176177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:28:22.176340 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:28:22.176564 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."dw_oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m01:28:22.178588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:28:22.180091 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:28:22.180263 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."dw_oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m01:28:22.180744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.181638 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:28:22.181806 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:28:22.181957 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:28:22.182424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.183473 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw_oltp"."stg_stores__dbt_backup"
[0m01:28:22.183806 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:28:22.183979 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."dw_oltp"."stg_stores__dbt_backup" cascade
[0m01:28:22.184337 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:28:22.184956 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m01:28:22.185232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9cf690>]}
[0m01:28:22.185548 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dw_oltp.stg_stores ............................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:28:22.185836 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m01:28:22.186033 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m01:28:22.186343 [info ] [Thread-1 (]: 6 of 9 START sql table model dw.dim_customers .................................. [RUN]
[0m01:28:22.186655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m01:28:22.186853 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m01:28:22.188391 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m01:28:22.188771 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m01:28:22.200473 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m01:28:22.200882 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:28:22.201067 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m01:28:22.201225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.207130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:28:22.207323 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:28:22.207497 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."dw_oltp"."stg_customers"
  );
  
[0m01:28:22.218091 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.010 seconds
[0m01:28:22.221907 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:28:22.222104 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:28:22.223022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:28:22.223747 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:28:22.223915 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:28:22.224064 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:28:22.224942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:28:22.226158 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_customers__dbt_backup"
[0m01:28:22.229542 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:28:22.229734 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw"."dim_customers__dbt_backup" cascade
[0m01:28:22.230439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:28:22.231171 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m01:28:22.231481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734e330>]}
[0m01:28:22.231804 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.04s]
[0m01:28:22.232087 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m01:28:22.232275 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m01:28:22.232540 [info ] [Thread-1 (]: 7 of 9 START sql table model dw.dim_products ................................... [RUN]
[0m01:28:22.232780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m01:28:22.232951 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m01:28:22.234398 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m01:28:22.234797 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m01:28:22.236781 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m01:28:22.237248 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:28:22.237417 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m01:28:22.237572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.241846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:28:22.242091 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:28:22.242299 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."dw_oltp"."stg_products"
  );
  
[0m01:28:22.247057 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m01:28:22.248694 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:28:22.248880 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:28:22.249521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.250212 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:28:22.250383 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:28:22.250535 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:28:22.251127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.252443 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_products__dbt_backup"
[0m01:28:22.252778 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:28:22.252953 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw"."dim_products__dbt_backup" cascade
[0m01:28:22.253309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:28:22.253930 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m01:28:22.254191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e5970>]}
[0m01:28:22.254507 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw.dim_products .............................. [[32mSELECT 50[0m in 0.02s]
[0m01:28:22.254783 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m01:28:22.254970 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m01:28:22.255219 [info ] [Thread-1 (]: 8 of 9 START sql table model dw.dim_promotions ................................. [RUN]
[0m01:28:22.255436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m01:28:22.255605 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m01:28:22.256947 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m01:28:22.257265 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m01:28:22.259074 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m01:28:22.259363 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:28:22.259521 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m01:28:22.259672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.263702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:28:22.263870 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:28:22.264032 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."dw_oltp"."stg_promotions"
  );
  
[0m01:28:22.268112 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.004 seconds
[0m01:28:22.269629 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:28:22.269797 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m01:28:22.270430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.271079 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:28:22.271248 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:28:22.271397 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:28:22.271860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.273095 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m01:28:22.273420 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:28:22.273582 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m01:28:22.273941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:28:22.274584 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m01:28:22.274850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac64b0>]}
[0m01:28:22.275163 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 15[0m in 0.02s]
[0m01:28:22.275441 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m01:28:22.275627 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m01:28:22.275881 [info ] [Thread-1 (]: 9 of 9 START sql table model dw.dim_stores ..................................... [RUN]
[0m01:28:22.276105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m01:28:22.276277 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m01:28:22.277654 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m01:28:22.277990 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m01:28:22.282002 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m01:28:22.282305 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:28:22.282461 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m01:28:22.282615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:22.287776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:28:22.287952 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:28:22.288122 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."dw_oltp"."stg_stores"
  );
  
[0m01:28:22.292701 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m01:28:22.294260 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:28:22.294437 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m01:28:22.295032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:22.295697 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:28:22.295865 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:28:22.296017 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:28:22.296507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.297797 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_stores__dbt_backup"
[0m01:28:22.298136 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:28:22.298301 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw"."dim_stores__dbt_backup" cascade
[0m01:28:22.298637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:28:22.299237 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m01:28:22.299490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b81b53-95a8-4dd5-8143-2ee9e3b99bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c5370>]}
[0m01:28:22.299791 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw.dim_stores ................................ [[32mSELECT 10[0m in 0.02s]
[0m01:28:22.300065 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m01:28:22.300890 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:22.301047 [debug] [MainThread]: On master: BEGIN
[0m01:28:22.301175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:22.304705 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:28:22.304850 [debug] [MainThread]: On master: COMMIT
[0m01:28:22.304981 [debug] [MainThread]: Using postgres connection "master"
[0m01:28:22.305103 [debug] [MainThread]: On master: COMMIT
[0m01:28:22.305348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:22.305481 [debug] [MainThread]: On master: Close
[0m01:28:22.305667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:22.305797 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m01:28:22.306000 [info ] [MainThread]: 
[0m01:28:22.306170 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:28:22.306971 [debug] [MainThread]: Command end result
[0m01:28:22.323296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:28:22.324334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:28:22.328120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:28:22.328290 [info ] [MainThread]: 
[0m01:28:22.328470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:22.328618 [info ] [MainThread]: 
[0m01:28:22.328767 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:28:22.330820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.87378466, "process_in_blocks": "0", "process_kernel_time": 0.210187, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 1.265527}
[0m01:28:22.331063 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:22.331015 after 0.87 seconds
[0m01:28:22.331250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4f9b0>]}
[0m01:28:22.331429 [debug] [MainThread]: Flushing usage events
[0m01:28:22.820476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:06.680502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a41e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895bed0>]}


============================== 01:37:06.684112 | e21bf36d-e769-4803-a9bc-e8519b7e7270 ==============================
[0m01:37:06.684112 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:37:06.684502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:06.752580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e21bf36d-e769-4803-a9bc-e8519b7e7270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebdba0>]}
[0m01:37:06.795313 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15732396, "process_in_blocks": "0", "process_kernel_time": 0.150511, "process_mem_max_rss": "107610112", "process_out_blocks": "0", "process_user_time": 0.776713}
[0m01:37:06.795716 [debug] [MainThread]: Command `dbt clean` succeeded at 01:37:06.795641 after 0.16 seconds
[0m01:37:06.795960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac6550>]}
[0m01:37:06.796182 [debug] [MainThread]: Flushing usage events
[0m01:37:07.039857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:12.919091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111369e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c3ed0>]}


============================== 01:37:12.922333 | 9f8a7bbe-ed37-4d26-8e2e-5fa87e6613aa ==============================
[0m01:37:12.922333 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:37:12.922850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:37:13.027878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f8a7bbe-ed37-4d26-8e2e-5fa87e6613aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111721ba0>]}
[0m01:37:13.057982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f8a7bbe-ed37-4d26-8e2e-5fa87e6613aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112571ae0>]}
[0m01:37:13.058840 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:37:13.106104 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m01:37:13.108118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2347832, "process_in_blocks": "0", "process_kernel_time": 0.1443, "process_mem_max_rss": "112394240", "process_out_blocks": "0", "process_user_time": 0.851344}
[0m01:37:13.108461 [debug] [MainThread]: Command `dbt run` failed at 01:37:13.108391 after 0.24 seconds
[0m01:37:13.108864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112582030>]}
[0m01:37:13.109146 [debug] [MainThread]: Flushing usage events
[0m01:37:13.261422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:26.833747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215f9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ac3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ac3ed0>]}


============================== 01:37:26.836374 | 8031cfc3-5ca1-4b6d-a18d-19a033b43850 ==============================
[0m01:37:26.836374 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:37:26.836768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:26.898218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8031cfc3-5ca1-4b6d-a18d-19a033b43850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d21ba0>]}
[0m01:37:26.914392 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-ie2opzpo'
[0m01:37:26.914660 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:37:27.133802 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:37:27.135502 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:37:27.247471 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:37:27.251188 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:37:27.365186 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:37:27.370210 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:37:27.596370 [info ] [MainThread]: Installed from version 0.13.1
[0m01:37:27.596673 [info ] [MainThread]: Up to date!
[0m01:37:27.596886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8031cfc3-5ca1-4b6d-a18d-19a033b43850', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d33df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d33ce0>]}
[0m01:37:27.597115 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:37:27.820886 [info ] [MainThread]: Installed from version 1.3.0
[0m01:37:27.821195 [info ] [MainThread]: Up to date!
[0m01:37:27.821409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8031cfc3-5ca1-4b6d-a18d-19a033b43850', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d2f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215475c0>]}
[0m01:37:27.823259 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0255861, "process_in_blocks": "0", "process_kernel_time": 0.164354, "process_mem_max_rss": "112148480", "process_out_blocks": "0", "process_user_time": 0.82273}
[0m01:37:27.823533 [debug] [MainThread]: Command `dbt deps` succeeded at 01:37:27.823476 after 1.03 seconds
[0m01:37:27.823736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122acbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bd0210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122942ea0>]}
[0m01:37:27.823928 [debug] [MainThread]: Flushing usage events
[0m01:37:28.124933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:37.412977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc3ed0>]}


============================== 01:37:37.416064 | 377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58 ==============================
[0m01:37:37.416064 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:37:37.416437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:37:37.516284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110121ba0>]}
[0m01:37:37.546910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111871ae0>]}
[0m01:37:37.548582 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:37:37.608292 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:37:37.608940 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:37:37.609228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111879150>]}
[0m01:37:38.414412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.core.facts
- models.retail_warehouse.marts.intermediate
[0m01:37:38.420383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c0cc80>]}
[0m01:37:38.476477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:37:38.484134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:37:38.496759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc8750>]}
[0m01:37:38.497057 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 572 macros
[0m01:37:38.497257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11465bee0>]}
[0m01:37:38.498494 [info ] [MainThread]: 
[0m01:37:38.498692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:38.498840 [info ] [MainThread]: 
[0m01:37:38.499094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:37:38.501483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:37:38.535772 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:37:38.536041 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:37:38.536205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:38.559732 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m01:37:38.560608 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:37:38.561813 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:37:38.562028 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:37:38.562184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:38.568780 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m01:37:38.569492 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:37:38.570434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:37:38.573576 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:37:38.573756 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:37:38.573897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:38.578836 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.579016 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:37:38.579183 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:37:38.584898 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m01:37:38.585966 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:37:38.586278 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:37:38.586538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m01:37:38.588017 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:37:38.588171 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:37:38.588302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:38.592352 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:37:38.592564 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:37:38.592740 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:37:38.596682 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m01:37:38.597355 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:37:38.597670 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:37:38.600487 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.600654 [debug] [MainThread]: On master: BEGIN
[0m01:37:38.600790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:38.605635 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.605797 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.605996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:37:38.629802 [debug] [MainThread]: SQL status: SELECT 10 in 0.024 seconds
[0m01:37:38.631671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145dfe90>]}
[0m01:37:38.631938 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:38.632248 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.632393 [debug] [MainThread]: On master: BEGIN
[0m01:37:38.632792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:37:38.632941 [debug] [MainThread]: On master: COMMIT
[0m01:37:38.633075 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.633201 [debug] [MainThread]: On master: COMMIT
[0m01:37:38.633453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.633602 [debug] [MainThread]: On master: Close
[0m01:37:38.634749 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m01:37:38.635093 [info ] [Thread-1 (]: 1 of 9 START sql view model oltp.stg_customers ................................. [RUN]
[0m01:37:38.635396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.stg_customers)
[0m01:37:38.635612 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m01:37:38.640635 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m01:37:38.641578 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m01:37:38.662647 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m01:37:38.663408 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:37:38.663604 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m01:37:38.663777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.668700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.668935 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:37:38.669138 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m01:37:38.673401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:37:38.677106 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:37:38.677416 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:37:38.678171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.688391 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:37:38.688650 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:37:38.688829 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:37:38.690537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:37:38.694064 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_customers__dbt_backup"
[0m01:37:38.697161 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:37:38.697402 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."oltp"."stg_customers__dbt_backup" cascade
[0m01:37:38.697870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:38.699326 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m01:37:38.700573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146de8e0>]}
[0m01:37:38.700961 [info ] [Thread-1 (]: 1 of 9 OK created sql view model oltp.stg_customers ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m01:37:38.701299 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m01:37:38.701510 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m01:37:38.701796 [info ] [Thread-1 (]: 2 of 9 START sql view model oltp.stg_products .................................. [RUN]
[0m01:37:38.702083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m01:37:38.702274 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m01:37:38.704045 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m01:37:38.704500 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m01:37:38.706004 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m01:37:38.706401 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:37:38.706571 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m01:37:38.706733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.710304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:37:38.710606 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:37:38.710831 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m01:37:38.713994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:38.715654 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:37:38.716106 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:37:38.716753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.717401 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:37:38.717596 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:37:38.717761 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:37:38.718161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.719193 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_products__dbt_backup"
[0m01:37:38.719467 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:37:38.719645 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."oltp"."stg_products__dbt_backup" cascade
[0m01:37:38.719979 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:38.720615 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m01:37:38.720913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115abee90>]}
[0m01:37:38.721240 [info ] [Thread-1 (]: 2 of 9 OK created sql view model oltp.stg_products ............................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:37:38.721526 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m01:37:38.721724 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m01:37:38.722022 [info ] [Thread-1 (]: 3 of 9 START sql view model oltp.stg_promotions ................................ [RUN]
[0m01:37:38.722347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m01:37:38.722526 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m01:37:38.724054 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m01:37:38.724522 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m01:37:38.726504 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m01:37:38.727041 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:38.727222 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m01:37:38.727504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.732287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.732581 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:38.732791 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m01:37:38.737181 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:37:38.738859 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:38.739072 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m01:37:38.739700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.740348 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:37:38.740531 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:38.740687 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:37:38.741185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.742697 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_promotions__dbt_backup"
[0m01:37:38.743001 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:37:38.743185 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."oltp"."stg_promotions__dbt_backup" cascade
[0m01:37:38.743800 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:38.744506 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m01:37:38.744822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159a81d0>]}
[0m01:37:38.745165 [info ] [Thread-1 (]: 3 of 9 OK created sql view model oltp.stg_promotions ........................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:37:38.745465 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m01:37:38.745666 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m01:37:38.745935 [info ] [Thread-1 (]: 4 of 9 START sql view model oltp.stg_sales ..................................... [RUN]
[0m01:37:38.746167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m01:37:38.746422 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m01:37:38.748096 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m01:37:38.748655 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m01:37:38.750574 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m01:37:38.750994 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:37:38.751176 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m01:37:38.751335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.757933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:37:38.758152 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:37:38.758339 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m01:37:38.761319 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:38.762836 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:37:38.763039 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m01:37:38.763525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.764122 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:37:38.764294 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:37:38.764450 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:37:38.765123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:38.766370 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_sales__dbt_backup"
[0m01:37:38.766644 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:37:38.766815 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."oltp"."stg_sales__dbt_backup" cascade
[0m01:37:38.767234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:38.768064 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m01:37:38.768378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d1cc0>]}
[0m01:37:38.768709 [info ] [Thread-1 (]: 4 of 9 OK created sql view model oltp.stg_sales ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:37:38.769026 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m01:37:38.769228 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m01:37:38.769525 [info ] [Thread-1 (]: 5 of 9 START sql view model oltp.stg_stores .................................... [RUN]
[0m01:37:38.769833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m01:37:38.770030 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m01:37:38.771655 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m01:37:38.772205 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m01:37:38.773847 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m01:37:38.774320 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:37:38.774492 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m01:37:38.774658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.778592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:37:38.778814 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:37:38.779328 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m01:37:38.782972 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:38.784561 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:37:38.784754 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m01:37:38.785463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.786124 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:37:38.786304 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:37:38.786469 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:37:38.787112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.788151 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_stores__dbt_backup"
[0m01:37:38.788417 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:37:38.788595 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."oltp"."stg_stores__dbt_backup" cascade
[0m01:37:38.788946 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:38.789603 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m01:37:38.789902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ab1070>]}
[0m01:37:38.790242 [info ] [Thread-1 (]: 5 of 9 OK created sql view model oltp.stg_stores ............................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:37:38.790532 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m01:37:38.790739 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m01:37:38.791010 [info ] [Thread-1 (]: 6 of 9 START sql table model dw.dim_customers .................................. [RUN]
[0m01:37:38.791235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m01:37:38.791460 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m01:37:38.793575 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m01:37:38.794281 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m01:37:38.806106 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m01:37:38.806731 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.806926 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m01:37:38.807095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.811858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.812155 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.812365 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."oltp"."stg_customers"
  );
  
[0m01:37:38.820015 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.007 seconds
[0m01:37:38.823795 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.824019 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:37:38.824611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.826063 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.826288 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:37:38.827277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.829125 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:37:38.829329 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.829499 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:37:38.830152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.831514 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_customers__dbt_backup"
[0m01:37:38.832895 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:37:38.833086 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw"."dim_customers__dbt_backup" cascade
[0m01:37:38.836574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:37:38.837230 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m01:37:38.837521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11597a210>]}
[0m01:37:38.837853 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.05s]
[0m01:37:38.838162 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m01:37:38.838359 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m01:37:38.838634 [info ] [Thread-1 (]: 7 of 9 START sql table model dw.dim_products ................................... [RUN]
[0m01:37:38.838893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m01:37:38.839075 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m01:37:38.840439 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m01:37:38.840908 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m01:37:38.842670 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m01:37:38.843091 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.843254 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m01:37:38.843414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.848261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.848498 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.848692 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."oltp"."stg_products"
  );
  
[0m01:37:38.855517 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.007 seconds
[0m01:37:38.857414 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.857620 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products" rename to "dim_products__dbt_backup"
[0m01:37:38.858194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.861885 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.862098 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:37:38.862899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.863566 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:37:38.863743 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.863899 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:37:38.864712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:38.865736 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_products__dbt_backup"
[0m01:37:38.866009 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:37:38.866180 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw"."dim_products__dbt_backup" cascade
[0m01:37:38.869621 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:37:38.870242 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m01:37:38.870535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115979970>]}
[0m01:37:38.870864 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw.dim_products .............................. [[32mSELECT 50[0m in 0.03s]
[0m01:37:38.871163 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m01:37:38.871357 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m01:37:38.871641 [info ] [Thread-1 (]: 8 of 9 START sql table model dw.dim_promotions ................................. [RUN]
[0m01:37:38.871910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m01:37:38.872090 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m01:37:38.873870 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m01:37:38.874347 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m01:37:38.875947 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m01:37:38.876407 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.876587 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m01:37:38.876750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.880367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:37:38.880589 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.880850 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."oltp"."stg_promotions"
  );
  
[0m01:37:38.885962 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m01:37:38.887528 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.887723 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m01:37:38.888483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.889905 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.890097 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m01:37:38.890834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.891499 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:37:38.891696 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.891869 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:37:38.892300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.893466 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m01:37:38.893756 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:37:38.893931 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m01:37:38.896490 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:37:38.897191 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m01:37:38.897499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc5670>]}
[0m01:37:38.897831 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 15[0m in 0.03s]
[0m01:37:38.898135 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m01:37:38.898330 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m01:37:38.898618 [info ] [Thread-1 (]: 9 of 9 START sql table model dw.dim_stores ..................................... [RUN]
[0m01:37:38.898892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m01:37:38.899087 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m01:37:38.901027 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m01:37:38.901508 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m01:37:38.903067 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m01:37:38.903494 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.903667 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m01:37:38.903831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:38.908871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:37:38.909054 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.909231 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."oltp"."stg_stores"
  );
  
[0m01:37:38.915624 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m01:37:38.917522 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.917723 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores" rename to "dim_stores__dbt_backup"
[0m01:37:38.918065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:38.919380 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.919562 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m01:37:38.920409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:38.921015 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:37:38.921189 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.921344 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:37:38.921846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.923139 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_stores__dbt_backup"
[0m01:37:38.923407 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:37:38.923578 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw"."dim_stores__dbt_backup" cascade
[0m01:37:38.927425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:37:38.928067 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m01:37:38.928358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377c1c2f-6a73-4ee5-ae75-f01ef5c8fa58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11597a090>]}
[0m01:37:38.928672 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw.dim_stores ................................ [[32mSELECT 10[0m in 0.03s]
[0m01:37:38.928966 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m01:37:38.929718 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.929887 [debug] [MainThread]: On master: BEGIN
[0m01:37:38.930026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:38.937308 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:37:38.937473 [debug] [MainThread]: On master: COMMIT
[0m01:37:38.937615 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:38.937743 [debug] [MainThread]: On master: COMMIT
[0m01:37:38.938013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:38.938154 [debug] [MainThread]: On master: Close
[0m01:37:38.938343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:38.938483 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m01:37:38.938683 [info ] [MainThread]: 
[0m01:37:38.938866 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m01:37:38.939705 [debug] [MainThread]: Command end result
[0m01:37:38.958087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:37:38.959706 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:37:38.963209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:37:38.963381 [info ] [MainThread]: 
[0m01:37:38.963582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:38.963732 [info ] [MainThread]: 
[0m01:37:38.963892 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:37:38.966042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5908062, "process_in_blocks": "0", "process_kernel_time": 0.221169, "process_mem_max_rss": "140115968", "process_out_blocks": "0", "process_user_time": 1.951432}
[0m01:37:38.966348 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:38.966290 after 1.59 seconds
[0m01:37:38.966571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106358110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ab3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ab3b30>]}
[0m01:37:38.966785 [debug] [MainThread]: Flushing usage events
[0m01:37:39.154985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:48.183948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106169e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c3ed0>]}


============================== 01:39:48.187082 | 4bf18f10-19f8-4781-868a-558d56deb5df ==============================
[0m01:39:48.187082 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:39:48.187466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:39:48.288395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106721ba0>]}
[0m01:39:48.317838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107771ae0>]}
[0m01:39:48.318569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:39:48.391388 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:39:48.481888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:39:48.482136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:39:48.485327 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m01:39:48.508204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777e050>]}
[0m01:39:48.561706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:39:48.568924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:39:48.583949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077835c0>]}
[0m01:39:48.584273 [info ] [MainThread]: Found 9 models, 10 data tests, 5 sources, 572 macros
[0m01:39:48.584475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11864e0b0>]}
[0m01:39:48.585792 [info ] [MainThread]: 
[0m01:39:48.586003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:39:48.586149 [info ] [MainThread]: 
[0m01:39:48.586436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:39:48.588842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:39:48.623996 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:39:48.624293 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:39:48.624495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:48.653081 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m01:39:48.654157 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:39:48.655533 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:39:48.655787 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:39:48.656002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:48.661078 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m01:39:48.661893 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:39:48.663005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_oltp)
[0m01:39:48.666344 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:39:48.666588 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:39:48.666746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:48.671379 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:39:48.671541 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:39:48.671696 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:39:48.676161 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m01:39:48.677260 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:39:48.677553 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:39:48.677816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m01:39:48.679431 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:39:48.679604 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:39:48.679742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:48.683863 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:39:48.684022 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:39:48.684182 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:39:48.688118 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m01:39:48.688819 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:39:48.689119 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:39:48.692221 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:48.692434 [debug] [MainThread]: On master: BEGIN
[0m01:39:48.692682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:48.697032 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:39:48.697192 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:48.697386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:39:48.722854 [debug] [MainThread]: SQL status: SELECT 10 in 0.025 seconds
[0m01:39:48.724312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191cd570>]}
[0m01:39:48.724551 [debug] [MainThread]: On master: ROLLBACK
[0m01:39:48.724862 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:48.725006 [debug] [MainThread]: On master: BEGIN
[0m01:39:48.725378 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:39:48.725525 [debug] [MainThread]: On master: COMMIT
[0m01:39:48.725661 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:48.725802 [debug] [MainThread]: On master: COMMIT
[0m01:39:48.726078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:39:48.726221 [debug] [MainThread]: On master: Close
[0m01:39:48.727323 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_customers
[0m01:39:48.727638 [info ] [Thread-1 (]: 1 of 9 START sql view model oltp.stg_customers ................................. [RUN]
[0m01:39:48.727907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.stg_customers)
[0m01:39:48.728104 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_customers
[0m01:39:48.732853 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_customers"
[0m01:39:48.733536 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_customers
[0m01:39:48.753289 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_customers"
[0m01:39:48.753831 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.754026 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: BEGIN
[0m01:39:48.754194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.761176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:39:48.761382 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.761564 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */

  create view "RetailSales"."oltp"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH customers_source AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        gender,
        birthdate,
        email,
        signup_date
    FROM "RetailSales"."oltp"."customers"
)

SELECT
    customer_id,
    first_name,
    last_name,
    gender,
    birthdate,
    email,
    signup_date
FROM customers_source
  );
[0m01:39:48.765131 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:39:48.768705 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.768906 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."oltp"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:39:48.769585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.771282 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.771469 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
alter table "RetailSales"."oltp"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:39:48.771908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.780226 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:39:48.780431 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.780604 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: COMMIT
[0m01:39:48.781353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:48.784531 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_customers__dbt_backup"
[0m01:39:48.787503 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_customers"
[0m01:39:48.787765 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_customers"} */
drop view if exists "RetailSales"."oltp"."stg_customers__dbt_backup" cascade
[0m01:39:48.789268 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:39:48.790617 [debug] [Thread-1 (]: On model.retail_warehouse.stg_customers: Close
[0m01:39:48.791761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119348d10>]}
[0m01:39:48.792131 [info ] [Thread-1 (]: 1 of 9 OK created sql view model oltp.stg_customers ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m01:39:48.792473 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_customers
[0m01:39:48.792688 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_products
[0m01:39:48.793003 [info ] [Thread-1 (]: 2 of 9 START sql view model oltp.stg_products .................................. [RUN]
[0m01:39:48.793330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_customers, now model.retail_warehouse.stg_products)
[0m01:39:48.793516 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_products
[0m01:39:48.795048 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_products"
[0m01:39:48.795419 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_products
[0m01:39:48.799284 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_products"
[0m01:39:48.799759 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.800165 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: BEGIN
[0m01:39:48.800406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.806931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:39:48.807172 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.807368 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */

  create view "RetailSales"."oltp"."stg_products__dbt_tmp"
    
    
  as (
    

WITH products_source AS (
  SELECT
      product_id,
      product_name,
      brand,
      subcategory,
      category,
      department,
      package_type,
      fat_content,
      diet_type,
      current_price
  FROM "RetailSales"."oltp"."products"
)

SELECT
    product_id,
    product_name,
    brand,
    subcategory,
    category,
    department,
    package_type,
    fat_content,
    diet_type,
    current_price
FROM products_source
  );
[0m01:39:48.810897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:39:48.812756 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.812953 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."oltp"."stg_products" rename to "stg_products__dbt_backup"
[0m01:39:48.813570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.814888 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.815066 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
alter table "RetailSales"."oltp"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:39:48.815671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.816297 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:39:48.816480 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.816651 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: COMMIT
[0m01:39:48.817567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:48.847504 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_products__dbt_backup"
[0m01:39:48.847896 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_products"
[0m01:39:48.848102 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_products"} */
drop view if exists "RetailSales"."oltp"."stg_products__dbt_backup" cascade
[0m01:39:48.850652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:39:48.851477 [debug] [Thread-1 (]: On model.retail_warehouse.stg_products: Close
[0m01:39:48.851808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186333e0>]}
[0m01:39:48.852169 [info ] [Thread-1 (]: 2 of 9 OK created sql view model oltp.stg_products ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m01:39:48.852492 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_products
[0m01:39:48.852698 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_promotions
[0m01:39:48.852998 [info ] [Thread-1 (]: 3 of 9 START sql view model oltp.stg_promotions ................................ [RUN]
[0m01:39:48.853328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_products, now model.retail_warehouse.stg_promotions)
[0m01:39:48.853575 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_promotions
[0m01:39:48.855237 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_promotions"
[0m01:39:48.855748 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_promotions
[0m01:39:48.857574 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_promotions"
[0m01:39:48.857937 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.858112 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: BEGIN
[0m01:39:48.858282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.863163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:39:48.863405 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.863601 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */

  create view "RetailSales"."oltp"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH promotions_source AS (
    SELECT
        promotion_id,
        promotion_name,
        media_type,
        start_date,
        end_date,
        discount_pct
    FROM "RetailSales"."oltp"."promotions"
)

SELECT
    promotion_id,
    promotion_name,
    media_type,
    start_date,
    end_date,
    discount_pct
FROM promotions_source
  );
[0m01:39:48.866283 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:39:48.868327 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.868548 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."oltp"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m01:39:48.869141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.870779 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.870967 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
alter table "RetailSales"."oltp"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m01:39:48.871442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.872073 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:39:48.872253 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.872428 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: COMMIT
[0m01:39:48.873147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:48.874224 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_promotions__dbt_backup"
[0m01:39:48.874514 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_promotions"
[0m01:39:48.874691 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_promotions"} */
drop view if exists "RetailSales"."oltp"."stg_promotions__dbt_backup" cascade
[0m01:39:48.876072 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:39:48.876932 [debug] [Thread-1 (]: On model.retail_warehouse.stg_promotions: Close
[0m01:39:48.877274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e4550>]}
[0m01:39:48.877632 [info ] [Thread-1 (]: 3 of 9 OK created sql view model oltp.stg_promotions ........................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:39:48.877940 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_promotions
[0m01:39:48.878157 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_sales
[0m01:39:48.878450 [info ] [Thread-1 (]: 4 of 9 START sql view model oltp.stg_sales ..................................... [RUN]
[0m01:39:48.878754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_promotions, now model.retail_warehouse.stg_sales)
[0m01:39:48.878941 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_sales
[0m01:39:48.880796 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_sales"
[0m01:39:48.881231 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_sales
[0m01:39:48.882745 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_sales"
[0m01:39:48.883089 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.883264 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: BEGIN
[0m01:39:48.883445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.886836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:39:48.887039 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.887301 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */

  create view "RetailSales"."oltp"."stg_sales__dbt_tmp"
    
    
  as (
    

WITH sales_source AS (
  SELECT
    transaction_id,
    transaction_date,
    product_id,
    store_id,
    promotion_id,
    customer_id,
    quantity,
    unit_price,
    total_amount
  FROM "RetailSales"."oltp"."sales"
)
SELECT
*
from sales_source
  );
[0m01:39:48.891633 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:39:48.894050 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.894272 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."oltp"."stg_sales" rename to "stg_sales__dbt_backup"
[0m01:39:48.895012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:39:48.896431 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.896617 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
alter table "RetailSales"."oltp"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m01:39:48.897109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.897758 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:39:48.897931 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.898084 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: COMMIT
[0m01:39:48.898642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:39:48.899668 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_sales__dbt_backup"
[0m01:39:48.899926 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_sales"
[0m01:39:48.900093 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_sales"} */
drop view if exists "RetailSales"."oltp"."stg_sales__dbt_backup" cascade
[0m01:39:48.901621 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:39:48.902482 [debug] [Thread-1 (]: On model.retail_warehouse.stg_sales: Close
[0m01:39:48.902764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ab050>]}
[0m01:39:48.903080 [info ] [Thread-1 (]: 4 of 9 OK created sql view model oltp.stg_sales ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:39:48.903373 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_sales
[0m01:39:48.903576 [debug] [Thread-1 (]: Began running node model.retail_warehouse.stg_stores
[0m01:39:48.903840 [info ] [Thread-1 (]: 5 of 9 START sql view model oltp.stg_stores .................................... [RUN]
[0m01:39:48.904081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_sales, now model.retail_warehouse.stg_stores)
[0m01:39:48.904255 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.stg_stores
[0m01:39:48.905792 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.stg_stores"
[0m01:39:48.906192 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.stg_stores
[0m01:39:48.907711 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.stg_stores"
[0m01:39:48.908325 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.908494 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: BEGIN
[0m01:39:48.908650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.913810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:39:48.914075 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.914268 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */

  create view "RetailSales"."oltp"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH stores_source AS (
  SELECT
    store_id,
    store_name,
    district,
    region,
    open_date,
    remodel_date,
    store_type
  FROM "RetailSales"."oltp"."stores"
)

SELECT
  store_id,
  store_name,
  district,
  region,
  open_date,
  remodel_date,
  store_type
FROM stores_source
  );
[0m01:39:48.918206 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:39:48.919838 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.920033 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."oltp"."stg_stores" rename to "stg_stores__dbt_backup"
[0m01:39:48.920661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.921946 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.922124 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
alter table "RetailSales"."oltp"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m01:39:48.922630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.923259 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:39:48.923436 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.923594 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: COMMIT
[0m01:39:48.924327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:48.925706 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."oltp"."stg_stores__dbt_backup"
[0m01:39:48.926054 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.stg_stores"
[0m01:39:48.926239 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.stg_stores"} */
drop view if exists "RetailSales"."oltp"."stg_stores__dbt_backup" cascade
[0m01:39:48.927765 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:39:48.928463 [debug] [Thread-1 (]: On model.retail_warehouse.stg_stores: Close
[0m01:39:48.928758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193c99b0>]}
[0m01:39:48.929088 [info ] [Thread-1 (]: 5 of 9 OK created sql view model oltp.stg_stores ............................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:39:48.929391 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.stg_stores
[0m01:39:48.929588 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_customers
[0m01:39:48.929890 [info ] [Thread-1 (]: 6 of 9 START sql table model dw.dim_customers .................................. [RUN]
[0m01:39:48.930184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.stg_stores, now model.retail_warehouse.dim_customers)
[0m01:39:48.930378 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_customers
[0m01:39:48.931910 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_customers"
[0m01:39:48.932308 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_customers
[0m01:39:48.944549 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_customers"
[0m01:39:48.945015 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.945195 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: BEGIN
[0m01:39:48.945395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.950873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:39:48.951158 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.951373 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */

  
    

  create  table "RetailSales"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_customers_sk_seq') as customer_sk
    ,customer_id
    ,first_name
    ,last_name
    ,gender
    ,birthdate
    ,email
    ,signup_date
from "RetailSales"."oltp"."stg_customers"
  );
  
[0m01:39:48.957231 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.006 seconds
[0m01:39:48.960982 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.961190 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:39:48.961732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.963342 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.963523 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
alter table "RetailSales"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:39:48.964079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:48.964705 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:39:48.964879 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.965034 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: COMMIT
[0m01:39:48.965916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:48.966948 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_customers__dbt_backup"
[0m01:39:48.968575 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_customers"
[0m01:39:48.968767 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_customers"} */
drop table if exists "RetailSales"."dw"."dim_customers__dbt_backup" cascade
[0m01:39:48.971683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:39:48.972331 [debug] [Thread-1 (]: On model.retail_warehouse.dim_customers: Close
[0m01:39:48.972627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c7ad0>]}
[0m01:39:48.972946 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.04s]
[0m01:39:48.973244 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_customers
[0m01:39:48.973441 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m01:39:48.973718 [info ] [Thread-1 (]: 7 of 9 START sql table model dw.dim_products ................................... [RUN]
[0m01:39:48.973979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_customers, now model.retail_warehouse.dim_products)
[0m01:39:48.974159 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m01:39:48.975858 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m01:39:48.976410 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m01:39:48.977880 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m01:39:48.978214 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:48.978374 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m01:39:48.978531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:48.982469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:39:48.982689 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:48.982869 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."oltp"."stg_products"
  );
  
[0m01:39:48.989784 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.007 seconds
[0m01:39:48.991723 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:48.991916 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products" rename to "dim_products__dbt_backup"
[0m01:39:48.992617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:39:48.993982 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:48.994165 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:39:48.995010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:39:48.995635 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:39:48.995822 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:48.995997 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m01:39:48.996827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:49.000033 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_products__dbt_backup"
[0m01:39:49.000326 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m01:39:49.000501 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw"."dim_products__dbt_backup" cascade
[0m01:39:49.003373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:39:49.004026 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m01:39:49.004310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c6c90>]}
[0m01:39:49.004627 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dw.dim_products .............................. [[32mSELECT 50[0m in 0.03s]
[0m01:39:49.004917 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m01:39:49.005105 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m01:39:49.005384 [info ] [Thread-1 (]: 8 of 9 START sql table model dw.dim_promotions ................................. [RUN]
[0m01:39:49.005655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m01:39:49.005834 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m01:39:49.007319 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m01:39:49.007747 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m01:39:49.009271 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m01:39:49.009613 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.009780 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m01:39:49.009942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:49.013641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:39:49.013832 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.014011 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_promotions_sk_seq') as promotion_sk,
     promotion_id,
     promotion_name,
     media_type,
     discount_pct,
     start_date,
     end_date
from "RetailSales"."oltp"."stg_promotions"
  );
  
[0m01:39:49.020191 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.006 seconds
[0m01:39:49.021775 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.021971 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m01:39:49.022512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:49.023857 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.024045 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m01:39:49.025008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:39:49.025650 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:39:49.025923 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.026134 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m01:39:49.026950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:49.028494 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m01:39:49.028789 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m01:39:49.028971 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m01:39:49.031320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:39:49.032021 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m01:39:49.032338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f51c10>]}
[0m01:39:49.032671 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 15[0m in 0.03s]
[0m01:39:49.032970 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m01:39:49.033167 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m01:39:49.033444 [info ] [Thread-1 (]: 9 of 9 START sql table model dw.dim_stores ..................................... [RUN]
[0m01:39:49.033714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m01:39:49.033893 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m01:39:49.035404 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m01:39:49.035804 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m01:39:49.037603 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m01:39:49.037924 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.038090 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m01:39:49.038249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:49.043130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:39:49.043305 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.043482 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."oltp"."stg_stores"
  );
  
[0m01:39:49.050343 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m01:39:49.052123 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.052305 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores" rename to "dim_stores__dbt_backup"
[0m01:39:49.052856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:39:49.054337 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.054523 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m01:39:49.055932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:39:49.056578 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:39:49.056765 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.056924 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m01:39:49.057808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:39:49.058880 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_stores__dbt_backup"
[0m01:39:49.059238 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m01:39:49.059477 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw"."dim_stores__dbt_backup" cascade
[0m01:39:49.061206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:39:49.061932 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m01:39:49.062241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf18f10-19f8-4781-868a-558d56deb5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c63f0>]}
[0m01:39:49.062580 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dw.dim_stores ................................ [[32mSELECT 10[0m in 0.03s]
[0m01:39:49.062888 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m01:39:49.063596 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:49.063755 [debug] [MainThread]: On master: BEGIN
[0m01:39:49.063894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:49.067876 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:39:49.068083 [debug] [MainThread]: On master: COMMIT
[0m01:39:49.068250 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:49.068393 [debug] [MainThread]: On master: COMMIT
[0m01:39:49.068632 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:39:49.068777 [debug] [MainThread]: On master: Close
[0m01:39:49.068973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:49.069121 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_stores' was properly closed.
[0m01:39:49.069365 [info ] [MainThread]: 
[0m01:39:49.069552 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m01:39:49.070390 [debug] [MainThread]: Command end result
[0m01:39:49.087811 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:39:49.088956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:39:49.092647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:39:49.092840 [info ] [MainThread]: 
[0m01:39:49.093043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:49.093200 [info ] [MainThread]: 
[0m01:39:49.093373 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:39:49.095566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.95080817, "process_in_blocks": "0", "process_kernel_time": 0.227954, "process_mem_max_rss": "131072000", "process_out_blocks": "0", "process_user_time": 1.308303}
[0m01:39:49.095817 [debug] [MainThread]: Command `dbt run` succeeded at 01:39:49.095767 after 0.95 seconds
[0m01:39:49.096015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10393a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119353a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193539b0>]}
[0m01:39:49.096213 [debug] [MainThread]: Flushing usage events
[0m01:39:49.608006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:29.600265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f59e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0c3ed0>]}


============================== 01:46:29.604179 | 40609ae1-1508-4ad3-8e2f-25099e8eb4f0 ==============================
[0m01:46:29.604179 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:46:29.604595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_date', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:46:29.707006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119421ba0>]}
[0m01:46:29.736697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a171ae0>]}
[0m01:46:29.737450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:46:29.794726 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:46:29.883217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:29.883506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:29.886767 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.retail_warehouse.marts.intermediate
- models.retail_warehouse.marts.core.facts
[0m01:46:29.910082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a17e050>]}
[0m01:46:29.962640 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:46:29.971519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:46:29.986070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1835c0>]}
[0m01:46:29.986359 [info ] [MainThread]: Found 10 models, 14 data tests, 5 sources, 572 macros
[0m01:46:29.986558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c56db70>]}
[0m01:46:29.987567 [info ] [MainThread]: 
[0m01:46:29.987777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:29.987922 [info ] [MainThread]: 
[0m01:46:29.988202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:29.988696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:46:30.024678 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:46:30.024968 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:46:30.025149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:30.050299 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m01:46:30.051238 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:46:30.054061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:46:30.057381 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:46:30.057653 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:46:30.057848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:30.062362 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:46:30.062626 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:46:30.062795 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:46:30.067037 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m01:46:30.067881 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:46:30.068170 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:46:30.068470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m01:46:30.070449 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:46:30.070628 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:46:30.070769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:30.074318 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:46:30.074539 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:46:30.074715 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:46:30.078415 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m01:46:30.079290 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:46:30.079677 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:46:30.083093 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.083285 [debug] [MainThread]: On master: BEGIN
[0m01:46:30.083432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:30.088042 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:46:30.088202 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.088424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:46:30.118104 [debug] [MainThread]: SQL status: SELECT 10 in 0.029 seconds
[0m01:46:30.119835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c79de60>]}
[0m01:46:30.120134 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:30.120444 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.120602 [debug] [MainThread]: On master: BEGIN
[0m01:46:30.120971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:46:30.121135 [debug] [MainThread]: On master: COMMIT
[0m01:46:30.121276 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.121416 [debug] [MainThread]: On master: COMMIT
[0m01:46:30.121665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:46:30.121807 [debug] [MainThread]: On master: Close
[0m01:46:30.122585 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_date
[0m01:46:30.122892 [info ] [Thread-1 (]: 1 of 1 START sql table model dw.dim_date ....................................... [RUN]
[0m01:46:30.123173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_date)
[0m01:46:30.123382 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_date
[0m01:46:30.128253 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_date"
[0m01:46:30.129889 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_date
[0m01:46:30.152018 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_date"
[0m01:46:30.152716 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:46:30.152917 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: BEGIN
[0m01:46:30.153089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:30.157213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:46:30.157414 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:46:30.157627 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */

  
    

  create  table "RetailSales"."dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with dates as (

    -- ⇣  Adjust the start & end dates as needed
    select
        generate_series(
            '2020-01-01'::date,
            '2030-12-31'::date,
            interval '1 day'
        )::date as date_day

)

select
    -- Surrogate key as an integer (YYYYMMDD) — easy to create, no sequence needed
    (extract(year  from date_day) * 10000
     + extract(month from date_day) * 100
     + extract(day   from date_day))::int      as date_sk,

    date_day                                     as full_date,
    extract(year   from date_day)::int           as year,
    extract(quarter from date_day)::int          as quarter,
    extract(month  from date_day)::int           as month,
    to_char(date_day,'Month')                    as month_name,
    extract(day    from date_day)::int           as day_of_month,
    extract(doy    from date_day)::int           as day_of_year,
    extract(week   from date_day)::int           as week_of_year,
    extract(dow    from date_day)::int           as weekday_iso,
    to_char(date_day,'Day')                      as weekday_name,
    case when extract(isodow from date_day) in (6,7) then true else false end
                                                as is_weekend
from dates
  );
  
[0m01:46:30.187353 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.029 seconds
[0m01:46:30.192788 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:46:30.193030 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m01:46:30.193987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:46:30.201465 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m01:46:30.201666 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:46:30.201835 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m01:46:30.203103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:46:30.206478 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_date__dbt_backup"
[0m01:46:30.208953 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:46:30.209169 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
drop table if exists "RetailSales"."dw"."dim_date__dbt_backup" cascade
[0m01:46:30.209570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:46:30.211165 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: Close
[0m01:46:30.212567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40609ae1-1508-4ad3-8e2f-25099e8eb4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e1a4f50>]}
[0m01:46:30.212959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw.dim_date .................................. [[32mSELECT 4018[0m in 0.09s]
[0m01:46:30.213306 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_date
[0m01:46:30.214230 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.214445 [debug] [MainThread]: On master: BEGIN
[0m01:46:30.214615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:30.218201 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:46:30.218431 [debug] [MainThread]: On master: COMMIT
[0m01:46:30.218608 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:30.218762 [debug] [MainThread]: On master: COMMIT
[0m01:46:30.219053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:46:30.219387 [debug] [MainThread]: On master: Close
[0m01:46:30.219714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:30.219880 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_date' was properly closed.
[0m01:46:30.220050 [info ] [MainThread]: 
[0m01:46:30.220229 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m01:46:30.220591 [debug] [MainThread]: Command end result
[0m01:46:30.276553 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:46:30.278073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:46:30.281731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:46:30.281925 [info ] [MainThread]: 
[0m01:46:30.282151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:46:30.282307 [info ] [MainThread]: 
[0m01:46:30.282489 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:46:30.284680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7262311, "process_in_blocks": "0", "process_kernel_time": 0.206284, "process_mem_max_rss": "128106496", "process_out_blocks": "0", "process_user_time": 1.166532}
[0m01:46:30.284979 [debug] [MainThread]: Command `dbt run` succeeded at 01:46:30.284922 after 0.73 seconds
[0m01:46:30.285200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c52e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a70ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a70ce10>]}
[0m01:46:30.285411 [debug] [MainThread]: Flushing usage events
[0m01:46:30.477423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:03.944049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c3ed0>]}


============================== 01:51:03.947373 | ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e ==============================
[0m01:51:03.947373 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:51:03.947743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_date', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:51:04.053653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107321ba0>]}
[0m01:51:04.086304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111371ae0>]}
[0m01:51:04.087150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:51:04.147230 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:51:04.235483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:04.235801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:04.239122 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m01:51:04.262308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137e050>]}
[0m01:51:04.319730 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:04.328301 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:04.343642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113835c0>]}
[0m01:51:04.343944 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m01:51:04.344149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b590f0>]}
[0m01:51:04.345199 [info ] [MainThread]: 
[0m01:51:04.345400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:04.345547 [info ] [MainThread]: 
[0m01:51:04.345822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:04.346332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:51:04.381438 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:51:04.381729 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:51:04.381911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:04.401604 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m01:51:04.402384 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:51:04.405324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m01:51:04.408517 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:04.408709 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:51:04.408862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:04.413977 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:51:04.414165 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:04.414328 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:51:04.419732 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m01:51:04.420720 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:51:04.421197 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:51:04.421581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m01:51:04.423657 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:04.423841 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:51:04.423986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:04.429067 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:51:04.429303 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:04.429490 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:51:04.432604 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m01:51:04.433373 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:51:04.433690 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:51:04.437063 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.437267 [debug] [MainThread]: On master: BEGIN
[0m01:51:04.437422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:04.441087 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:51:04.441261 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.441456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:04.468914 [debug] [MainThread]: SQL status: SELECT 10 in 0.027 seconds
[0m01:51:04.470489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f7eb60>]}
[0m01:51:04.470742 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:04.471064 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.471209 [debug] [MainThread]: On master: BEGIN
[0m01:51:04.471569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:51:04.471719 [debug] [MainThread]: On master: COMMIT
[0m01:51:04.471859 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.471991 [debug] [MainThread]: On master: COMMIT
[0m01:51:04.472235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:04.472381 [debug] [MainThread]: On master: Close
[0m01:51:04.473144 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_date
[0m01:51:04.473519 [info ] [Thread-1 (]: 1 of 1 START sql table model dw.dim_date ....................................... [RUN]
[0m01:51:04.473848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_date)
[0m01:51:04.474096 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_date
[0m01:51:04.478689 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_date"
[0m01:51:04.479152 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_date
[0m01:51:04.501213 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_date"
[0m01:51:04.501784 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.501992 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: BEGIN
[0m01:51:04.502176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:04.506059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:51:04.506304 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.506526 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */

  
    

  create  table "RetailSales"."dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with dates as (

    -- ⇣  Adjust the start & end dates as needed
    select
        generate_series(
            '2020-01-01'::date,
            '2030-12-31'::date,
            interval '1 day'
        )::date as date_day

)

select
    -- Surrogate key as an integer (YYYYMMDD) — easy to create, no sequence needed
    (extract(year  from date_day) * 10000
     + extract(month from date_day) * 100
     + extract(day   from date_day))::int      as date_sk,

    date_day                                     as full_date,
    extract(year   from date_day)::int           as year,
    extract(quarter from date_day)::int          as quarter,
    extract(month  from date_day)::int           as month,
    to_char(date_day,'Month')                    as month_name,
    extract(day    from date_day)::int           as day_of_month,
    extract(doy    from date_day)::int           as day_of_year,
    extract(week   from date_day)::int           as week_of_year,
    extract(dow    from date_day)::int           as weekday_iso,
    to_char(date_day,'Day')                      as weekday_name,
    case when extract(isodow from date_day) in (6,7) then true else false end
                                                as is_weekend
from dates
  );
  
[0m01:51:04.530110 [debug] [Thread-1 (]: SQL status: SELECT 4018 in 0.023 seconds
[0m01:51:04.535824 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.536062 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date" rename to "dim_date__dbt_backup"
[0m01:51:04.536531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:51:04.537934 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.538127 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m01:51:04.538896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:51:04.549368 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m01:51:04.549609 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.549787 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m01:51:04.550558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:51:04.553636 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_date__dbt_backup"
[0m01:51:04.556063 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m01:51:04.556263 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
drop table if exists "RetailSales"."dw"."dim_date__dbt_backup" cascade
[0m01:51:04.558801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:51:04.560143 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: Close
[0m01:51:04.561249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbae2f6-1cdc-4e6b-b505-2ad4aaad355e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140d9250>]}
[0m01:51:04.561606 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw.dim_date .................................. [[32mSELECT 4018[0m in 0.09s]
[0m01:51:04.561925 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_date
[0m01:51:04.562612 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.562775 [debug] [MainThread]: On master: BEGIN
[0m01:51:04.562911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:04.566405 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:51:04.566564 [debug] [MainThread]: On master: COMMIT
[0m01:51:04.566705 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:04.566836 [debug] [MainThread]: On master: COMMIT
[0m01:51:04.567055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:04.567200 [debug] [MainThread]: On master: Close
[0m01:51:04.567387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:04.567522 [debug] [MainThread]: Connection 'model.retail_warehouse.dim_date' was properly closed.
[0m01:51:04.567674 [info ] [MainThread]: 
[0m01:51:04.567846 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m01:51:04.568421 [debug] [MainThread]: Command end result
[0m01:51:04.623953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:04.625200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:04.628984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:51:04.629240 [info ] [MainThread]: 
[0m01:51:04.629497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:04.629659 [info ] [MainThread]: 
[0m01:51:04.629844 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:51:04.633351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7314527, "process_in_blocks": "0", "process_kernel_time": 0.212421, "process_mem_max_rss": "129941504", "process_out_blocks": "0", "process_user_time": 1.183656}
[0m01:51:04.633679 [debug] [MainThread]: Command `dbt run` succeeded at 01:51:04.633616 after 0.73 seconds
[0m01:51:04.633926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c79bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd3110>]}
[0m01:51:04.634149 [debug] [MainThread]: Flushing usage events
[0m01:51:04.829789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:13.989099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f09e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c3ed0>]}


============================== 01:51:13.991864 | 61cc0e25-61e6-4166-ba5b-dc65d75a9d1e ==============================
[0m01:51:13.991864 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:51:13.992263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_sales', 'send_anonymous_usage_stats': 'True'}
[0m01:51:14.084187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106621ba0>]}
[0m01:51:14.113522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107571ae0>]}
[0m01:51:14.114025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:51:14.167592 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:51:14.243379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:14.243649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:14.246749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m01:51:14.270078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757e050>]}
[0m01:51:14.327965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:14.333454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:14.342729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075835c0>]}
[0m01:51:14.343028 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m01:51:14.343241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11897d0f0>]}
[0m01:51:14.344307 [info ] [MainThread]: 
[0m01:51:14.344521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:14.344673 [info ] [MainThread]: 
[0m01:51:14.344947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:14.345460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m01:51:14.377027 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m01:51:14.377325 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m01:51:14.377521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:14.395628 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m01:51:14.396492 [debug] [ThreadPool]: On list_RetailSales: Close
[0m01:51:14.399341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_oltp)
[0m01:51:14.402810 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:14.403038 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:51:14.403204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:14.406540 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:51:14.406747 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:14.406920 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:51:14.409432 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m01:51:14.410211 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:51:14.410512 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:51:14.410786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m01:51:14.413004 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:14.413218 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:51:14.413378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:14.416634 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:51:14.416877 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:14.417072 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:51:14.420513 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m01:51:14.421451 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:51:14.421899 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:51:14.425334 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.425524 [debug] [MainThread]: On master: BEGIN
[0m01:51:14.425664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:14.429880 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:51:14.430033 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.430238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:14.461860 [debug] [MainThread]: SQL status: SELECT 10 in 0.031 seconds
[0m01:51:14.463374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e72c30>]}
[0m01:51:14.463619 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:14.463923 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.464074 [debug] [MainThread]: On master: BEGIN
[0m01:51:14.464455 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:51:14.464603 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.464743 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.464876 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.465119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:14.465260 [debug] [MainThread]: On master: Close
[0m01:51:14.465972 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_sales
[0m01:51:14.466254 [info ] [Thread-1 (]: 1 of 1 START sql table model dw.fct_sales ...................................... [RUN]
[0m01:51:14.466493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.fct_sales)
[0m01:51:14.466677 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_sales
[0m01:51:14.471798 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_sales"
[0m01:51:14.473269 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_sales
[0m01:51:14.494192 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_sales"
[0m01:51:14.494846 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m01:51:14.495041 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: BEGIN
[0m01:51:14.495209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:14.499347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:51:14.499560 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m01:51:14.499770 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */

  
    

  create  table "RetailSales"."dw"."fct_sales__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select * from "RetailSales"."oltp"."stg_sales"

), dimmed as (

    select
        -- surrogate keys from dimensions
        d.date_sk         as date_sk,
        c.customer_sk     as customer_sk,
        p.product_sk      as product_sk,
        s.store_sk        as store_sk,
        pr.promotion_sk   as promotion_sk,

        -- numeric facts
        src.quantity,
        src.unit_price,
        src.quantity * src.unit_price as sales_amount
    from src
    left join "RetailSales"."dw"."dim_date"      d  on d.full_date     = src.transaction_date
    left join "RetailSales"."dw"."dim_customers" c  on c.customer_id   = src.customer_id
    left join "RetailSales"."dw"."dim_products"  p  on p.product_id    = src.product_id
    left join "RetailSales"."dw"."dim_stores"    s  on s.store_id      = src.store_id
    left join "RetailSales"."dw"."dim_promotions"pr on pr.promotion_id = src.promotion_id
)

select * from dimmed
  );
  
[0m01:51:14.914695 [debug] [Thread-1 (]: SQL status: SELECT 131500 in 0.415 seconds
[0m01:51:14.926759 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m01:51:14.927222 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
alter table "RetailSales"."dw"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m01:51:14.928313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:51:14.942770 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m01:51:14.943284 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m01:51:14.943504 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m01:51:14.950734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m01:51:14.956621 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."fct_sales__dbt_backup"
[0m01:51:14.959284 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m01:51:14.959510 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
drop table if exists "RetailSales"."dw"."fct_sales__dbt_backup" cascade
[0m01:51:14.959934 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:51:14.961310 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: Close
[0m01:51:14.962517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cc0e25-61e6-4166-ba5b-dc65d75a9d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fd9010>]}
[0m01:51:14.962874 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw.fct_sales ................................. [[32mSELECT 131500[0m in 0.50s]
[0m01:51:14.963196 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_sales
[0m01:51:14.963955 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.964186 [debug] [MainThread]: On master: BEGIN
[0m01:51:14.964355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:14.967513 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:51:14.967747 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.967926 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.968077 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.968334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:14.968487 [debug] [MainThread]: On master: Close
[0m01:51:14.968701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:14.968843 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_sales' was properly closed.
[0m01:51:14.969000 [info ] [MainThread]: 
[0m01:51:14.969164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m01:51:14.969652 [debug] [MainThread]: Command end result
[0m01:51:15.023254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:15.024564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:15.027984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:51:15.028209 [info ] [MainThread]: 
[0m01:51:15.028460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:15.028626 [info ] [MainThread]: 
[0m01:51:15.028802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:51:15.030901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0783402, "process_in_blocks": "0", "process_kernel_time": 0.178796, "process_mem_max_rss": "132399104", "process_out_blocks": "0", "process_user_time": 1.171988}
[0m01:51:15.031167 [debug] [MainThread]: Command `dbt run` succeeded at 01:51:15.031112 after 1.08 seconds
[0m01:51:15.031374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a79bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a875770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a875810>]}
[0m01:51:15.031572 [debug] [MainThread]: Flushing usage events
[0m01:51:15.186651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:26.980119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104969e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3ed0>]}


============================== 01:51:26.982994 | e8ca0404-1ca2-4a7f-8e1e-a899ae7441de ==============================
[0m01:51:26.982994 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:51:26.983398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select fct_sales', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:51:27.076994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f21ba0>]}
[0m01:51:27.106849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d71ae0>]}
[0m01:51:27.107413 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:51:27.166489 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:51:27.255043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:27.255321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:27.258675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m01:51:27.281758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7e050>]}
[0m01:51:27.337256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:27.344757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:27.364188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d68a0>]}
[0m01:51:27.364503 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m01:51:27.364714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dedd0>]}
[0m01:51:27.365969 [info ] [MainThread]: 
[0m01:51:27.366182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:27.366341 [info ] [MainThread]: 
[0m01:51:27.366624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:27.369050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales_dw'
[0m01:51:27.403986 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:27.404275 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:51:27.404459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:27.426844 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m01:51:27.427288 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:27.427484 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:51:27.434482 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m01:51:27.435409 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:51:27.435758 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:51:27.436069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m01:51:27.437850 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:27.438039 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:51:27.438184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:27.442306 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:51:27.442524 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:27.442702 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:51:27.446948 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m01:51:27.447677 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:51:27.447988 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:51:27.451320 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.451827 [debug] [MainThread]: On master: BEGIN
[0m01:51:27.451984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:27.456739 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:51:27.457009 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.457245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:27.485991 [debug] [MainThread]: SQL status: SELECT 10 in 0.028 seconds
[0m01:51:27.487925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8ca0404-1ca2-4a7f-8e1e-a899ae7441de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784e9c0>]}
[0m01:51:27.488219 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:27.488573 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.488731 [debug] [MainThread]: On master: BEGIN
[0m01:51:27.489111 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:51:27.489265 [debug] [MainThread]: On master: COMMIT
[0m01:51:27.489403 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.489537 [debug] [MainThread]: On master: COMMIT
[0m01:51:27.489792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:27.489942 [debug] [MainThread]: On master: Close
[0m01:51:27.490805 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:27.491042 [info ] [Thread-1 (]: 1 of 9 START test not_null_fct_sales_customer_sk ............................... [RUN]
[0m01:51:27.491283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f)
[0m01:51:27.491472 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:27.501799 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:27.502638 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:27.514655 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:27.515379 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:27.515590 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: BEGIN
[0m01:51:27.515762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.520384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:51:27.520679 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:27.520886 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from "RetailSales"."dw"."fct_sales"
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.535808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m01:51:27.538426 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: ROLLBACK
[0m01:51:27.538815 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: Close
[0m01:51:27.539170 [info ] [Thread-1 (]: 1 of 9 PASS not_null_fct_sales_customer_sk ..................................... [[32mPASS[0m in 0.05s]
[0m01:51:27.539499 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:27.539708 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:27.539982 [info ] [Thread-1 (]: 2 of 9 START test not_null_fct_sales_date_sk ................................... [RUN]
[0m01:51:27.540293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f, now test.retail_warehouse.not_null_fct_sales_date_sk.4657127926)
[0m01:51:27.540503 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:27.542732 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:27.543196 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:27.580912 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:27.581641 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:27.581860 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: BEGIN
[0m01:51:27.582043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.587152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:51:27.587356 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:27.587546 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "RetailSales"."dw"."fct_sales"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.607026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m01:51:27.608031 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: ROLLBACK
[0m01:51:27.608405 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: Close
[0m01:51:27.608762 [error] [Thread-1 (]: 2 of 9 FAIL 131500 not_null_fct_sales_date_sk .................................. [[31mFAIL 131500[0m in 0.07s]
[0m01:51:27.609099 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:27.609310 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:27.609574 [info ] [Thread-1 (]: 3 of 9 START test not_null_fct_sales_product_sk ................................ [RUN]
[0m01:51:27.609855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_date_sk.4657127926, now test.retail_warehouse.not_null_fct_sales_product_sk.351c981452)
[0m01:51:27.610050 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:27.612355 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:27.612877 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:27.614659 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:27.615306 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:27.615520 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: BEGIN
[0m01:51:27.615693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.619979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:51:27.620216 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:27.620411 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "RetailSales"."dw"."fct_sales"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.634015 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:51:27.635116 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: ROLLBACK
[0m01:51:27.635652 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: Close
[0m01:51:27.636233 [info ] [Thread-1 (]: 3 of 9 PASS not_null_fct_sales_product_sk ...................................... [[32mPASS[0m in 0.03s]
[0m01:51:27.636608 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:27.636846 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:27.637125 [info ] [Thread-1 (]: 4 of 9 START test not_null_fct_sales_store_sk .................................. [RUN]
[0m01:51:27.637499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_product_sk.351c981452, now test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330)
[0m01:51:27.637717 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:27.640081 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:27.640603 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:27.641962 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:27.642356 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:27.642538 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: BEGIN
[0m01:51:27.642711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.651254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:51:27.651587 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:27.651924 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "RetailSales"."dw"."fct_sales"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.662809 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:51:27.663957 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: ROLLBACK
[0m01:51:27.664344 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: Close
[0m01:51:27.664734 [info ] [Thread-1 (]: 4 of 9 PASS not_null_fct_sales_store_sk ........................................ [[32mPASS[0m in 0.03s]
[0m01:51:27.665051 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:27.665278 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:27.665621 [info ] [Thread-1 (]: 5 of 9 START test relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [RUN]
[0m01:51:27.665946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330, now test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c)
[0m01:51:27.666157 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:27.670604 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:27.671053 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:27.672461 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:27.672840 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:27.673035 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: BEGIN
[0m01:51:27.673218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.678001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:51:27.678300 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:27.678516 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from "RetailSales"."dw"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.693093 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:51:27.694048 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: ROLLBACK
[0m01:51:27.694464 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: Close
[0m01:51:27.695042 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m01:51:27.695495 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:27.695747 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:27.696022 [info ] [Thread-1 (]: 6 of 9 START test relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ...... [RUN]
[0m01:51:27.696363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c, now test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338)
[0m01:51:27.696574 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:27.699659 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:27.700166 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:27.701304 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:27.701898 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:27.702106 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: BEGIN
[0m01:51:27.702279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.705632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:27.705881 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:27.706094 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where date_sk is not null
),

parent as (
    select date_sk as to_field
    from "RetailSales"."dw"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.713080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:51:27.714356 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: ROLLBACK
[0m01:51:27.714716 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: Close
[0m01:51:27.715061 [info ] [Thread-1 (]: 6 of 9 PASS relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ............ [[32mPASS[0m in 0.02s]
[0m01:51:27.715367 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:27.715580 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:27.715776 [info ] [Thread-1 (]: 7 of 9 START test relationships_fct_sales_product_sk__product_sk__ref_dim_products_  [RUN]
[0m01:51:27.716051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338, now test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3)
[0m01:51:27.716285 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:27.719285 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:27.719758 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:27.720913 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:27.721393 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:27.721585 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: BEGIN
[0m01:51:27.721760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.724835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:27.725063 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:27.725256 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from "RetailSales"."dw"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.738205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:51:27.739173 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: ROLLBACK
[0m01:51:27.739544 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: Close
[0m01:51:27.739970 [info ] [Thread-1 (]: 7 of 9 PASS relationships_fct_sales_product_sk__product_sk__ref_dim_products_ .. [[32mPASS[0m in 0.02s]
[0m01:51:27.740333 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:27.740561 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:27.740799 [info ] [Thread-1 (]: 8 of 9 START test relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [RUN]
[0m01:51:27.741057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3, now test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07)
[0m01:51:27.741254 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:27.744913 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:27.745360 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:27.746498 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:27.746876 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:27.747064 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: BEGIN
[0m01:51:27.747231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.750145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:27.750388 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:27.750587 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select promotion_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where promotion_sk is not null
),

parent as (
    select promotion_sk as to_field
    from "RetailSales"."dw"."dim_promotions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.762395 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:51:27.763594 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: ROLLBACK
[0m01:51:27.764041 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: Close
[0m01:51:27.764510 [info ] [Thread-1 (]: 8 of 9 PASS relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [[32mPASS[0m in 0.02s]
[0m01:51:27.764918 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:27.765177 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:27.765594 [info ] [Thread-1 (]: 9 of 9 START test relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ .. [RUN]
[0m01:51:27.765872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07, now test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf)
[0m01:51:27.766088 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:27.769304 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:27.769781 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:27.770883 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:27.771290 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:27.771470 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: BEGIN
[0m01:51:27.771636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:27.774803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:27.775073 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:27.775287 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where store_sk is not null
),

parent as (
    select store_sk as to_field
    from "RetailSales"."dw"."dim_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:27.787853 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:51:27.788865 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: ROLLBACK
[0m01:51:27.789237 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: Close
[0m01:51:27.789602 [info ] [Thread-1 (]: 9 of 9 PASS relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ ........ [[32mPASS[0m in 0.02s]
[0m01:51:27.790026 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:27.790821 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.791003 [debug] [MainThread]: On master: BEGIN
[0m01:51:27.791203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:27.794489 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:51:27.794730 [debug] [MainThread]: On master: COMMIT
[0m01:51:27.794887 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:27.795027 [debug] [MainThread]: On master: COMMIT
[0m01:51:27.795278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:27.795428 [debug] [MainThread]: On master: Close
[0m01:51:27.795651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:27.795798 [debug] [MainThread]: Connection 'test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf' was properly closed.
[0m01:51:27.795975 [info ] [MainThread]: 
[0m01:51:27.796154 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:51:27.797106 [debug] [MainThread]: Command end result
[0m01:51:27.816308 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:27.817567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:27.821797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:51:27.822022 [info ] [MainThread]: 
[0m01:51:27.822217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:51:27.822372 [info ] [MainThread]: 
[0m01:51:27.822567 [error] [MainThread]: [31mFailure in test not_null_fct_sales_date_sk (models/marts/core/facts/schema.yml)[0m
[0m01:51:27.822743 [error] [MainThread]:   Got 131500 results, configured to fail if != 0
[0m01:51:27.822879 [info ] [MainThread]: 
[0m01:51:27.823045 [info ] [MainThread]:   compiled code at target/compiled/retail_warehouse/models/marts/core/facts/schema.yml/not_null_fct_sales_date_sk.sql
[0m01:51:27.823192 [info ] [MainThread]: 
[0m01:51:27.823354 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m01:51:27.825590 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.88267136, "process_in_blocks": "0", "process_kernel_time": 0.191787, "process_mem_max_rss": "132251648", "process_out_blocks": "0", "process_user_time": 1.216415}
[0m01:51:27.825978 [debug] [MainThread]: Command `dbt test` failed at 01:51:27.825916 after 0.88 seconds
[0m01:51:27.826223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d6e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d6db0>]}
[0m01:51:27.826445 [debug] [MainThread]: Flushing usage events
[0m01:51:27.983414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:56.060858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac3ed0>]}


============================== 01:51:56.064517 | 3feb58d9-df74-4881-b29e-574952ef20e3 ==============================
[0m01:51:56.064517 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:51:56.064901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select fct_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:51:56.157379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c45ba0>]}
[0m01:51:56.186319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059279b0>]}
[0m01:51:56.187813 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:51:56.244888 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:51:56.332960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:56.333244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:56.336435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m01:51:56.358097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b81f50>]}
[0m01:51:56.410876 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:56.418171 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:56.437052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071de3f0>]}
[0m01:51:56.437353 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m01:51:56.437550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d6cf0>]}
[0m01:51:56.438721 [info ] [MainThread]: 
[0m01:51:56.438922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:56.439061 [info ] [MainThread]: 
[0m01:51:56.439319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:56.441725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales_oltp'
[0m01:51:56.475114 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:56.475384 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m01:51:56.475558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:56.496522 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m01:51:56.496768 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m01:51:56.496955 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m01:51:56.503641 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m01:51:56.504493 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m01:51:56.504895 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m01:51:56.505192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m01:51:56.506934 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:56.507095 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m01:51:56.507225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:56.511511 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:51:56.511657 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m01:51:56.511801 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m01:51:56.514661 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m01:51:56.515324 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m01:51:56.515580 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m01:51:56.519685 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.520294 [debug] [MainThread]: On master: BEGIN
[0m01:51:56.520456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:56.524936 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:51:56.525153 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.525365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:56.552620 [debug] [MainThread]: SQL status: SELECT 10 in 0.027 seconds
[0m01:51:56.554160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3feb58d9-df74-4881-b29e-574952ef20e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107546b60>]}
[0m01:51:56.554403 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:56.554714 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.554849 [debug] [MainThread]: On master: BEGIN
[0m01:51:56.555224 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:51:56.555361 [debug] [MainThread]: On master: COMMIT
[0m01:51:56.555486 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.555608 [debug] [MainThread]: On master: COMMIT
[0m01:51:56.555856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:56.555993 [debug] [MainThread]: On master: Close
[0m01:51:56.557124 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:56.557347 [info ] [Thread-1 (]: 1 of 9 START test not_null_fct_sales_customer_sk ............................... [RUN]
[0m01:51:56.557574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f)
[0m01:51:56.557746 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:56.566662 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:56.567157 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:56.578298 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:56.578803 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:56.578986 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: BEGIN
[0m01:51:56.579147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.584536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:51:56.584750 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m01:51:56.584921 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from "RetailSales"."dw"."fct_sales"
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.595354 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m01:51:56.597868 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: ROLLBACK
[0m01:51:56.598209 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: Close
[0m01:51:56.598544 [info ] [Thread-1 (]: 1 of 9 PASS not_null_fct_sales_customer_sk ..................................... [[32mPASS[0m in 0.04s]
[0m01:51:56.598838 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m01:51:56.599039 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:56.599300 [info ] [Thread-1 (]: 2 of 9 START test not_null_fct_sales_date_sk ................................... [RUN]
[0m01:51:56.599608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f, now test.retail_warehouse.not_null_fct_sales_date_sk.4657127926)
[0m01:51:56.599806 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:56.602128 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:56.602582 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:56.636041 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:56.636592 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:56.636777 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: BEGIN
[0m01:51:56.636938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.641364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:51:56.641571 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m01:51:56.641753 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "RetailSales"."dw"."fct_sales"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.661606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m01:51:56.662571 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: ROLLBACK
[0m01:51:56.662917 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: Close
[0m01:51:56.663251 [error] [Thread-1 (]: 2 of 9 FAIL 131500 not_null_fct_sales_date_sk .................................. [[31mFAIL 131500[0m in 0.06s]
[0m01:51:56.663554 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m01:51:56.663753 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:56.664003 [info ] [Thread-1 (]: 3 of 9 START test not_null_fct_sales_product_sk ................................ [RUN]
[0m01:51:56.664297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_date_sk.4657127926, now test.retail_warehouse.not_null_fct_sales_product_sk.351c981452)
[0m01:51:56.664496 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:56.666694 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:56.667145 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:56.668488 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:56.668828 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:56.669008 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: BEGIN
[0m01:51:56.669174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.673302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:51:56.673485 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m01:51:56.673673 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "RetailSales"."dw"."fct_sales"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.685337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:51:56.686170 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: ROLLBACK
[0m01:51:56.686466 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: Close
[0m01:51:56.686768 [info ] [Thread-1 (]: 3 of 9 PASS not_null_fct_sales_product_sk ...................................... [[32mPASS[0m in 0.02s]
[0m01:51:56.687047 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m01:51:56.687239 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:56.687453 [info ] [Thread-1 (]: 4 of 9 START test not_null_fct_sales_store_sk .................................. [RUN]
[0m01:51:56.687683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_product_sk.351c981452, now test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330)
[0m01:51:56.687866 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:56.689814 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:56.690185 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:56.691629 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:56.692070 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:56.692274 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: BEGIN
[0m01:51:56.692444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.695372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.695548 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m01:51:56.695719 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "RetailSales"."dw"."fct_sales"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.703548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m01:51:56.704408 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: ROLLBACK
[0m01:51:56.704735 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: Close
[0m01:51:56.705054 [info ] [Thread-1 (]: 4 of 9 PASS not_null_fct_sales_store_sk ........................................ [[32mPASS[0m in 0.02s]
[0m01:51:56.705335 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m01:51:56.705566 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:56.705745 [info ] [Thread-1 (]: 5 of 9 START test relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [RUN]
[0m01:51:56.706033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330, now test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c)
[0m01:51:56.706245 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:56.710791 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:56.711250 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:56.712633 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:56.713029 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:56.713211 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: BEGIN
[0m01:51:56.713387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.716648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.716849 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m01:51:56.717041 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from "RetailSales"."dw"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.731392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:51:56.732306 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: ROLLBACK
[0m01:51:56.732619 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: Close
[0m01:51:56.732953 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m01:51:56.733245 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m01:51:56.733445 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:56.733673 [info ] [Thread-1 (]: 6 of 9 START test relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ...... [RUN]
[0m01:51:56.733911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c, now test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338)
[0m01:51:56.734096 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:56.737277 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:56.737739 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:56.738840 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:56.739188 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:56.739372 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: BEGIN
[0m01:51:56.739536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.742812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.743006 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m01:51:56.743186 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where date_sk is not null
),

parent as (
    select date_sk as to_field
    from "RetailSales"."dw"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.749780 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:51:56.751060 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: ROLLBACK
[0m01:51:56.751410 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: Close
[0m01:51:56.751774 [info ] [Thread-1 (]: 6 of 9 PASS relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ............ [[32mPASS[0m in 0.02s]
[0m01:51:56.752067 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m01:51:56.752265 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:56.752447 [info ] [Thread-1 (]: 7 of 9 START test relationships_fct_sales_product_sk__product_sk__ref_dim_products_  [RUN]
[0m01:51:56.752681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338, now test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3)
[0m01:51:56.752861 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:56.755819 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:56.756209 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:56.757294 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:56.757638 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:56.757807 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: BEGIN
[0m01:51:56.757962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.761058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.761270 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m01:51:56.761462 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from "RetailSales"."dw"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.774622 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:51:56.775485 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: ROLLBACK
[0m01:51:56.775783 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: Close
[0m01:51:56.776104 [info ] [Thread-1 (]: 7 of 9 PASS relationships_fct_sales_product_sk__product_sk__ref_dim_products_ .. [[32mPASS[0m in 0.02s]
[0m01:51:56.776380 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m01:51:56.776580 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:56.776831 [info ] [Thread-1 (]: 8 of 9 START test relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [RUN]
[0m01:51:56.777108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3, now test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07)
[0m01:51:56.777303 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:56.780625 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:56.781068 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:56.782123 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:56.782455 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:56.782626 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: BEGIN
[0m01:51:56.782785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.785565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.785768 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m01:51:56.785960 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select promotion_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where promotion_sk is not null
),

parent as (
    select promotion_sk as to_field
    from "RetailSales"."dw"."dim_promotions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.797270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:51:56.798205 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: ROLLBACK
[0m01:51:56.798519 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: Close
[0m01:51:56.798897 [info ] [Thread-1 (]: 8 of 9 PASS relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [[32mPASS[0m in 0.02s]
[0m01:51:56.799202 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m01:51:56.799406 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:56.799629 [info ] [Thread-1 (]: 9 of 9 START test relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ .. [RUN]
[0m01:51:56.799858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07, now test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf)
[0m01:51:56.800044 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:56.803034 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:56.803439 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:56.804525 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:56.804855 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:56.805018 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: BEGIN
[0m01:51:56.805172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:56.807984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m01:51:56.808171 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m01:51:56.808350 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where store_sk is not null
),

parent as (
    select store_sk as to_field
    from "RetailSales"."dw"."dim_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:56.820386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:51:56.821166 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: ROLLBACK
[0m01:51:56.821412 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: Close
[0m01:51:56.821713 [info ] [Thread-1 (]: 9 of 9 PASS relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ ........ [[32mPASS[0m in 0.02s]
[0m01:51:56.821994 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m01:51:56.822700 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.822866 [debug] [MainThread]: On master: BEGIN
[0m01:51:56.823000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:56.825360 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:51:56.825576 [debug] [MainThread]: On master: COMMIT
[0m01:51:56.825740 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:56.825880 [debug] [MainThread]: On master: COMMIT
[0m01:51:56.826069 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:56.826207 [debug] [MainThread]: On master: Close
[0m01:51:56.826410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:56.826542 [debug] [MainThread]: Connection 'test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf' was properly closed.
[0m01:51:56.826693 [info ] [MainThread]: 
[0m01:51:56.826862 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m01:51:56.827752 [debug] [MainThread]: Command end result
[0m01:51:56.846357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m01:51:56.847466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m01:51:56.851350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m01:51:56.851512 [info ] [MainThread]: 
[0m01:51:56.851696 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:51:56.851837 [info ] [MainThread]: 
[0m01:51:56.852018 [error] [MainThread]: [31mFailure in test not_null_fct_sales_date_sk (models/marts/core/facts/schema.yml)[0m
[0m01:51:56.852189 [error] [MainThread]:   Got 131500 results, configured to fail if != 0
[0m01:51:56.852319 [info ] [MainThread]: 
[0m01:51:56.852474 [info ] [MainThread]:   compiled code at target/compiled/retail_warehouse/models/marts/core/facts/schema.yml/not_null_fct_sales_date_sk.sql
[0m01:51:56.852616 [info ] [MainThread]: 
[0m01:51:56.852770 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m01:51:56.854772 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8350864, "process_in_blocks": "0", "process_kernel_time": 0.210944, "process_mem_max_rss": "132546560", "process_out_blocks": "0", "process_user_time": 1.205551}
[0m01:51:56.855004 [debug] [MainThread]: Command `dbt test` failed at 01:51:56.854958 after 0.84 seconds
[0m01:51:56.855200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105999c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d6d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d6c50>]}
[0m01:51:56.855386 [debug] [MainThread]: Flushing usage events
[0m01:51:57.015711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:41.839477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d7ed0>]}


============================== 02:01:41.842855 | 976e154d-38f1-4af4-81fa-e06b1b2caf83 ==============================
[0m02:01:41.842855 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:01:41.843259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_date fct_sales # rebuild dim + fact', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:41.942544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35ba0>]}
[0m02:01:41.971457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663b9b0>]}
[0m02:01:41.972172 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:01:42.028877 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:01:42.119115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:42.119376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:42.122661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:01:42.144697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106891f50>]}
[0m02:01:42.199573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:01:42.207062 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:01:42.221789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068df110>]}
[0m02:01:42.222085 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m02:01:42.222277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1470>]}
[0m02:01:42.222978 [warn ] [MainThread]: The selection criterion '#' does not match any enabled nodes
[0m02:01:42.223270 [warn ] [MainThread]: The selection criterion 'rebuild' does not match any enabled nodes
[0m02:01:42.223513 [warn ] [MainThread]: The selection criterion 'dim' does not match any enabled nodes
[0m02:01:42.223756 [warn ] [MainThread]: The selection criterion '+' does not match any enabled nodes
[0m02:01:42.224003 [warn ] [MainThread]: The selection criterion 'fact' does not match any enabled nodes
[0m02:01:42.224805 [info ] [MainThread]: 
[0m02:01:42.224995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:42.225131 [info ] [MainThread]: 
[0m02:01:42.225403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:01:42.227512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m02:01:42.261585 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m02:01:42.261830 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m02:01:42.261995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:42.285625 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.024 seconds
[0m02:01:42.286507 [debug] [ThreadPool]: On list_RetailSales: Close
[0m02:01:42.287587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m02:01:42.290825 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:01:42.291011 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:01:42.291156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:42.295935 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m02:01:42.296086 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:01:42.296233 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:01:42.299492 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m02:01:42.300232 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:01:42.300523 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:01:42.300789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m02:01:42.303109 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:01:42.303417 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:01:42.303595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:42.314042 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:01:42.314341 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:01:42.314542 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:01:42.318430 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m02:01:42.319313 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:01:42.319642 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:01:42.323158 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.323368 [debug] [MainThread]: On master: BEGIN
[0m02:01:42.323521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:42.328615 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m02:01:42.328787 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.328996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:01:42.360737 [debug] [MainThread]: SQL status: SELECT 10 in 0.032 seconds
[0m02:01:42.362259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107932ea0>]}
[0m02:01:42.362503 [debug] [MainThread]: On master: ROLLBACK
[0m02:01:42.362799 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.362940 [debug] [MainThread]: On master: BEGIN
[0m02:01:42.363320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:01:42.363458 [debug] [MainThread]: On master: COMMIT
[0m02:01:42.363587 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.363711 [debug] [MainThread]: On master: COMMIT
[0m02:01:42.363962 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:42.364100 [debug] [MainThread]: On master: Close
[0m02:01:42.365154 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_date
[0m02:01:42.365433 [info ] [Thread-1 (]: 1 of 2 START sql table model dw.dim_date ....................................... [RUN]
[0m02:01:42.365661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_date)
[0m02:01:42.365843 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_date
[0m02:01:42.369998 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_date"
[0m02:01:42.371677 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_date
[0m02:01:42.392039 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_date"
[0m02:01:42.392462 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.392642 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: BEGIN
[0m02:01:42.392804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:42.396997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:01:42.397174 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.397377 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */

  
    

  create  table "RetailSales"."dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with calendar as (
    select
        generate_series('2015-01-01'::date, '2035-12-31'::date, interval '1 day')::date as date_day
), base as (
    select
        (extract(year from date_day)*10000
         + extract(month from date_day)*100
         + extract(day   from date_day))::int      as date_sk,
        date_day                                    as full_date,
        extract(year from date_day)::int            as year,
        extract(quarter from date_day)::int         as quarter,
        extract(month from date_day)::int           as month,
        to_char(date_day,'Month')                   as month_name,
        extract(day from date_day)::int             as day_of_month,
        extract(doy from date_day)::int             as day_of_year,
        extract(week from date_day)::int            as week_of_year,
        extract(isodow from date_day)::int          as weekday_iso,
        to_char(date_day,'Day')                     as weekday_name,
        case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
    from calendar
), unknown as (
    /* the Kimball unknown row */
    select
        0                    as date_sk,
        '1900-01-01'::date   as full_date,
        1900                 as year,
        0                    as quarter,
        0                    as month,
        'Unknown'            as month_name,
        0  as day_of_month,
        0  as day_of_year,
        0  as week_of_year,
        0  as weekday_iso,
        'Unknown'            as weekday_name,
        false as is_weekend
)

select * from base
union all
select * from unknown
  );
  
[0m02:01:42.434445 [debug] [Thread-1 (]: SQL status: SELECT 7671 in 0.037 seconds
[0m02:01:42.439614 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.439803 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date" rename to "dim_date__dbt_backup"
[0m02:01:42.440342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:01:42.441732 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.441902 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m02:01:42.442364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:01:42.452710 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m02:01:42.452928 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.453099 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m02:01:42.453967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:01:42.456982 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_date__dbt_backup"
[0m02:01:42.459412 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m02:01:42.459599 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
drop table if exists "RetailSales"."dw"."dim_date__dbt_backup" cascade
[0m02:01:42.462114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:01:42.463422 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: Close
[0m02:01:42.464808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacf50>]}
[0m02:01:42.465163 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw.dim_date .................................. [[32mSELECT 7671[0m in 0.10s]
[0m02:01:42.465479 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_date
[0m02:01:42.465863 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_sales
[0m02:01:42.466200 [info ] [Thread-1 (]: 2 of 2 START sql table model dw.fct_sales ...................................... [RUN]
[0m02:01:42.466478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_date, now model.retail_warehouse.fct_sales)
[0m02:01:42.466654 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_sales
[0m02:01:42.500396 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_sales"
[0m02:01:42.501247 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_sales
[0m02:01:42.503249 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_sales"
[0m02:01:42.503666 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.503847 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: BEGIN
[0m02:01:42.504010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:42.508545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:01:42.508780 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.508993 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */

  
    

  create  table "RetailSales"."dw"."fct_sales__dbt_tmp"
  
  
    as
  
  (
    select
    coalesce(d.date_sk, 0)       as date_sk,
    coalesce(c.customer_sk, 0)   as customer_sk,
    coalesce(p.product_sk, 0)    as product_sk,
    coalesce(s.store_sk, 0)      as store_sk,
    coalesce(pr.promotion_sk, 0) as promotion_sk,
    src.quantity,
    src.unit_price,
    src.quantity * src.unit_price as sales_amount
from "RetailSales"."oltp"."stg_sales" src
left join "RetailSales"."dw"."dim_date"      d  on d.full_date   = src.transaction_date::date
left join "RetailSales"."dw"."dim_customers" c  on c.customer_id = src.customer_id
left join "RetailSales"."dw"."dim_products"  p  on p.product_id  = src.product_id
left join "RetailSales"."dw"."dim_stores"    s  on s.store_id    = src.store_id
left join "RetailSales"."dw"."dim_promotions"pr on pr.promotion_id = src.promotion_id
  );
  
[0m02:01:42.930723 [debug] [Thread-1 (]: SQL status: SELECT 132000 in 0.421 seconds
[0m02:01:42.937583 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.938057 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
alter table "RetailSales"."dw"."fct_sales" rename to "fct_sales__dbt_backup"
[0m02:01:42.938987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:01:42.942120 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.942526 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
alter table "RetailSales"."dw"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m02:01:42.943528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:01:42.944449 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m02:01:42.944769 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.945044 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m02:01:42.955604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m02:01:42.959369 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."fct_sales__dbt_backup"
[0m02:01:42.960016 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:01:42.960355 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
drop table if exists "RetailSales"."dw"."fct_sales__dbt_backup" cascade
[0m02:01:42.963427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:01:42.964504 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: Close
[0m02:01:42.965023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976e154d-38f1-4af4-81fa-e06b1b2caf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773b750>]}
[0m02:01:42.965419 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dw.fct_sales ................................. [[32mSELECT 132000[0m in 0.50s]
[0m02:01:42.965770 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_sales
[0m02:01:42.966629 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.966798 [debug] [MainThread]: On master: BEGIN
[0m02:01:42.966937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:42.970642 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:01:42.970835 [debug] [MainThread]: On master: COMMIT
[0m02:01:42.970977 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:42.971107 [debug] [MainThread]: On master: COMMIT
[0m02:01:42.971379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:42.971516 [debug] [MainThread]: On master: Close
[0m02:01:42.971712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:42.971847 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_sales' was properly closed.
[0m02:01:42.972029 [info ] [MainThread]: 
[0m02:01:42.972238 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m02:01:42.972724 [debug] [MainThread]: Command end result
[0m02:01:42.992899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:01:42.993909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:01:42.997421 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:01:42.997590 [info ] [MainThread]: 
[0m02:01:42.997776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:42.997915 [info ] [MainThread]: 
[0m02:01:42.998076 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:01:43.000115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.204954, "process_in_blocks": "0", "process_kernel_time": 0.210042, "process_mem_max_rss": "129564672", "process_out_blocks": "0", "process_user_time": 1.188239}
[0m02:01:43.000394 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:43.000345 after 1.21 seconds
[0m02:01:43.000585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d84870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a49010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c7d50>]}
[0m02:01:43.000774 [debug] [MainThread]: Flushing usage events
[0m02:01:43.208005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:44.165384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f97c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f97ed0>]}


============================== 02:01:44.167965 | 96fec123-2d4e-403e-ba91-6efe6c208634 ==============================
[0m02:01:44.167965 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:01:44.168336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select fct_sales # all tests should pass', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:44.256914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f5ba0>]}
[0m02:01:44.285705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfb9b0>]}
[0m02:01:44.286196 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:01:44.338286 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:01:44.410093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:44.410327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:44.413475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:01:44.436126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107055f50>]}
[0m02:01:44.491577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:01:44.498650 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:01:44.517710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f623f0>]}
[0m02:01:44.518084 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m02:01:44.518283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5acf0>]}
[0m02:01:44.518920 [warn ] [MainThread]: The selection criterion '#' does not match any enabled nodes
[0m02:01:44.519201 [warn ] [MainThread]: The selection criterion 'all' does not match any enabled nodes
[0m02:01:44.519448 [warn ] [MainThread]: The selection criterion 'tests' does not match any enabled nodes
[0m02:01:44.519691 [warn ] [MainThread]: The selection criterion 'should' does not match any enabled nodes
[0m02:01:44.519930 [warn ] [MainThread]: The selection criterion 'pass' does not match any enabled nodes
[0m02:01:44.520926 [info ] [MainThread]: 
[0m02:01:44.521158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:44.521322 [info ] [MainThread]: 
[0m02:01:44.521613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:01:44.524290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales_oltp'
[0m02:01:44.550502 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:01:44.550751 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:01:44.550915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:44.565186 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m02:01:44.565505 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:01:44.565682 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:01:44.570625 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m02:01:44.571515 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:01:44.571805 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:01:44.572093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m02:01:44.573886 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:01:44.574044 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:01:44.574173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:44.577799 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:01:44.578164 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:01:44.578376 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:01:44.582523 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m02:01:44.583522 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:01:44.583870 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:01:44.587505 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.588073 [debug] [MainThread]: On master: BEGIN
[0m02:01:44.588228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:44.594616 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m02:01:44.594841 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.595059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:01:44.624166 [debug] [MainThread]: SQL status: SELECT 10 in 0.029 seconds
[0m02:01:44.625938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fec123-2d4e-403e-ba91-6efe6c208634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c6b60>]}
[0m02:01:44.626208 [debug] [MainThread]: On master: ROLLBACK
[0m02:01:44.626496 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.626636 [debug] [MainThread]: On master: BEGIN
[0m02:01:44.626969 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:01:44.627104 [debug] [MainThread]: On master: COMMIT
[0m02:01:44.627230 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.627354 [debug] [MainThread]: On master: COMMIT
[0m02:01:44.627575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:44.627704 [debug] [MainThread]: On master: Close
[0m02:01:44.628493 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:01:44.628755 [info ] [Thread-1 (]: 1 of 9 START test not_null_fct_sales_customer_sk ............................... [RUN]
[0m02:01:44.629008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f)
[0m02:01:44.629193 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:01:44.638276 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:01:44.639026 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:01:44.650766 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:01:44.651440 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:01:44.651686 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: BEGIN
[0m02:01:44.651875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.655744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:01:44.655957 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:01:44.656145 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from "RetailSales"."dw"."fct_sales"
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.671586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m02:01:44.674350 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: ROLLBACK
[0m02:01:44.674787 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: Close
[0m02:01:44.675226 [info ] [Thread-1 (]: 1 of 9 PASS not_null_fct_sales_customer_sk ..................................... [[32mPASS[0m in 0.05s]
[0m02:01:44.675553 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:01:44.675764 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:01:44.675947 [info ] [Thread-1 (]: 2 of 9 START test not_null_fct_sales_date_sk ................................... [RUN]
[0m02:01:44.676268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f, now test.retail_warehouse.not_null_fct_sales_date_sk.4657127926)
[0m02:01:44.676547 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:01:44.678796 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:01:44.679214 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:01:44.712238 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:01:44.712795 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:01:44.712986 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: BEGIN
[0m02:01:44.713161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.717166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:01:44.717483 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:01:44.717706 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "RetailSales"."dw"."fct_sales"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.733127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m02:01:44.734187 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: ROLLBACK
[0m02:01:44.734591 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: Close
[0m02:01:44.735052 [info ] [Thread-1 (]: 2 of 9 PASS not_null_fct_sales_date_sk ......................................... [[32mPASS[0m in 0.06s]
[0m02:01:44.735370 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:01:44.735575 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:01:44.735785 [info ] [Thread-1 (]: 3 of 9 START test not_null_fct_sales_product_sk ................................ [RUN]
[0m02:01:44.735991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_date_sk.4657127926, now test.retail_warehouse.not_null_fct_sales_product_sk.351c981452)
[0m02:01:44.736172 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:01:44.738433 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:01:44.738885 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:01:44.740372 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:01:44.740751 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:01:44.740942 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: BEGIN
[0m02:01:44.741114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.744473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.744670 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:01:44.744858 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "RetailSales"."dw"."fct_sales"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.757747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m02:01:44.758615 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: ROLLBACK
[0m02:01:44.758962 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: Close
[0m02:01:44.759348 [info ] [Thread-1 (]: 3 of 9 PASS not_null_fct_sales_product_sk ...................................... [[32mPASS[0m in 0.02s]
[0m02:01:44.759661 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:01:44.759866 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:01:44.760065 [info ] [Thread-1 (]: 4 of 9 START test not_null_fct_sales_store_sk .................................. [RUN]
[0m02:01:44.760269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_product_sk.351c981452, now test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330)
[0m02:01:44.760443 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:01:44.762706 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:01:44.763136 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:01:44.764645 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:01:44.765175 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:01:44.765392 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: BEGIN
[0m02:01:44.765561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.768524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.768721 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:01:44.768896 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "RetailSales"."dw"."fct_sales"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.781878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m02:01:44.782941 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: ROLLBACK
[0m02:01:44.783286 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: Close
[0m02:01:44.783627 [info ] [Thread-1 (]: 4 of 9 PASS not_null_fct_sales_store_sk ........................................ [[32mPASS[0m in 0.02s]
[0m02:01:44.783927 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:01:44.784132 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:01:44.784344 [info ] [Thread-1 (]: 5 of 9 START test relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [RUN]
[0m02:01:44.784555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330, now test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c)
[0m02:01:44.784744 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:01:44.789358 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:01:44.789775 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:01:44.791367 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:01:44.791785 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:01:44.791989 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: BEGIN
[0m02:01:44.792165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.795182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.795429 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:01:44.795640 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from "RetailSales"."dw"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.809078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m02:01:44.810026 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: ROLLBACK
[0m02:01:44.810354 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: Close
[0m02:01:44.810698 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m02:01:44.811001 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:01:44.811207 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:01:44.811425 [info ] [Thread-1 (]: 6 of 9 START test relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ...... [RUN]
[0m02:01:44.811682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c, now test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338)
[0m02:01:44.811916 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:01:44.814834 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:01:44.815229 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:01:44.816330 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:01:44.816680 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:01:44.816854 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: BEGIN
[0m02:01:44.817015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.819735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.819945 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:01:44.820137 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where date_sk is not null
),

parent as (
    select date_sk as to_field
    from "RetailSales"."dw"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.858835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.038 seconds
[0m02:01:44.860199 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: ROLLBACK
[0m02:01:44.860548 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: Close
[0m02:01:44.860882 [info ] [Thread-1 (]: 6 of 9 PASS relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ............ [[32mPASS[0m in 0.05s]
[0m02:01:44.861174 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:01:44.861379 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:01:44.861560 [info ] [Thread-1 (]: 7 of 9 START test relationships_fct_sales_product_sk__product_sk__ref_dim_products_  [RUN]
[0m02:01:44.861765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338, now test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3)
[0m02:01:44.861948 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:01:44.864926 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:01:44.865349 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:01:44.866415 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:01:44.866970 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:01:44.867203 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: BEGIN
[0m02:01:44.867384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.870205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.870419 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:01:44.870614 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from "RetailSales"."dw"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.883257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:01:44.884292 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: ROLLBACK
[0m02:01:44.884642 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: Close
[0m02:01:44.884986 [info ] [Thread-1 (]: 7 of 9 PASS relationships_fct_sales_product_sk__product_sk__ref_dim_products_ .. [[32mPASS[0m in 0.02s]
[0m02:01:44.885304 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:01:44.885503 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:01:44.885687 [info ] [Thread-1 (]: 8 of 9 START test relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [RUN]
[0m02:01:44.885904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3, now test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07)
[0m02:01:44.886085 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:01:44.889667 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:01:44.890238 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:01:44.891447 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:01:44.891890 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:01:44.892101 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: BEGIN
[0m02:01:44.892271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.895246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.895479 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:01:44.895681 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select promotion_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where promotion_sk is not null
),

parent as (
    select promotion_sk as to_field
    from "RetailSales"."dw"."dim_promotions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.907563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:01:44.908608 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: ROLLBACK
[0m02:01:44.908971 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: Close
[0m02:01:44.909317 [error] [Thread-1 (]: 8 of 9 FAIL 39449 relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [[31mFAIL 39449[0m in 0.02s]
[0m02:01:44.909622 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:01:44.909825 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:01:44.910044 [info ] [Thread-1 (]: 9 of 9 START test relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ .. [RUN]
[0m02:01:44.910260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07, now test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf)
[0m02:01:44.910438 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:01:44.913719 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:01:44.914145 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:01:44.915233 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:01:44.915585 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:01:44.915762 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: BEGIN
[0m02:01:44.915924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:01:44.918893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.919124 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:01:44.919327 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where store_sk is not null
),

parent as (
    select store_sk as to_field
    from "RetailSales"."dw"."dim_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:01:44.931207 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:01:44.932130 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: ROLLBACK
[0m02:01:44.932462 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: Close
[0m02:01:44.932785 [info ] [Thread-1 (]: 9 of 9 PASS relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ ........ [[32mPASS[0m in 0.02s]
[0m02:01:44.933078 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:01:44.933810 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.933974 [debug] [MainThread]: On master: BEGIN
[0m02:01:44.934107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:44.936668 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:01:44.936885 [debug] [MainThread]: On master: COMMIT
[0m02:01:44.937048 [debug] [MainThread]: Using postgres connection "master"
[0m02:01:44.937188 [debug] [MainThread]: On master: COMMIT
[0m02:01:44.937417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:01:44.937556 [debug] [MainThread]: On master: Close
[0m02:01:44.937756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:44.937894 [debug] [MainThread]: Connection 'test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf' was properly closed.
[0m02:01:44.938054 [info ] [MainThread]: 
[0m02:01:44.938252 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m02:01:44.939130 [debug] [MainThread]: Command end result
[0m02:01:44.957757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:01:44.958980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:01:44.962959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:01:44.963149 [info ] [MainThread]: 
[0m02:01:44.963339 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:01:44.963484 [info ] [MainThread]: 
[0m02:01:44.963673 [error] [MainThread]: [31mFailure in test relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_ (models/marts/core/facts/schema.yml)[0m
[0m02:01:44.963841 [error] [MainThread]:   Got 39449 results, configured to fail if != 0
[0m02:01:44.963969 [info ] [MainThread]: 
[0m02:01:44.964131 [info ] [MainThread]:   compiled code at target/compiled/retail_warehouse/models/marts/core/facts/schema.yml/relationships_fct_sales_be9772717f4f0229a6ae188b802814fc.sql
[0m02:01:44.964266 [info ] [MainThread]: 
[0m02:01:44.964416 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m02:01:44.966055 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8372253, "process_in_blocks": "0", "process_kernel_time": 0.171068, "process_mem_max_rss": "133349376", "process_out_blocks": "0", "process_user_time": 1.200263}
[0m02:01:44.966296 [debug] [MainThread]: Command `dbt test` failed at 02:01:44.966247 after 0.84 seconds
[0m02:01:44.966499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108356c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108356d00>]}
[0m02:01:44.966688 [debug] [MainThread]: Flushing usage events
[0m02:01:45.117246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:20.683289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104069e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c3ed0>]}


============================== 02:09:20.686998 | 82bd9b37-8fc2-4304-b6e2-f9fdf49914ed ==============================
[0m02:09:20.686998 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:09:20.687516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_promotions fct_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:09:20.794190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104621ba0>]}
[0m02:09:20.823198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052279b0>]}
[0m02:09:20.823939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:09:20.880605 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:09:20.969489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:20.969776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:20.972856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:09:20.994519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105481f50>]}
[0m02:09:21.048386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:09:21.055737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:09:21.073260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c7110>]}
[0m02:09:21.073568 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m02:09:21.073754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f21470>]}
[0m02:09:21.074956 [info ] [MainThread]: 
[0m02:09:21.075151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:21.075298 [info ] [MainThread]: 
[0m02:09:21.075574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:21.077683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m02:09:21.111761 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m02:09:21.112037 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m02:09:21.112202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:21.135422 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m02:09:21.136320 [debug] [ThreadPool]: On list_RetailSales: Close
[0m02:09:21.137398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m02:09:21.140660 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:09:21.140842 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:09:21.140985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:21.145640 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m02:09:21.145813 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:09:21.145966 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:09:21.149096 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m02:09:21.150055 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:09:21.150468 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:09:21.150927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m02:09:21.153135 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:09:21.153311 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:09:21.153451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:21.160885 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:09:21.161110 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:09:21.161284 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:09:21.167005 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m02:09:21.167761 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:09:21.168069 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:09:21.171306 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.171468 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.171598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:21.178423 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:09:21.178567 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.178755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:09:21.209574 [debug] [MainThread]: SQL status: SELECT 10 in 0.031 seconds
[0m02:09:21.211033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119276dd0>]}
[0m02:09:21.211259 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:21.211533 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.211671 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.212037 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:09:21.212177 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.212303 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.212423 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.212665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:21.212803 [debug] [MainThread]: On master: Close
[0m02:09:21.213715 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m02:09:21.214115 [info ] [Thread-1 (]: 1 of 2 START sql table model dw.dim_promotions ................................. [RUN]
[0m02:09:21.214366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_promotions)
[0m02:09:21.214548 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m02:09:21.218853 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m02:09:21.220108 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m02:09:21.240298 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m02:09:21.240730 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.240909 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m02:09:21.241065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.245530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:09:21.245706 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.245905 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

-- -------------------------------------------------------------------------
-- 1.  Regular promotion rows from the staging table
-- -------------------------------------------------------------------------
with base as (

    select
        nextval('dw.dim_promotions_sk_seq') as promotion_sk,   -- surrogate
        promotion_id,
        promotion_name,
        media_type,
        discount_pct,
        start_date,
        end_date
    from "RetailSales"."oltp"."stg_promotions"

),

-- -------------------------------------------------------------------------
-- 2.  Kimball “Unknown Promotion” row  (surrogate key = 0)
-- -------------------------------------------------------------------------
unknown_row as (

    select
        0                    as promotion_sk,
        'UNK'                as promotion_id,
        'Unknown Promotion'  as promotion_name,
        'N/A'                as media_type,
        0.0                  as discount_pct,
        date '1900-01-01'    as start_date,
        date '2099-12-31'    as end_date

)

-- -------------------------------------------------------------------------
-- 3.  Final output
-- -------------------------------------------------------------------------
select * from base
union all
select * from unknown_row
  );
  
[0m02:09:21.251786 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.006 seconds
[0m02:09:21.256937 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.257128 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m02:09:21.257647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:09:21.259016 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.259193 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m02:09:21.259913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:21.269911 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m02:09:21.270108 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.270275 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m02:09:21.271062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:09:21.274387 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m02:09:21.276876 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m02:09:21.277067 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m02:09:21.281328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:09:21.282650 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m02:09:21.283759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193e0f50>]}
[0m02:09:21.284171 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 16[0m in 0.07s]
[0m02:09:21.284519 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m02:09:21.284958 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_sales
[0m02:09:21.285238 [info ] [Thread-1 (]: 2 of 2 START sql table model dw.fct_sales ...................................... [RUN]
[0m02:09:21.285487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.fct_sales)
[0m02:09:21.285668 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_sales
[0m02:09:21.287803 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_sales"
[0m02:09:21.288247 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_sales
[0m02:09:21.320073 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_sales"
[0m02:09:21.320702 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.320900 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: BEGIN
[0m02:09:21.321066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.327308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:09:21.327506 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.327698 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */

  
    

  create  table "RetailSales"."dw"."fct_sales__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select * from "RetailSales"."oltp"."stg_sales"

), fact_rows as (

    select
        -- surrogate keys (coalesce to 0 for “Unknown”)
        coalesce(d.date_sk,       0) as date_sk,
        coalesce(c.customer_sk,   0) as customer_sk,
        coalesce(p.product_sk,    0) as product_sk,
        coalesce(s.store_sk,      0) as store_sk,
        coalesce(pr.promotion_sk, 0) as promotion_sk,

        -- numeric facts
        src.quantity,
        src.unit_price,
        src.quantity * src.unit_price as sales_amount

    from src
    left join "RetailSales"."dw"."dim_date"      d  on d.full_date     = src.transaction_date::date
    left join "RetailSales"."dw"."dim_customers" c  on c.customer_id   = src.customer_id
    left join "RetailSales"."dw"."dim_products"  p  on p.product_id    = src.product_id
    left join "RetailSales"."dw"."dim_stores"    s  on s.store_id      = src.store_id
    left join "RetailSales"."dw"."dim_promotions"pr on pr.promotion_id = src.promotion_id

)

select * from fact_rows
  );
  
[0m02:09:21.673361 [debug] [Thread-1 (]: SQL status: SELECT 132500 in 0.345 seconds
[0m02:09:21.680837 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.681380 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
alter table "RetailSales"."dw"."fct_sales" rename to "fct_sales__dbt_backup"
[0m02:09:21.682011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:09:21.683993 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.684309 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
alter table "RetailSales"."dw"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m02:09:21.685806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:21.686483 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m02:09:21.686657 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.686813 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: COMMIT
[0m02:09:21.687546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:09:21.688894 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."fct_sales__dbt_backup"
[0m02:09:21.689331 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_sales"
[0m02:09:21.689619 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_sales"} */
drop table if exists "RetailSales"."dw"."fct_sales__dbt_backup" cascade
[0m02:09:21.694250 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:09:21.696164 [debug] [Thread-1 (]: On model.retail_warehouse.fct_sales: Close
[0m02:09:21.696967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bd9b37-8fc2-4304-b6e2-f9fdf49914ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119079c80>]}
[0m02:09:21.697373 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dw.fct_sales ................................. [[32mSELECT 132500[0m in 0.41s]
[0m02:09:21.697740 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_sales
[0m02:09:21.698643 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.698862 [debug] [MainThread]: On master: BEGIN
[0m02:09:21.699035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:21.702293 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:09:21.702495 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.702650 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:21.702814 [debug] [MainThread]: On master: COMMIT
[0m02:09:21.703130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:21.703270 [debug] [MainThread]: On master: Close
[0m02:09:21.703473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:21.703611 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_sales' was properly closed.
[0m02:09:21.703798 [info ] [MainThread]: 
[0m02:09:21.703963 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m02:09:21.704364 [debug] [MainThread]: Command end result
[0m02:09:21.725345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:09:21.726450 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:09:21.730068 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:09:21.730218 [info ] [MainThread]: 
[0m02:09:21.730394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:21.730537 [info ] [MainThread]: 
[0m02:09:21.730701 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:09:21.732811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0930918, "process_in_blocks": "0", "process_kernel_time": 0.20818, "process_mem_max_rss": "128679936", "process_out_blocks": "0", "process_user_time": 1.179404}
[0m02:09:21.733055 [debug] [MainThread]: Command `dbt run` succeeded at 02:09:21.733009 after 1.09 seconds
[0m02:09:21.733276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119377250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054590d0>]}
[0m02:09:21.733454 [debug] [MainThread]: Flushing usage events
[0m02:09:21.939692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:32.234173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e69e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c3ed0>]}


============================== 02:09:32.236598 | 1a8a1efb-b804-49c4-8fea-42ff093d94f6 ==============================
[0m02:09:32.236598 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:09:32.236962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select fct_sales', 'send_anonymous_usage_stats': 'True'}
[0m02:09:32.325455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111325ba0>]}
[0m02:09:32.354228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127279b0>]}
[0m02:09:32.354699 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:09:32.405975 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:09:32.478669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:32.478912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:32.482011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:09:32.503639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112981f50>]}
[0m02:09:32.556067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:09:32.561017 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:09:32.576927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139de3f0>]}
[0m02:09:32.577183 [info ] [MainThread]: Found 11 models, 23 data tests, 5 sources, 572 macros
[0m02:09:32.577363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d6cf0>]}
[0m02:09:32.578551 [info ] [MainThread]: 
[0m02:09:32.578745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:32.578882 [info ] [MainThread]: 
[0m02:09:32.579142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:32.581546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales_oltp'
[0m02:09:32.610873 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:09:32.611106 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:09:32.611266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:32.628348 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m02:09:32.628615 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:09:32.628790 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:09:32.635272 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m02:09:32.636116 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:09:32.636485 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:09:32.636783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m02:09:32.638528 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:09:32.638703 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:09:32.638839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:32.643867 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m02:09:32.644019 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:09:32.644167 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:09:32.648194 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m02:09:32.649043 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:09:32.649666 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:09:32.653959 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.654594 [debug] [MainThread]: On master: BEGIN
[0m02:09:32.654765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:32.661005 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m02:09:32.661264 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.661504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:09:32.688985 [debug] [MainThread]: SQL status: SELECT 10 in 0.027 seconds
[0m02:09:32.690760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a8a1efb-b804-49c4-8fea-42ff093d94f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4ab60>]}
[0m02:09:32.691029 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:32.691345 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.691492 [debug] [MainThread]: On master: BEGIN
[0m02:09:32.691884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:09:32.692024 [debug] [MainThread]: On master: COMMIT
[0m02:09:32.692167 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.692303 [debug] [MainThread]: On master: COMMIT
[0m02:09:32.692547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:32.692686 [debug] [MainThread]: On master: Close
[0m02:09:32.693989 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:09:32.694258 [info ] [Thread-1 (]: 1 of 9 START test not_null_fct_sales_customer_sk ............................... [RUN]
[0m02:09:32.694528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f)
[0m02:09:32.694721 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:09:32.703844 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:09:32.705226 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:09:32.716191 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:09:32.716636 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:09:32.716820 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: BEGIN
[0m02:09:32.716982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.721279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:09:32.721513 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"
[0m02:09:32.721718 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from "RetailSales"."dw"."fct_sales"
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.736812 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m02:09:32.739316 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: ROLLBACK
[0m02:09:32.739672 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f: Close
[0m02:09:32.740004 [info ] [Thread-1 (]: 1 of 9 PASS not_null_fct_sales_customer_sk ..................................... [[32mPASS[0m in 0.05s]
[0m02:09:32.740302 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f
[0m02:09:32.740505 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:09:32.740747 [info ] [Thread-1 (]: 2 of 9 START test not_null_fct_sales_date_sk ................................... [RUN]
[0m02:09:32.741036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_customer_sk.0433bc391f, now test.retail_warehouse.not_null_fct_sales_date_sk.4657127926)
[0m02:09:32.741228 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:09:32.743499 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:09:32.743966 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:09:32.774678 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:09:32.775208 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:09:32.775395 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: BEGIN
[0m02:09:32.775555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.779318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:09:32.779503 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"
[0m02:09:32.779679 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_date_sk.4657127926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "RetailSales"."dw"."fct_sales"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.793724 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m02:09:32.794649 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: ROLLBACK
[0m02:09:32.794995 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_date_sk.4657127926: Close
[0m02:09:32.795317 [info ] [Thread-1 (]: 2 of 9 PASS not_null_fct_sales_date_sk ......................................... [[32mPASS[0m in 0.05s]
[0m02:09:32.795609 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_date_sk.4657127926
[0m02:09:32.795809 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:09:32.796041 [info ] [Thread-1 (]: 3 of 9 START test not_null_fct_sales_product_sk ................................ [RUN]
[0m02:09:32.796299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_date_sk.4657127926, now test.retail_warehouse.not_null_fct_sales_product_sk.351c981452)
[0m02:09:32.796485 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:09:32.798635 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:09:32.799321 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:09:32.800732 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:09:32.801115 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:09:32.801304 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: BEGIN
[0m02:09:32.801470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.805488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:09:32.805662 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"
[0m02:09:32.805832 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_product_sk.351c981452"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "RetailSales"."dw"."fct_sales"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.819045 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m02:09:32.819791 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: ROLLBACK
[0m02:09:32.820099 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_product_sk.351c981452: Close
[0m02:09:32.820385 [info ] [Thread-1 (]: 3 of 9 PASS not_null_fct_sales_product_sk ...................................... [[32mPASS[0m in 0.02s]
[0m02:09:32.820653 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_product_sk.351c981452
[0m02:09:32.820839 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:09:32.821055 [info ] [Thread-1 (]: 4 of 9 START test not_null_fct_sales_store_sk .................................. [RUN]
[0m02:09:32.821294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_product_sk.351c981452, now test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330)
[0m02:09:32.821474 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:09:32.823365 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:09:32.823759 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:09:32.825049 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:09:32.825574 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:09:32.825744 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: BEGIN
[0m02:09:32.825903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.829610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:09:32.829794 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"
[0m02:09:32.829980 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "RetailSales"."dw"."fct_sales"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.841467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m02:09:32.842439 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: ROLLBACK
[0m02:09:32.842787 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330: Close
[0m02:09:32.843122 [info ] [Thread-1 (]: 4 of 9 PASS not_null_fct_sales_store_sk ........................................ [[32mPASS[0m in 0.02s]
[0m02:09:32.843417 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330
[0m02:09:32.843647 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:09:32.843917 [info ] [Thread-1 (]: 5 of 9 START test relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [RUN]
[0m02:09:32.844229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_sales_store_sk.01329d2330, now test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c)
[0m02:09:32.844442 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:09:32.849033 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:09:32.849552 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:09:32.850986 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:09:32.851387 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:09:32.851579 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: BEGIN
[0m02:09:32.851752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.855062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.855251 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"
[0m02:09:32.855452 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where customer_sk is not null
),

parent as (
    select customer_sk as to_field
    from "RetailSales"."dw"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.869581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m02:09:32.870485 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: ROLLBACK
[0m02:09:32.870817 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c: Close
[0m02:09:32.871137 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m02:09:32.871430 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c
[0m02:09:32.871634 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:09:32.871863 [info ] [Thread-1 (]: 6 of 9 START test relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ...... [RUN]
[0m02:09:32.872097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_customer_sk__customer_sk__ref_dim_customers_.51d7a6842c, now test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338)
[0m02:09:32.872278 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:09:32.875106 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:09:32.875513 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:09:32.876570 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:09:32.876912 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:09:32.877084 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: BEGIN
[0m02:09:32.877240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.880013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.880299 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"
[0m02:09:32.880513 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where date_sk is not null
),

parent as (
    select date_sk as to_field
    from "RetailSales"."dw"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.894294 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m02:09:32.895692 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: ROLLBACK
[0m02:09:32.896076 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338: Close
[0m02:09:32.896410 [info ] [Thread-1 (]: 6 of 9 PASS relationships_fct_sales_date_sk__date_sk__ref_dim_date_ ............ [[32mPASS[0m in 0.02s]
[0m02:09:32.896701 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338
[0m02:09:32.896901 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:09:32.897183 [info ] [Thread-1 (]: 7 of 9 START test relationships_fct_sales_product_sk__product_sk__ref_dim_products_  [RUN]
[0m02:09:32.897491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_date_sk__date_sk__ref_dim_date_.6263deb338, now test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3)
[0m02:09:32.897712 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:09:32.900786 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:09:32.901223 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:09:32.902285 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:09:32.902830 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:09:32.903082 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: BEGIN
[0m02:09:32.903277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.906193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.906388 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"
[0m02:09:32.906581 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from "RetailSales"."dw"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.919357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m02:09:32.920129 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: ROLLBACK
[0m02:09:32.920421 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3: Close
[0m02:09:32.920734 [info ] [Thread-1 (]: 7 of 9 PASS relationships_fct_sales_product_sk__product_sk__ref_dim_products_ .. [[32mPASS[0m in 0.02s]
[0m02:09:32.921074 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3
[0m02:09:32.921302 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:09:32.921584 [info ] [Thread-1 (]: 8 of 9 START test relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [RUN]
[0m02:09:32.921821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_product_sk__product_sk__ref_dim_products_.bc1783c8a3, now test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07)
[0m02:09:32.922004 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:09:32.925413 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:09:32.925856 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:09:32.926904 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:09:32.927234 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:09:32.927408 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: BEGIN
[0m02:09:32.927575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.930396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.930623 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"
[0m02:09:32.930821 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select promotion_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where promotion_sk is not null
),

parent as (
    select promotion_sk as to_field
    from "RetailSales"."dw"."dim_promotions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.943246 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:09:32.944145 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: ROLLBACK
[0m02:09:32.944482 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07: Close
[0m02:09:32.944814 [info ] [Thread-1 (]: 8 of 9 PASS relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_  [[32mPASS[0m in 0.02s]
[0m02:09:32.945108 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07
[0m02:09:32.945313 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:09:32.945547 [info ] [Thread-1 (]: 9 of 9 START test relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ .. [RUN]
[0m02:09:32.945793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_sales_promotion_sk__promotion_sk__ref_dim_promotions_.98319f7d07, now test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf)
[0m02:09:32.945983 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:09:32.948953 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:09:32.949367 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:09:32.950448 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:09:32.950814 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:09:32.951023 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: BEGIN
[0m02:09:32.951187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:32.954138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.954335 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"
[0m02:09:32.954523 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_sk as from_field
    from "RetailSales"."dw"."fct_sales"
    where store_sk is not null
),

parent as (
    select store_sk as to_field
    from "RetailSales"."dw"."dim_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:09:32.966395 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:09:32.967285 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: ROLLBACK
[0m02:09:32.967626 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf: Close
[0m02:09:32.967947 [info ] [Thread-1 (]: 9 of 9 PASS relationships_fct_sales_store_sk__store_sk__ref_dim_stores_ ........ [[32mPASS[0m in 0.02s]
[0m02:09:32.968230 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf
[0m02:09:32.968950 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.969115 [debug] [MainThread]: On master: BEGIN
[0m02:09:32.969248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:32.972223 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:09:32.972378 [debug] [MainThread]: On master: COMMIT
[0m02:09:32.972517 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:32.972643 [debug] [MainThread]: On master: COMMIT
[0m02:09:32.972907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:32.973051 [debug] [MainThread]: On master: Close
[0m02:09:32.973238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:32.973373 [debug] [MainThread]: Connection 'test.retail_warehouse.relationships_fct_sales_store_sk__store_sk__ref_dim_stores_.53aad6ddbf' was properly closed.
[0m02:09:32.973530 [info ] [MainThread]: 
[0m02:09:32.973690 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:09:32.974490 [debug] [MainThread]: Command end result
[0m02:09:32.993102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:09:32.994370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:09:32.998338 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:09:32.998525 [info ] [MainThread]: 
[0m02:09:32.998724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:32.998881 [info ] [MainThread]: 
[0m02:09:32.999038 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m02:09:33.000709 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.80298483, "process_in_blocks": "0", "process_kernel_time": 0.178229, "process_mem_max_rss": "131874816", "process_out_blocks": "0", "process_user_time": 1.176362}
[0m02:09:33.000952 [debug] [MainThread]: Command `dbt test` succeeded at 02:09:33.000901 after 0.80 seconds
[0m02:09:33.001150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112799c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ddac50>]}
[0m02:09:33.001337 [debug] [MainThread]: Flushing usage events
[0m02:09:33.150180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:20.742857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d09e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c3ed0>]}


============================== 02:18:20.746095 | 67fc455c-d403-47e9-8f01-1178bc8f75d2 ==============================
[0m02:18:20.746095 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:18:20.746486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_promotion_eligibility', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:18:20.851509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112221ba0>]}
[0m02:18:20.882662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113871ae0>]}
[0m02:18:20.883422 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:18:20.939903 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:18:21.018102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:21.018431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:21.022041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:18:21.046278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11387e050>]}
[0m02:18:21.104819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:18:21.115699 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:18:21.131425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138835c0>]}
[0m02:18:21.131724 [info ] [MainThread]: Found 12 models, 31 data tests, 5 sources, 572 macros
[0m02:18:21.131937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114626f90>]}
[0m02:18:21.133116 [info ] [MainThread]: 
[0m02:18:21.133329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:21.133484 [info ] [MainThread]: 
[0m02:18:21.133763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:21.134264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m02:18:21.168805 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m02:18:21.169093 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m02:18:21.169278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:21.186241 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m02:18:21.187121 [debug] [ThreadPool]: On list_RetailSales: Close
[0m02:18:21.190308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_oltp)
[0m02:18:21.194946 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:18:21.195212 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:18:21.195373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:21.201172 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m02:18:21.201460 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:18:21.201654 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:18:21.207694 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m02:18:21.208509 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:18:21.208842 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:18:21.209132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m02:18:21.211278 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:18:21.211478 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:18:21.211627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:21.216270 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m02:18:21.216497 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:18:21.216681 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:18:21.220443 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m02:18:21.221200 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:18:21.221509 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:18:21.224868 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:21.225040 [debug] [MainThread]: On master: BEGIN
[0m02:18:21.225177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:21.229110 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:18:21.229287 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:21.229496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:21.255820 [debug] [MainThread]: SQL status: SELECT 10 in 0.026 seconds
[0m02:18:21.257300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b772b0>]}
[0m02:18:21.257547 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:21.257836 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:21.257980 [debug] [MainThread]: On master: BEGIN
[0m02:18:21.258350 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:18:21.258496 [debug] [MainThread]: On master: COMMIT
[0m02:18:21.258633 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:21.258762 [debug] [MainThread]: On master: COMMIT
[0m02:18:21.259010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:21.259158 [debug] [MainThread]: On master: Close
[0m02:18:21.260213 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_promotion_eligibility
[0m02:18:21.260496 [info ] [Thread-1 (]: 1 of 1 START sql table model dw.fct_promotion_eligibility ...................... [RUN]
[0m02:18:21.260736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now model.retail_warehouse.fct_promotion_eligibility)
[0m02:18:21.260914 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_promotion_eligibility
[0m02:18:21.265770 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:21.267071 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_promotion_eligibility
[0m02:18:21.290000 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:21.290627 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:21.290834 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: BEGIN
[0m02:18:21.291015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:21.294992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:18:21.295267 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:21.295484 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */

  
    

  create  table "RetailSales"."dw"."fct_promotion_eligibility__dbt_tmp"
  
  
    as
  
  (
    

-- Factless fact table: tracks product promotion eligibility per store and date
select 
    d.date_sk,
    p.product_sk,
    pr.promotion_sk,
    s.store_sk
from "RetailSales"."dw"."dim_promotions" pr
join "RetailSales"."dw"."dim_products" p     on 1=1
join "RetailSales"."dw"."dim_stores" s       on 1=1
join "RetailSales"."dw"."dim_date" d         on d.full_date between pr.start_date and pr.end_date
  );
  
[0m02:18:26.084071 [debug] [Thread-1 (]: SQL status: SELECT 3921000 in 4.788 seconds
[0m02:18:26.096791 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:26.097195 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */
alter table "RetailSales"."dw"."fct_promotion_eligibility__dbt_tmp" rename to "fct_promotion_eligibility"
[0m02:18:26.127693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m02:18:26.140329 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: COMMIT
[0m02:18:26.140691 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:26.140949 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: COMMIT
[0m02:18:26.143568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:18:26.150764 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."fct_promotion_eligibility__dbt_backup"
[0m02:18:26.153590 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m02:18:26.153825 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */
drop table if exists "RetailSales"."dw"."fct_promotion_eligibility__dbt_backup" cascade
[0m02:18:26.154267 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:18:26.155617 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: Close
[0m02:18:26.157196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67fc455c-d403-47e9-8f01-1178bc8f75d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bfd310>]}
[0m02:18:26.157559 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw.fct_promotion_eligibility ................. [[32mSELECT 3921000[0m in 4.90s]
[0m02:18:26.157899 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_promotion_eligibility
[0m02:18:26.158812 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.159029 [debug] [MainThread]: On master: BEGIN
[0m02:18:26.159192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:26.163232 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:18:26.163457 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.163634 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.163782 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.164044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:26.164210 [debug] [MainThread]: On master: Close
[0m02:18:26.164426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:26.164569 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_promotion_eligibility' was properly closed.
[0m02:18:26.164728 [info ] [MainThread]: 
[0m02:18:26.164899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m02:18:26.165236 [debug] [MainThread]: Command end result
[0m02:18:26.225553 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:18:26.226719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:18:26.230185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:18:26.230375 [info ] [MainThread]: 
[0m02:18:26.230594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:26.230756 [info ] [MainThread]: 
[0m02:18:26.230934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:18:26.233013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5297494, "process_in_blocks": "0", "process_kernel_time": 0.212249, "process_mem_max_rss": "129990656", "process_out_blocks": "0", "process_user_time": 1.213702}
[0m02:18:26.233308 [debug] [MainThread]: Command `dbt run` succeeded at 02:18:26.233251 after 5.53 seconds
[0m02:18:26.233521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114687bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114687c50>]}
[0m02:18:26.233724 [debug] [MainThread]: Flushing usage events
[0m02:18:26.431946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:45.002848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec3ed0>]}


============================== 02:18:45.006237 | 1bcf43e0-5d05-450e-ad3b-fe0b23da41b3 ==============================
[0m02:18:45.006237 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:18:45.006610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select fct_promotion_eligibility', 'send_anonymous_usage_stats': 'True'}
[0m02:18:45.102294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f21ba0>]}
[0m02:18:45.133063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110071ae0>]}
[0m02:18:45.134549 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:18:45.191864 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:18:45.273428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:45.273755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:45.277167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m02:18:45.301606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11007e050>]}
[0m02:18:45.358921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:18:45.366589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:18:45.387525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112172990>]}
[0m02:18:45.387886 [info ] [MainThread]: Found 12 models, 31 data tests, 5 sources, 572 macros
[0m02:18:45.388123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218b4d0>]}
[0m02:18:45.389488 [info ] [MainThread]: 
[0m02:18:45.389735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:45.389897 [info ] [MainThread]: 
[0m02:18:45.390182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:45.392765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales_oltp'
[0m02:18:45.427397 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:18:45.427772 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m02:18:45.427970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:45.444724 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m02:18:45.445005 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m02:18:45.445199 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m02:18:45.451069 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m02:18:45.452236 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m02:18:45.452723 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m02:18:45.453300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now list_RetailSales_dw)
[0m02:18:45.455332 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:18:45.455621 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m02:18:45.455796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:45.459577 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:18:45.459760 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m02:18:45.459930 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m02:18:45.465839 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m02:18:45.466848 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m02:18:45.467322 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m02:18:45.471456 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:45.471697 [debug] [MainThread]: On master: BEGIN
[0m02:18:45.471862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:45.476307 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:18:45.476561 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:45.476846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:45.507467 [debug] [MainThread]: SQL status: SELECT 10 in 0.030 seconds
[0m02:18:45.509273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcf43e0-5d05-450e-ad3b-fe0b23da41b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112543040>]}
[0m02:18:45.509564 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:45.509932 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:45.510162 [debug] [MainThread]: On master: BEGIN
[0m02:18:45.510677 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:18:45.510931 [debug] [MainThread]: On master: COMMIT
[0m02:18:45.511116 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:45.511268 [debug] [MainThread]: On master: COMMIT
[0m02:18:45.511525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:45.511681 [debug] [MainThread]: On master: Close
[0m02:18:45.512559 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb
[0m02:18:45.512841 [info ] [Thread-1 (]: 1 of 8 START test not_null_fct_promotion_eligibility_date_sk ................... [RUN]
[0m02:18:45.513117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb)
[0m02:18:45.513321 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb
[0m02:18:45.523533 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb"
[0m02:18:45.524135 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb
[0m02:18:45.537232 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb"
[0m02:18:45.538131 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb"
[0m02:18:45.538358 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb: BEGIN
[0m02:18:45.538541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:45.542419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:18:45.542652 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb"
[0m02:18:45.542843 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_sk
from "RetailSales"."dw"."fct_promotion_eligibility"
where date_sk is null



  
  
      
    ) dbt_internal_test
[0m02:18:45.710996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.168 seconds
[0m02:18:45.714581 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb: ROLLBACK
[0m02:18:45.715055 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb: Close
[0m02:18:45.715409 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fct_promotion_eligibility_date_sk ......................... [[32mPASS[0m in 0.20s]
[0m02:18:45.715730 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb
[0m02:18:45.715958 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878
[0m02:18:45.716246 [info ] [Thread-1 (]: 2 of 8 START test not_null_fct_promotion_eligibility_product_sk ................ [RUN]
[0m02:18:45.716578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_promotion_eligibility_date_sk.e1fac0ddbb, now test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878)
[0m02:18:45.716797 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878
[0m02:18:45.719784 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878"
[0m02:18:45.720460 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878
[0m02:18:45.760547 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878"
[0m02:18:45.761135 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878"
[0m02:18:45.761334 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878: BEGIN
[0m02:18:45.761507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:45.764847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:18:45.765172 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878"
[0m02:18:45.765407 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "RetailSales"."dw"."fct_promotion_eligibility"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m02:18:45.846117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.080 seconds
[0m02:18:45.847144 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878: ROLLBACK
[0m02:18:45.847518 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878: Close
[0m02:18:45.847878 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fct_promotion_eligibility_product_sk ...................... [[32mPASS[0m in 0.13s]
[0m02:18:45.848188 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878
[0m02:18:45.848407 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e
[0m02:18:45.848683 [info ] [Thread-1 (]: 3 of 8 START test not_null_fct_promotion_eligibility_promotion_sk .............. [RUN]
[0m02:18:45.849015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_promotion_eligibility_product_sk.75d647b878, now test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e)
[0m02:18:45.849243 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e
[0m02:18:45.851528 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e"
[0m02:18:45.852090 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e
[0m02:18:45.853579 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e"
[0m02:18:45.854009 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e"
[0m02:18:45.854208 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e: BEGIN
[0m02:18:45.854382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:45.857671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:18:45.857906 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e"
[0m02:18:45.858109 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_sk
from "RetailSales"."dw"."fct_promotion_eligibility"
where promotion_sk is null



  
  
      
    ) dbt_internal_test
[0m02:18:45.938420 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.080 seconds
[0m02:18:45.939578 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e: ROLLBACK
[0m02:18:45.939984 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e: Close
[0m02:18:45.940338 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fct_promotion_eligibility_promotion_sk .................... [[32mPASS[0m in 0.09s]
[0m02:18:45.940641 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e
[0m02:18:45.940848 [debug] [Thread-1 (]: Began running node test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329
[0m02:18:45.941114 [info ] [Thread-1 (]: 4 of 8 START test not_null_fct_promotion_eligibility_store_sk .................. [RUN]
[0m02:18:45.941450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_promotion_eligibility_promotion_sk.98cee0c66e, now test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329)
[0m02:18:45.941672 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329
[0m02:18:45.944199 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329"
[0m02:18:45.944782 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329
[0m02:18:45.946296 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329"
[0m02:18:45.946787 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329"
[0m02:18:45.947000 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329: BEGIN
[0m02:18:45.947191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:45.950348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:18:45.950579 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329"
[0m02:18:45.950781 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "RetailSales"."dw"."fct_promotion_eligibility"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m02:18:46.032882 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.082 seconds
[0m02:18:46.034015 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329: ROLLBACK
[0m02:18:46.034380 [debug] [Thread-1 (]: On test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329: Close
[0m02:18:46.034726 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fct_promotion_eligibility_store_sk ........................ [[32mPASS[0m in 0.09s]
[0m02:18:46.035030 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329
[0m02:18:46.035246 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9
[0m02:18:46.035494 [info ] [Thread-1 (]: 5 of 8 START test relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_  [RUN]
[0m02:18:46.035764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.not_null_fct_promotion_eligibility_store_sk.4fec5e2329, now test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9)
[0m02:18:46.035962 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9
[0m02:18:46.041103 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9"
[0m02:18:46.041708 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9
[0m02:18:46.043591 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9"
[0m02:18:46.044206 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9"
[0m02:18:46.044474 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9: BEGIN
[0m02:18:46.044710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:46.047928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:18:46.048168 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9"
[0m02:18:46.048371 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_sk as from_field
    from "RetailSales"."dw"."fct_promotion_eligibility"
    where date_sk is not null
),

parent as (
    select date_sk as to_field
    from "RetailSales"."dw"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:18:46.171488 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.122 seconds
[0m02:18:46.174830 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9: ROLLBACK
[0m02:18:46.175684 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9: Close
[0m02:18:46.176618 [info ] [Thread-1 (]: 5 of 8 PASS relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_  [[32mPASS[0m in 0.14s]
[0m02:18:46.177228 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9
[0m02:18:46.177634 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2
[0m02:18:46.178080 [info ] [Thread-1 (]: 6 of 8 START test relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_  [RUN]
[0m02:18:46.178808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_promotion_eligibility_date_sk__date_sk__ref_dim_date_.8caa91c8d9, now test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2)
[0m02:18:46.179428 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2
[0m02:18:46.184533 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2"
[0m02:18:46.185262 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2
[0m02:18:46.186935 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2"
[0m02:18:46.187504 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2"
[0m02:18:46.187788 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2: BEGIN
[0m02:18:46.188041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:46.191961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:18:46.192255 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2"
[0m02:18:46.192479 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sk as from_field
    from "RetailSales"."dw"."fct_promotion_eligibility"
    where product_sk is not null
),

parent as (
    select product_sk as to_field
    from "RetailSales"."dw"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:18:46.314196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.121 seconds
[0m02:18:46.318340 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2: ROLLBACK
[0m02:18:46.319001 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2: Close
[0m02:18:46.319680 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_  [[32mPASS[0m in 0.14s]
[0m02:18:46.320383 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2
[0m02:18:46.320765 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220
[0m02:18:46.321128 [info ] [Thread-1 (]: 7 of 8 START test relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_  [RUN]
[0m02:18:46.321549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_promotion_eligibility_product_sk__product_sk__ref_dim_products_.0e77d7c2e2, now test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220)
[0m02:18:46.321861 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220
[0m02:18:46.327098 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220"
[0m02:18:46.327818 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220
[0m02:18:46.329292 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220"
[0m02:18:46.330230 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220"
[0m02:18:46.330629 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220: BEGIN
[0m02:18:46.330898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:46.334834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:18:46.335178 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220"
[0m02:18:46.335418 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select promotion_sk as from_field
    from "RetailSales"."dw"."fct_promotion_eligibility"
    where promotion_sk is not null
),

parent as (
    select promotion_sk as to_field
    from "RetailSales"."dw"."dim_promotions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:18:46.469947 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.134 seconds
[0m02:18:46.473270 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220: ROLLBACK
[0m02:18:46.474007 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220: Close
[0m02:18:46.474792 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_  [[32mPASS[0m in 0.15s]
[0m02:18:46.475311 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220
[0m02:18:46.475666 [debug] [Thread-1 (]: Began running node test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b
[0m02:18:46.476053 [info ] [Thread-1 (]: 8 of 8 START test relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_  [RUN]
[0m02:18:46.476548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_warehouse.relationships_fct_promotion_eligibility_promotion_sk__promotion_sk__ref_dim_promotions_.944a580220, now test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b)
[0m02:18:46.476907 [debug] [Thread-1 (]: Began compiling node test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b
[0m02:18:46.481235 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b"
[0m02:18:46.481950 [debug] [Thread-1 (]: Began executing node test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b
[0m02:18:46.483168 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b"
[0m02:18:46.483687 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b"
[0m02:18:46.483884 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b: BEGIN
[0m02:18:46.484059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:46.487311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m02:18:46.487594 [debug] [Thread-1 (]: Using postgres connection "test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b"
[0m02:18:46.487841 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_sk as from_field
    from "RetailSales"."dw"."fct_promotion_eligibility"
    where store_sk is not null
),

parent as (
    select store_sk as to_field
    from "RetailSales"."dw"."dim_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:18:46.629431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.141 seconds
[0m02:18:46.632020 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b: ROLLBACK
[0m02:18:46.632837 [debug] [Thread-1 (]: On test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b: Close
[0m02:18:46.633697 [info ] [Thread-1 (]: 8 of 8 PASS relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_  [[32mPASS[0m in 0.16s]
[0m02:18:46.634292 [debug] [Thread-1 (]: Finished running node test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b
[0m02:18:46.635483 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:46.635841 [debug] [MainThread]: On master: BEGIN
[0m02:18:46.636095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:46.639391 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:18:46.639684 [debug] [MainThread]: On master: COMMIT
[0m02:18:46.639877 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:46.640049 [debug] [MainThread]: On master: COMMIT
[0m02:18:46.640421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:46.640838 [debug] [MainThread]: On master: Close
[0m02:18:46.641330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:46.641618 [debug] [MainThread]: Connection 'test.retail_warehouse.relationships_fct_promotion_eligibility_store_sk__store_sk__ref_dim_stores_.f76efac97b' was properly closed.
[0m02:18:46.641879 [info ] [MainThread]: 
[0m02:18:46.642072 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m02:18:46.643151 [debug] [MainThread]: Command end result
[0m02:18:46.667103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m02:18:46.668451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m02:18:46.672621 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m02:18:46.672837 [info ] [MainThread]: 
[0m02:18:46.673049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:46.673209 [info ] [MainThread]: 
[0m02:18:46.673382 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m02:18:46.675109 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7106559, "process_in_blocks": "0", "process_kernel_time": 0.20922, "process_mem_max_rss": "132104192", "process_out_blocks": "0", "process_user_time": 1.266515}
[0m02:18:46.675370 [debug] [MainThread]: Command `dbt test` succeeded at 02:18:46.675317 after 1.71 seconds
[0m02:18:46.675572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ca8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125caba0>]}
[0m02:18:46.675763 [debug] [MainThread]: Flushing usage events
[0m02:18:46.975369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:26.287457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b7ed0>]}


============================== 18:53:26.289975 | 8c629b78-cfd5-4bcb-8579-0ef45bf78c00 ==============================
[0m18:53:26.289975 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:53:26.290237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_date dim_products dim_promotions dim_stores fct_promotion_eligibility', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:53:26.363782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f15ba0>]}
[0m18:53:26.381909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65ae0>]}
[0m18:53:26.382645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:53:26.422926 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:53:26.485177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:26.485428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:26.488067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m18:53:26.503446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a72050>]}
[0m18:53:26.539326 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m18:53:26.546746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m18:53:26.561524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a775c0>]}
[0m18:53:26.561826 [info ] [MainThread]: Found 12 models, 31 data tests, 5 sources, 572 macros
[0m18:53:26.561957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7ef90>]}
[0m18:53:26.563106 [info ] [MainThread]: 
[0m18:53:26.563230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:26.563318 [info ] [MainThread]: 
[0m18:53:26.563518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:26.565152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m18:53:26.597057 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m18:53:26.597265 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m18:53:26.597379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:26.689658 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.092 seconds
[0m18:53:26.690372 [debug] [ThreadPool]: On list_RetailSales: Close
[0m18:53:26.691223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m18:53:26.693673 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m18:53:26.693884 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m18:53:26.693990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:26.700199 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:53:26.700401 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m18:53:26.700524 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m18:53:26.707748 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m18:53:26.708445 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m18:53:26.708702 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m18:53:26.708935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m18:53:26.710529 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m18:53:26.710664 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m18:53:26.710769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:26.714948 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m18:53:26.715088 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m18:53:26.715196 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m18:53:26.717566 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m18:53:26.718145 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m18:53:26.718331 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m18:53:26.721521 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:26.721739 [debug] [MainThread]: On master: BEGIN
[0m18:53:26.721846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:26.724953 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:53:26.725174 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:26.725334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:26.764822 [debug] [MainThread]: SQL status: SELECT 10 in 0.039 seconds
[0m18:53:26.766386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f832b0>]}
[0m18:53:26.766649 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:26.766982 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:26.767132 [debug] [MainThread]: On master: BEGIN
[0m18:53:26.767413 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:53:26.767536 [debug] [MainThread]: On master: COMMIT
[0m18:53:26.767653 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:26.767764 [debug] [MainThread]: On master: COMMIT
[0m18:53:26.767949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:26.768119 [debug] [MainThread]: On master: Close
[0m18:53:26.768789 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_date
[0m18:53:26.769029 [info ] [Thread-1 (]: 1 of 5 START sql table model dw.dim_date ....................................... [RUN]
[0m18:53:26.769261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_date)
[0m18:53:26.769438 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_date
[0m18:53:26.773160 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_date"
[0m18:53:26.773557 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_date
[0m18:53:26.789339 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_date"
[0m18:53:26.789817 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.789963 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: BEGIN
[0m18:53:26.790088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:26.794869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:53:26.795041 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.795205 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */

  
    

  create  table "RetailSales"."dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with calendar as (
    select
        generate_series('2015-01-01'::date, '2035-12-31'::date, interval '1 day')::date as date_day
), base as (
    select
        (extract(year from date_day)*10000
         + extract(month from date_day)*100
         + extract(day   from date_day))::int      as date_sk,
        date_day                                    as full_date,
        extract(year from date_day)::int            as year,
        extract(quarter from date_day)::int         as quarter,
        extract(month from date_day)::int           as month,
        to_char(date_day,'Month')                   as month_name,
        extract(day from date_day)::int             as day_of_month,
        extract(doy from date_day)::int             as day_of_year,
        extract(week from date_day)::int            as week_of_year,
        extract(isodow from date_day)::int          as weekday_iso,
        to_char(date_day,'Day')                     as weekday_name,
        case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
    from calendar
), unknown as (
    /* the Kimball unknown row */
    select
        0                    as date_sk,
        '1900-01-01'::date   as full_date,
        1900                 as year,
        0                    as quarter,
        0                    as month,
        'Unknown'            as month_name,
        0  as day_of_month,
        0  as day_of_year,
        0  as week_of_year,
        0  as weekday_iso,
        'Unknown'            as weekday_name,
        false as is_weekend
)

select * from base
union all
select * from unknown
  );
  
[0m18:53:26.850661 [debug] [Thread-1 (]: SQL status: SELECT 7671 in 0.055 seconds
[0m18:53:26.855706 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.855929 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date" rename to "dim_date__dbt_backup"
[0m18:53:26.856566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:53:26.857876 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.858039 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:53:26.858441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:53:26.866939 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m18:53:26.867162 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.867298 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m18:53:26.868167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:53:26.871028 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_date__dbt_backup"
[0m18:53:26.872949 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:53:26.873107 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
drop table if exists "RetailSales"."dw"."dim_date__dbt_backup" cascade
[0m18:53:26.876101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:53:26.877435 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: Close
[0m18:53:26.878663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110805250>]}
[0m18:53:26.878976 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dw.dim_date .................................. [[32mSELECT 7671[0m in 0.11s]
[0m18:53:26.879234 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_date
[0m18:53:26.879402 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m18:53:26.879613 [info ] [Thread-1 (]: 2 of 5 START sql table model dw.dim_products ................................... [RUN]
[0m18:53:26.879796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_date, now model.retail_warehouse.dim_products)
[0m18:53:26.879928 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m18:53:26.914101 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m18:53:26.914682 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m18:53:26.915912 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m18:53:26.916217 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.916345 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m18:53:26.916466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:26.920926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:53:26.921142 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.921273 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."oltp"."stg_products"
  );
  
[0m18:53:26.926507 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m18:53:26.927980 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.928243 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products" rename to "dim_products__dbt_backup"
[0m18:53:26.928818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:53:26.929820 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.929942 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:53:26.930766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:53:26.931255 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m18:53:26.931390 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.931486 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m18:53:26.931866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:53:26.932777 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_products__dbt_backup"
[0m18:53:26.932973 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:53:26.933086 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw"."dim_products__dbt_backup" cascade
[0m18:53:26.934550 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:53:26.935165 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m18:53:26.935461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aff1d0>]}
[0m18:53:26.935712 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dw.dim_products .............................. [[32mSELECT 50[0m in 0.06s]
[0m18:53:26.935925 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m18:53:26.936083 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m18:53:26.936289 [info ] [Thread-1 (]: 3 of 5 START sql table model dw.dim_promotions ................................. [RUN]
[0m18:53:26.936579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m18:53:26.936728 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m18:53:26.938070 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m18:53:26.938570 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m18:53:26.939833 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m18:53:26.940118 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.940238 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m18:53:26.940349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:26.945671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:53:26.945867 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.946001 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

-- -------------------------------------------------------------------------
-- 1.  Regular promotion rows from the staging table
-- -------------------------------------------------------------------------
with base as (

    select
        nextval('dw.dim_promotions_sk_seq') as promotion_sk,   -- surrogate
        promotion_id,
        promotion_name,
        media_type,
        discount_pct,
        start_date,
        end_date
    from "RetailSales"."oltp"."stg_promotions"

),

-- -------------------------------------------------------------------------
-- 2.  Kimball “Unknown Promotion” row  (surrogate key = 0)
-- -------------------------------------------------------------------------
unknown_row as (

    select
        0                    as promotion_sk,
        'UNK'                as promotion_id,
        'Unknown Promotion'  as promotion_name,
        'N/A'                as media_type,
        0.0                  as discount_pct,
        date '1900-01-01'    as start_date,
        date '2099-12-31'    as end_date

)

-- -------------------------------------------------------------------------
-- 3.  Final output
-- -------------------------------------------------------------------------
select * from base
union all
select * from unknown_row
  );
  
[0m18:53:26.953186 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.007 seconds
[0m18:53:26.954306 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.954430 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m18:53:26.955040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:53:26.956297 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.956454 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m18:53:26.957439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:53:26.958016 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m18:53:26.958172 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.958297 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m18:53:26.958882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:53:26.959988 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m18:53:26.960202 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:53:26.960336 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m18:53:26.963297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:53:26.963913 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m18:53:26.964161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107153390>]}
[0m18:53:26.964408 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 16[0m in 0.03s]
[0m18:53:26.964629 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m18:53:26.964768 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m18:53:26.964975 [info ] [Thread-1 (]: 4 of 5 START sql table model dw.dim_stores ..................................... [RUN]
[0m18:53:26.965158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m18:53:26.965324 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m18:53:26.966461 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m18:53:26.966818 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m18:53:26.968101 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m18:53:26.968400 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.968512 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m18:53:26.968636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:26.972692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:53:26.972858 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.972995 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."oltp"."stg_stores"
  );
  
[0m18:53:26.979115 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:53:26.980416 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.980567 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores" rename to "dim_stores__dbt_backup"
[0m18:53:26.981151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:53:26.982425 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.982577 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m18:53:26.983415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:53:26.983880 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m18:53:26.984003 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.984117 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m18:53:26.984569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:53:26.985343 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_stores__dbt_backup"
[0m18:53:26.985539 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:53:26.985668 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw"."dim_stores__dbt_backup" cascade
[0m18:53:26.988054 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:53:26.988715 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m18:53:26.988972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107115d50>]}
[0m18:53:26.989231 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dw.dim_stores ................................ [[32mSELECT 10[0m in 0.02s]
[0m18:53:26.989463 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m18:53:26.989619 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_promotion_eligibility
[0m18:53:26.989838 [info ] [Thread-1 (]: 5 of 5 START sql table model dw.fct_promotion_eligibility ...................... [RUN]
[0m18:53:26.990045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_stores, now model.retail_warehouse.fct_promotion_eligibility)
[0m18:53:26.990184 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_promotion_eligibility
[0m18:53:26.991494 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_promotion_eligibility"
[0m18:53:26.992035 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_promotion_eligibility
[0m18:53:26.993503 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_promotion_eligibility"
[0m18:53:26.994052 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:53:26.994190 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: BEGIN
[0m18:53:26.994302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:26.998409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:53:26.998597 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:53:26.998731 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */

  
    

  create  table "RetailSales"."dw"."fct_promotion_eligibility__dbt_tmp"
  
  
    as
  
  (
    

-- generate one row per date the promotion is active
with promo_calendar as (

    select
        p.promotion_sk,
        p.product_sk,
        d.date_sk
    from "RetailSales"."dw"."dim_promotions" p
    join "RetailSales"."dw"."dim_date" d
      on d.full_date between p.start_date and p.end_date

)

select
    date_sk,
    product_sk,
    promotion_sk
from promo_calendar
order by promotion_sk, date_sk
  );
  
[0m18:53:27.000235 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column p.product_sk does not exist
LINE 19:         p.product_sk,
                 ^

[0m18:53:27.000377 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: ROLLBACK
[0m18:53:27.000663 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: Close
[0m18:53:27.005281 [debug] [Thread-1 (]: Database Error in model fct_promotion_eligibility (models/marts/core/facts/fct_promotion_eligibility.sql)
  column p.product_sk does not exist
  LINE 19:         p.product_sk,
                   ^
  compiled code at target/run/retail_warehouse/models/marts/core/facts/fct_promotion_eligibility.sql
[0m18:53:27.005505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629b78-cfd5-4bcb-8579-0ef45bf78c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110869390>]}
[0m18:53:27.005757 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model dw.fct_promotion_eligibility ............. [[31mERROR[0m in 0.02s]
[0m18:53:27.005959 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_promotion_eligibility
[0m18:53:27.006191 [debug] [Thread-4 (]: Marking all children of 'model.retail_warehouse.fct_promotion_eligibility' to be skipped because of status 'error'.  Reason: Database Error in model fct_promotion_eligibility (models/marts/core/facts/fct_promotion_eligibility.sql)
  column p.product_sk does not exist
  LINE 19:         p.product_sk,
                   ^
  compiled code at target/run/retail_warehouse/models/marts/core/facts/fct_promotion_eligibility.sql.
[0m18:53:27.007069 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:27.007211 [debug] [MainThread]: On master: BEGIN
[0m18:53:27.007323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:27.012523 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:53:27.012751 [debug] [MainThread]: On master: COMMIT
[0m18:53:27.012871 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:27.012978 [debug] [MainThread]: On master: COMMIT
[0m18:53:27.013196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:27.013295 [debug] [MainThread]: On master: Close
[0m18:53:27.013466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:27.013565 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_promotion_eligibility' was properly closed.
[0m18:53:27.013709 [info ] [MainThread]: 
[0m18:53:27.013833 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:53:27.014256 [debug] [MainThread]: Command end result
[0m18:53:27.029233 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m18:53:27.030090 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m18:53:27.032320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m18:53:27.032439 [info ] [MainThread]: 
[0m18:53:27.032570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:53:27.032671 [info ] [MainThread]: 
[0m18:53:27.032799 [error] [MainThread]:   Database Error in model fct_promotion_eligibility (models/marts/core/facts/fct_promotion_eligibility.sql)
  column p.product_sk does not exist
  LINE 19:         p.product_sk,
                   ^
  compiled code at target/run/retail_warehouse/models/marts/core/facts/fct_promotion_eligibility.sql
[0m18:53:27.032895 [info ] [MainThread]: 
[0m18:53:27.033001 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:53:27.034901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7787378, "process_in_blocks": "0", "process_kernel_time": 0.186596, "process_mem_max_rss": "133054464", "process_out_blocks": "0", "process_user_time": 0.812502}
[0m18:53:27.035178 [debug] [MainThread]: Command `dbt run` failed at 18:53:27.035135 after 0.78 seconds
[0m18:53:27.035417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b65730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d6bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d6b9b0>]}
[0m18:53:27.035556 [debug] [MainThread]: Flushing usage events
[0m18:53:27.305798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:29.361555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3ed0>]}


============================== 18:56:29.363730 | 97be6fbe-992b-43d8-9552-e36b414d639a ==============================
[0m18:56:29.363730 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:56:29.363975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_date dim_products dim_promotions dim_stores fct_promotion_eligibility', 'send_anonymous_usage_stats': 'True'}
[0m18:56:29.425254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21ba0>]}
[0m18:56:29.443671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d71ae0>]}
[0m18:56:29.444191 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:56:29.482812 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:56:29.530407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:29.530601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:29.532815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_warehouse.marts.intermediate
[0m18:56:29.546830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7e050>]}
[0m18:56:29.581768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m18:56:29.587204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m18:56:29.596945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d835c0>]}
[0m18:56:29.597147 [info ] [MainThread]: Found 12 models, 29 data tests, 5 sources, 572 macros
[0m18:56:29.597279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc6dd0>]}
[0m18:56:29.598366 [info ] [MainThread]: 
[0m18:56:29.598501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:29.598603 [info ] [MainThread]: 
[0m18:56:29.598806 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:56:29.600223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_RetailSales'
[0m18:56:29.623075 [debug] [ThreadPool]: Using postgres connection "list_RetailSales"
[0m18:56:29.623254 [debug] [ThreadPool]: On list_RetailSales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales"} */

    select distinct nspname from pg_namespace
  
[0m18:56:29.623366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:29.637296 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m18:56:29.637880 [debug] [ThreadPool]: On list_RetailSales: Close
[0m18:56:29.638584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales, now list_RetailSales_dw)
[0m18:56:29.640592 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m18:56:29.640709 [debug] [ThreadPool]: On list_RetailSales_dw: BEGIN
[0m18:56:29.640801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:29.644627 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m18:56:29.644733 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_dw"
[0m18:56:29.644831 [debug] [ThreadPool]: On list_RetailSales_dw: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_dw"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw'
  
[0m18:56:29.648529 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m18:56:29.649015 [debug] [ThreadPool]: On list_RetailSales_dw: ROLLBACK
[0m18:56:29.649251 [debug] [ThreadPool]: On list_RetailSales_dw: Close
[0m18:56:29.649439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RetailSales_dw, now list_RetailSales_oltp)
[0m18:56:29.650894 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m18:56:29.651002 [debug] [ThreadPool]: On list_RetailSales_oltp: BEGIN
[0m18:56:29.651089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:29.653990 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:56:29.654129 [debug] [ThreadPool]: Using postgres connection "list_RetailSales_oltp"
[0m18:56:29.654235 [debug] [ThreadPool]: On list_RetailSales_oltp: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "list_RetailSales_oltp"} */
select
      'RetailSales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'oltp'
    union all
    select
      'RetailSales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'oltp'
  
[0m18:56:29.656519 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m18:56:29.657037 [debug] [ThreadPool]: On list_RetailSales_oltp: ROLLBACK
[0m18:56:29.657263 [debug] [ThreadPool]: On list_RetailSales_oltp: Close
[0m18:56:29.659485 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.659603 [debug] [MainThread]: On master: BEGIN
[0m18:56:29.659691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:29.664636 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:56:29.664745 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.664866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:29.697402 [debug] [MainThread]: SQL status: SELECT 10 in 0.032 seconds
[0m18:56:29.698777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e231e0>]}
[0m18:56:29.698976 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:29.699332 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.699457 [debug] [MainThread]: On master: BEGIN
[0m18:56:29.699766 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:56:29.699874 [debug] [MainThread]: On master: COMMIT
[0m18:56:29.699974 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.700076 [debug] [MainThread]: On master: COMMIT
[0m18:56:29.700264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:56:29.700371 [debug] [MainThread]: On master: Close
[0m18:56:29.700946 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_date
[0m18:56:29.701173 [info ] [Thread-1 (]: 1 of 5 START sql table model dw.dim_date ....................................... [RUN]
[0m18:56:29.701354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RetailSales_oltp, now model.retail_warehouse.dim_date)
[0m18:56:29.701482 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_date
[0m18:56:29.704511 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_date"
[0m18:56:29.704865 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_date
[0m18:56:29.718641 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_date"
[0m18:56:29.719101 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.719222 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: BEGIN
[0m18:56:29.719327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:29.734592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:56:29.734842 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.734995 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */

  
    

  create  table "RetailSales"."dw"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with calendar as (
    select
        generate_series('2015-01-01'::date, '2035-12-31'::date, interval '1 day')::date as date_day
), base as (
    select
        (extract(year from date_day)*10000
         + extract(month from date_day)*100
         + extract(day   from date_day))::int      as date_sk,
        date_day                                    as full_date,
        extract(year from date_day)::int            as year,
        extract(quarter from date_day)::int         as quarter,
        extract(month from date_day)::int           as month,
        to_char(date_day,'Month')                   as month_name,
        extract(day from date_day)::int             as day_of_month,
        extract(doy from date_day)::int             as day_of_year,
        extract(week from date_day)::int            as week_of_year,
        extract(isodow from date_day)::int          as weekday_iso,
        to_char(date_day,'Day')                     as weekday_name,
        case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
    from calendar
), unknown as (
    /* the Kimball unknown row */
    select
        0                    as date_sk,
        '1900-01-01'::date   as full_date,
        1900                 as year,
        0                    as quarter,
        0                    as month,
        'Unknown'            as month_name,
        0  as day_of_month,
        0  as day_of_year,
        0  as week_of_year,
        0  as weekday_iso,
        'Unknown'            as weekday_name,
        false as is_weekend
)

select * from base
union all
select * from unknown
  );
  
[0m18:56:29.767423 [debug] [Thread-1 (]: SQL status: SELECT 7671 in 0.032 seconds
[0m18:56:29.771979 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.772155 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date" rename to "dim_date__dbt_backup"
[0m18:56:29.772548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.773660 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.773771 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
alter table "RetailSales"."dw"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:56:29.774100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.781856 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m18:56:29.782037 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.782140 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: COMMIT
[0m18:56:29.782905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:56:29.785022 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_date__dbt_backup"
[0m18:56:29.791174 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_date"
[0m18:56:29.791385 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_date"} */
drop table if exists "RetailSales"."dw"."dim_date__dbt_backup" cascade
[0m18:56:29.793476 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:56:29.794532 [debug] [Thread-1 (]: On model.retail_warehouse.dim_date: Close
[0m18:56:29.795504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb5190>]}
[0m18:56:29.795815 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dw.dim_date .................................. [[32mSELECT 7671[0m in 0.09s]
[0m18:56:29.796054 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_date
[0m18:56:29.796212 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_products
[0m18:56:29.796432 [info ] [Thread-1 (]: 2 of 5 START sql table model dw.dim_products ................................... [RUN]
[0m18:56:29.796603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_date, now model.retail_warehouse.dim_products)
[0m18:56:29.796732 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_products
[0m18:56:29.827708 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_products"
[0m18:56:29.828179 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_products
[0m18:56:29.829327 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_products"
[0m18:56:29.829601 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.829731 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: BEGIN
[0m18:56:29.829834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:29.833202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m18:56:29.833343 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.833456 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */

  
    

  create  table "RetailSales"."dw"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_products_sk_seq') as product_sk,
     product_id,
     product_name,
     brand,
     subcategory,
     category,
     department,
     package_type,
     fat_content,
     diet_type
from "RetailSales"."oltp"."stg_products"
  );
  
[0m18:56:29.837859 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.004 seconds
[0m18:56:29.839037 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.839164 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products" rename to "dim_products__dbt_backup"
[0m18:56:29.839478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.840381 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.840495 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
alter table "RetailSales"."dw"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:56:29.841070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.841489 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m18:56:29.841605 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.841711 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: COMMIT
[0m18:56:29.842220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:56:29.843058 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_products__dbt_backup"
[0m18:56:29.843243 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_products"
[0m18:56:29.843368 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_products"} */
drop table if exists "RetailSales"."dw"."dim_products__dbt_backup" cascade
[0m18:56:29.844820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:56:29.845256 [debug] [Thread-1 (]: On model.retail_warehouse.dim_products: Close
[0m18:56:29.845465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c471d0>]}
[0m18:56:29.845688 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dw.dim_products .............................. [[32mSELECT 50[0m in 0.05s]
[0m18:56:29.845905 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_products
[0m18:56:29.846045 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_promotions
[0m18:56:29.846263 [info ] [Thread-1 (]: 3 of 5 START sql table model dw.dim_promotions ................................. [RUN]
[0m18:56:29.846477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_products, now model.retail_warehouse.dim_promotions)
[0m18:56:29.846617 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_promotions
[0m18:56:29.847747 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_promotions"
[0m18:56:29.848031 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_promotions
[0m18:56:29.849249 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_promotions"
[0m18:56:29.849499 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.849612 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: BEGIN
[0m18:56:29.849720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:29.852419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m18:56:29.852543 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.852681 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */

  
    

  create  table "RetailSales"."dw"."dim_promotions__dbt_tmp"
  
  
    as
  
  (
    

-- -------------------------------------------------------------------------
-- 1.  Regular promotion rows from the staging table
-- -------------------------------------------------------------------------
with base as (

    select
        nextval('dw.dim_promotions_sk_seq') as promotion_sk,   -- surrogate
        promotion_id,
        promotion_name,
        media_type,
        discount_pct,
        start_date,
        end_date
    from "RetailSales"."oltp"."stg_promotions"

),

-- -------------------------------------------------------------------------
-- 2.  Kimball “Unknown Promotion” row  (surrogate key = 0)
-- -------------------------------------------------------------------------
unknown_row as (

    select
        0                    as promotion_sk,
        'UNK'                as promotion_id,
        'Unknown Promotion'  as promotion_name,
        'N/A'                as media_type,
        0.0                  as discount_pct,
        date '1900-01-01'    as start_date,
        date '2099-12-31'    as end_date

)

-- -------------------------------------------------------------------------
-- 3.  Final output
-- -------------------------------------------------------------------------
select * from base
union all
select * from unknown_row
  );
  
[0m18:56:29.855952 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.003 seconds
[0m18:56:29.857024 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.857271 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions" rename to "dim_promotions__dbt_backup"
[0m18:56:29.857782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.858836 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.858976 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
alter table "RetailSales"."dw"."dim_promotions__dbt_tmp" rename to "dim_promotions"
[0m18:56:29.859512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.859950 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m18:56:29.860075 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.860185 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: COMMIT
[0m18:56:29.860711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:56:29.861574 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_promotions__dbt_backup"
[0m18:56:29.861746 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_promotions"
[0m18:56:29.861853 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_promotions"} */
drop table if exists "RetailSales"."dw"."dim_promotions__dbt_backup" cascade
[0m18:56:29.863610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:56:29.864314 [debug] [Thread-1 (]: On model.retail_warehouse.dim_promotions: Close
[0m18:56:29.864546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b67b0>]}
[0m18:56:29.864781 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dw.dim_promotions ............................ [[32mSELECT 16[0m in 0.02s]
[0m18:56:29.864987 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_promotions
[0m18:56:29.865138 [debug] [Thread-1 (]: Began running node model.retail_warehouse.dim_stores
[0m18:56:29.865438 [info ] [Thread-1 (]: 4 of 5 START sql table model dw.dim_stores ..................................... [RUN]
[0m18:56:29.865623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_promotions, now model.retail_warehouse.dim_stores)
[0m18:56:29.865771 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.dim_stores
[0m18:56:29.866937 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.dim_stores"
[0m18:56:29.867302 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.dim_stores
[0m18:56:29.868542 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.dim_stores"
[0m18:56:29.868801 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.868918 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: BEGIN
[0m18:56:29.869025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:29.872813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:56:29.873126 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.873313 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */

  
    

  create  table "RetailSales"."dw"."dim_stores__dbt_tmp"
  
  
    as
  
  (
    

select 
     nextval('dw.dim_stores_sk_seq') as store_sk,
     store_id,
     store_name,
     district,
     region,
     open_date,
     remodel_date,
     store_type
from "RetailSales"."oltp"."stg_stores"
  );
  
[0m18:56:29.879269 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:56:29.880529 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.880670 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores" rename to "dim_stores__dbt_backup"
[0m18:56:29.881295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.882447 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.882619 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
alter table "RetailSales"."dw"."dim_stores__dbt_tmp" rename to "dim_stores"
[0m18:56:29.883850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:56:29.884327 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m18:56:29.884441 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.884550 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: COMMIT
[0m18:56:29.885239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:56:29.885959 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."dim_stores__dbt_backup"
[0m18:56:29.886144 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.dim_stores"
[0m18:56:29.886247 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.dim_stores"} */
drop table if exists "RetailSales"."dw"."dim_stores__dbt_backup" cascade
[0m18:56:29.889377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:56:29.889821 [debug] [Thread-1 (]: On model.retail_warehouse.dim_stores: Close
[0m18:56:29.890035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090de8d0>]}
[0m18:56:29.890279 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dw.dim_stores ................................ [[32mSELECT 10[0m in 0.02s]
[0m18:56:29.890494 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.dim_stores
[0m18:56:29.890683 [debug] [Thread-1 (]: Began running node model.retail_warehouse.fct_promotion_eligibility
[0m18:56:29.890848 [info ] [Thread-1 (]: 5 of 5 START sql table model dw.fct_promotion_eligibility ...................... [RUN]
[0m18:56:29.891034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_warehouse.dim_stores, now model.retail_warehouse.fct_promotion_eligibility)
[0m18:56:29.891157 [debug] [Thread-1 (]: Began compiling node model.retail_warehouse.fct_promotion_eligibility
[0m18:56:29.892294 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.892599 [debug] [Thread-1 (]: Began executing node model.retail_warehouse.fct_promotion_eligibility
[0m18:56:29.893813 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.894051 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.894164 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: BEGIN
[0m18:56:29.894271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:29.898468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:56:29.898590 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.898739 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */

  
    

  create  table "RetailSales"."dw"."fct_promotion_eligibility__dbt_tmp"
  
  
    as
  
  (
    

-- generate one row per date the promotion is active
with promo_calendar as (

    select
        p.promotion_sk,
        d.date_sk
    from "RetailSales"."dw"."dim_promotions" p
    join "RetailSales"."dw"."dim_date" d
      on d.full_date between p.start_date and p.end_date

)

select
    date_sk,
    promotion_sk
from promo_calendar
order by promotion_sk, date_sk
  );
  
[0m18:56:29.926096 [debug] [Thread-1 (]: SQL status: SELECT 7842 in 0.027 seconds
[0m18:56:29.927483 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.927645 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */
alter table "RetailSales"."dw"."fct_promotion_eligibility__dbt_tmp" rename to "fct_promotion_eligibility"
[0m18:56:29.928226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:56:29.928605 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: COMMIT
[0m18:56:29.928719 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.928815 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: COMMIT
[0m18:56:29.929571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:56:29.930544 [debug] [Thread-1 (]: Applying DROP to: "RetailSales"."dw"."fct_promotion_eligibility__dbt_backup"
[0m18:56:29.930750 [debug] [Thread-1 (]: Using postgres connection "model.retail_warehouse.fct_promotion_eligibility"
[0m18:56:29.930885 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "retail_warehouse", "target_name": "dev", "node_id": "model.retail_warehouse.fct_promotion_eligibility"} */
drop table if exists "RetailSales"."dw"."fct_promotion_eligibility__dbt_backup" cascade
[0m18:56:29.931164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:56:29.931624 [debug] [Thread-1 (]: On model.retail_warehouse.fct_promotion_eligibility: Close
[0m18:56:29.931843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97be6fbe-992b-43d8-9552-e36b414d639a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0be00>]}
[0m18:56:29.932076 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dw.fct_promotion_eligibility ................. [[32mSELECT 7842[0m in 0.04s]
[0m18:56:29.932284 [debug] [Thread-1 (]: Finished running node model.retail_warehouse.fct_promotion_eligibility
[0m18:56:29.932824 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.932952 [debug] [MainThread]: On master: BEGIN
[0m18:56:29.933062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:29.936723 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:56:29.936852 [debug] [MainThread]: On master: COMMIT
[0m18:56:29.936965 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.937067 [debug] [MainThread]: On master: COMMIT
[0m18:56:29.937246 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:56:29.937353 [debug] [MainThread]: On master: Close
[0m18:56:29.937499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:29.937600 [debug] [MainThread]: Connection 'model.retail_warehouse.fct_promotion_eligibility' was properly closed.
[0m18:56:29.937755 [info ] [MainThread]: 
[0m18:56:29.937895 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:56:29.938402 [debug] [MainThread]: Command end result
[0m18:56:29.953680 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/manifest.json
[0m18:56:29.954737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/semantic_manifest.json
[0m18:56:29.957179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/target/run_results.json
[0m18:56:29.957353 [info ] [MainThread]: 
[0m18:56:29.957548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:29.957952 [info ] [MainThread]: 
[0m18:56:29.958176 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:56:29.959909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6241234, "process_in_blocks": "0", "process_kernel_time": 0.140815, "process_mem_max_rss": "130514944", "process_out_blocks": "0", "process_user_time": 0.790654}
[0m18:56:29.960100 [debug] [MainThread]: Command `dbt run` succeeded at 18:56:29.960064 after 0.62 seconds
[0m18:56:29.960254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c08ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea7dd0>]}
[0m18:56:29.960400 [debug] [MainThread]: Flushing usage events
[0m18:56:30.190073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:36:12.187560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108005e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c3ed0>]}


============================== 03:36:12.191006 | a599a7a4-55f4-4531-82dc-cda7f49d9b8b ==============================
[0m03:36:12.191006 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:36:12.191425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m03:36:12.203652 [info ] [MainThread]: dbt version: 1.9.0
[0m03:36:12.203957 [info ] [MainThread]: python version: 3.13.1
[0m03:36:12.204138 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m03:36:12.204290 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m03:36:12.209097 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DB_SCHEMA'
[0m03:36:12.211286 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.06650317, "process_in_blocks": "0", "process_kernel_time": 0.141693, "process_mem_max_rss": "105512960", "process_out_blocks": "0", "process_user_time": 0.715125}
[0m03:36:12.211656 [debug] [MainThread]: Command `dbt debug` failed at 03:36:12.211585 after 0.07 seconds
[0m03:36:12.211884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094862c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e0490>]}
[0m03:36:12.212117 [debug] [MainThread]: Flushing usage events
[0m03:36:12.491320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:36:28.388071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106545e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463ed0>]}


============================== 03:36:28.391321 | a73dcec9-d7b0-4ca5-abe5-1feaff120e33 ==============================
[0m03:36:28.391321 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:36:28.391692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:36:28.400187 [info ] [MainThread]: dbt version: 1.9.0
[0m03:36:28.400426 [info ] [MainThread]: python version: 3.13.1
[0m03:36:28.400582 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m03:36:28.400718 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m03:36:28.447090 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m03:36:28.447412 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m03:36:28.447576 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m03:36:28.448216 [info ] [MainThread]: adapter type: postgres
[0m03:36:28.448465 [info ] [MainThread]: adapter version: 1.9.0
[0m03:36:28.502713 [info ] [MainThread]: Configuration:
[0m03:36:28.503027 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:36:28.503195 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:36:28.503346 [info ] [MainThread]: Required dependencies:
[0m03:36:28.503578 [debug] [MainThread]: Executing "git --help"
[0m03:36:28.516513 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:36:28.516973 [debug] [MainThread]: STDERR: "b''"
[0m03:36:28.517172 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:36:28.517347 [info ] [MainThread]: Connection:
[0m03:36:28.517518 [info ] [MainThread]:   host: localhost
[0m03:36:28.517661 [info ] [MainThread]:   port: 5432
[0m03:36:28.517801 [info ] [MainThread]:   user: postgres
[0m03:36:28.517932 [info ] [MainThread]:   database: RetailSales
[0m03:36:28.518063 [info ] [MainThread]:   schema: dw
[0m03:36:28.518191 [info ] [MainThread]:   connect_timeout: 10
[0m03:36:28.518320 [info ] [MainThread]:   role: None
[0m03:36:28.518449 [info ] [MainThread]:   search_path: None
[0m03:36:28.518574 [info ] [MainThread]:   keepalives_idle: 0
[0m03:36:28.518703 [info ] [MainThread]:   sslmode: None
[0m03:36:28.518824 [info ] [MainThread]:   sslcert: None
[0m03:36:28.518953 [info ] [MainThread]:   sslkey: None
[0m03:36:28.519077 [info ] [MainThread]:   sslrootcert: None
[0m03:36:28.519199 [info ] [MainThread]:   application_name: dbt
[0m03:36:28.519327 [info ] [MainThread]:   retries: 1
[0m03:36:28.519655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:36:28.565597 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m03:36:28.603894 [debug] [MainThread]: Using postgres connection "debug"
[0m03:36:28.604117 [debug] [MainThread]: On debug: select 1 as id
[0m03:36:28.604271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:36:28.723351 [debug] [MainThread]: SQL status: SELECT 1 in 0.119 seconds
[0m03:36:28.724085 [debug] [MainThread]: On debug: Close
[0m03:36:28.724302 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:36:28.724502 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:36:28.726826 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.37768522, "process_in_blocks": "0", "process_kernel_time": 0.175172, "process_mem_max_rss": "119226368", "process_out_blocks": "0", "process_user_time": 0.834025}
[0m03:36:28.727123 [debug] [MainThread]: Command `dbt debug` succeeded at 03:36:28.727058 after 0.38 seconds
[0m03:36:28.727313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:36:28.727523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108161220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a81b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a98270>]}
[0m03:36:28.727764 [debug] [MainThread]: Flushing usage events
[0m03:36:28.883035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:39:51.995796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec3ed0>]}


============================== 03:39:51.999212 | 90a5e6cf-302d-4db4-9460-7dae3b894093 ==============================
[0m03:39:51.999212 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:39:51.999604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ramana/.dbt', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:39:52.008820 [info ] [MainThread]: dbt version: 1.9.0
[0m03:39:52.009117 [info ] [MainThread]: python version: 3.13.1
[0m03:39:52.009287 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m03:39:52.009442 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m03:39:52.049873 [info ] [MainThread]: Using profiles dir at /Users/ramana/.dbt
[0m03:39:52.050212 [info ] [MainThread]: Using profiles.yml file at /Users/ramana/.dbt/profiles.yml
[0m03:39:52.050384 [info ] [MainThread]: Using dbt_project.yml file at /Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/dbt_project.yml
[0m03:39:52.050757 [info ] [MainThread]: adapter type: postgres
[0m03:39:52.050916 [info ] [MainThread]: adapter version: 1.9.0
[0m03:39:52.106716 [info ] [MainThread]: Configuration:
[0m03:39:52.107028 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:39:52.107217 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:39:52.107368 [info ] [MainThread]: Required dependencies:
[0m03:39:52.107700 [debug] [MainThread]: Executing "git --help"
[0m03:39:52.122555 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:39:52.123102 [debug] [MainThread]: STDERR: "b''"
[0m03:39:52.123320 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:39:52.123764 [info ] [MainThread]: Connection:
[0m03:39:52.124210 [info ] [MainThread]:   host: localhost
[0m03:39:52.124403 [info ] [MainThread]:   port: 5432
[0m03:39:52.124563 [info ] [MainThread]:   user: postgres
[0m03:39:52.124740 [info ] [MainThread]:   database: RetailSales
[0m03:39:52.124892 [info ] [MainThread]:   schema: dw
[0m03:39:52.125052 [info ] [MainThread]:   connect_timeout: 10
[0m03:39:52.125197 [info ] [MainThread]:   role: None
[0m03:39:52.125342 [info ] [MainThread]:   search_path: None
[0m03:39:52.125481 [info ] [MainThread]:   keepalives_idle: 0
[0m03:39:52.125624 [info ] [MainThread]:   sslmode: None
[0m03:39:52.125768 [info ] [MainThread]:   sslcert: None
[0m03:39:52.125903 [info ] [MainThread]:   sslkey: None
[0m03:39:52.126042 [info ] [MainThread]:   sslrootcert: None
[0m03:39:52.126182 [info ] [MainThread]:   application_name: dbt
[0m03:39:52.126321 [info ] [MainThread]:   retries: 1
[0m03:39:52.126681 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:39:52.174454 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m03:39:52.201941 [debug] [MainThread]: Using postgres connection "debug"
[0m03:39:52.202218 [debug] [MainThread]: On debug: select 1 as id
[0m03:39:52.202397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:39:52.219025 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m03:39:52.219660 [debug] [MainThread]: On debug: Close
[0m03:39:52.219876 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:39:52.220064 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:39:52.222608 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.26636142, "process_in_blocks": "0", "process_kernel_time": 0.169637, "process_mem_max_rss": "120176640", "process_out_blocks": "0", "process_user_time": 0.841716}
[0m03:39:52.222904 [debug] [MainThread]: Command `dbt debug` succeeded at 03:39:52.222842 after 0.27 seconds
[0m03:39:52.223098 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:39:52.223339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e15220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc0380>]}
[0m03:39:52.223707 [debug] [MainThread]: Flushing usage events
[0m03:39:52.497924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:07.349294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c3ed0>]}


============================== 23:56:07.358517 | 8131a584-40b5-499e-b5f4-b7705e0db686 ==============================
[0m23:56:07.358517 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:56:07.358930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ramana/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ramana/github_repos/analytics-projects/retail_sales/dbt/retail_warehouse/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:07.464524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8131a584-40b5-499e-b5f4-b7705e0db686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111525ba0>]}
[0m23:56:07.538421 [debug] [MainThread]: Set downloads directory='/var/folders/p3/51f_vd2n3m1983c2cgykmgkc0000gn/T/dbt-downloads-ezw2f_c3'
[0m23:56:07.538936 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:56:07.852464 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:56:07.853926 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m23:56:07.932262 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m23:56:07.933506 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:56:08.035924 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:56:08.038281 [info ] [MainThread]: Installing dbt-labs/codegen
[0m23:56:08.491193 [info ] [MainThread]: Installed from version 0.13.1
[0m23:56:08.491493 [info ] [MainThread]: Up to date!
[0m23:56:08.492048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8131a584-40b5-499e-b5f4-b7705e0db686', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112463f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112463df0>]}
[0m23:56:08.492382 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:56:08.906739 [info ] [MainThread]: Installed from version 1.3.0
[0m23:56:08.907033 [info ] [MainThread]: Up to date!
[0m23:56:08.907249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8131a584-40b5-499e-b5f4-b7705e0db686', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112537650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110774d0>]}
[0m23:56:08.926374 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.664845, "process_in_blocks": "0", "process_kernel_time": 0.225795, "process_mem_max_rss": "114802688", "process_out_blocks": "0", "process_user_time": 0.957844}
[0m23:56:08.926760 [debug] [MainThread]: Command `cli deps` succeeded at 23:56:08.926691 after 1.67 seconds
[0m23:56:08.926991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cbe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d04b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112242ea0>]}
[0m23:56:08.929616 [debug] [MainThread]: Flushing usage events
[0m23:56:09.400940 [debug] [MainThread]: An error was encountered while trying to flush usage events
